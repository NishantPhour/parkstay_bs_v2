import{c as Rt,m as Ot,e as Yt,a as Ut,T as At,f as Vt,p as qt,b as Ft,i as jt,w as ge,d as g,v as ae,g as S,h as e,r as Ke,n as Le,j as It,o as C,k as a,l as $e,F as ie,q as de,t as H,s as Q,u as Ht,x as _e,y as W,z as fe,A as Ye,B as ue,C as ee,D as X,E as ke,G as Ne,H as at,I as Te,J as kt,Q as $t,K as De,L as Qe,M as lt,N as nt,O as ft,P as Lt,R as pt,S as mt,U as Be,V as Nt,W as Bt,X as ht,Y as ot,Z as Gt,_ as Jt,$ as Ct,a0 as zt}from"./vendor.js";import s from"jquery";import vt from"lodash";import Xt from"select2";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))n(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const x of i.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&n(x)}).observe(document,{childList:!0,subtree:!0});function v(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerPolicy&&(i.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?i.credentials="include":d.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(d){if(d.ep)return;d.ep=!0;const i=v(d);fetch(d.href,i)}})();const wt=Rt({state:{alert:{visible:!1,type:"danger",message:""},regions:[],parks:[],districts:[],campgrounds:[],campsite_classes:[],show_loader:!1,app_loader_text:""},mutations:{SETALERT(o,c){o.alert=c},SETREGIONS(o,c){o.regions=c},SETPARKS(o,c){o.parks=c},SETDISTRICTS(o,c){o.districts=c},SETCAMPGROUNDS(o,c){o.campgrounds=c},SETCAMPSITECLASSES(o,c){o.campsite_classes=c},SET_LOADER_STATE(o,c){o.show_loader=c,c||(o.app_loader_text="")},SET_LOADER_TEXT(o,c){o.app_loader_text=c}},actions:{updateAlert(o,c){o.commit("SETALERT",c)},fetchRegions(o){s.get(G.regions,function(c){o.commit("SETREGIONS",c)})},fetchParks(o){s.get(G.parks,function(c){o.commit("SETPARKS",c)})},fetchDistricts(o){s.get(G.districts,function(c){o.commit("SETDISTRICTS",c)})},fetchCampgrounds(o){return new Promise((c,v)=>{fetch(G.campgrounds).then(n=>{o.commit("SETCAMPGROUNDS",n.body),c(n.body)}).catch(n=>{v(n)})}).catch(c=>{console.log(c)})},fetchCampsiteClasses(o){s.get(G.campsite_classes,function(c){o.commit("SETCAMPSITECLASSES",c)})}},getters:{showAlert:o=>o.alert.visible,alertType:o=>o.alert.type,alertMessage:o=>o.alert.message,regions:o=>o.regions,parks:o=>o.parks,districts:o=>o.districts,campgrounds:o=>o.campgrounds,campsite_classes:o=>o.campsite_classes,app_loader_state:o=>o.show_loader,app_loader_text:o=>o.app_loader_text}}),Ge=()=>wt,le="http://localhost:9191",G={regions:le+"/api/regions.json",parks:le+"/api/parks.json",districts:le+"/api/districts.json",park_price_history:function(o){return le+"/api/parks/price_history.json"},park_add_price:function(){return le+"/api/parks/add_price.json"},park_current_price:function(o,c){return le+"/api/parks/"+o+"/current_price.json?arrival="+c},park_entry_rate:function(o){return le+"/api/parkentryrate/"+o+".json"},park:function(o){return le+"/api/parks/"+o+".json"},campgrounds:le+"/api/campgrounds.json",campgrounds_datatable:le+"/api/campgrounds/datatable_list.json",bulk_close:le+"/api/campgrounds/bulk_close.json",campground:function(o){return le+"/api/campgrounds/"+o+".json"},campground_status_history:function(o){return le+"/api/campgrounds/"+o+"/status_history.json?closures=True"},campground_price_history:function(o){return le+"/api/campgrounds/"+o+"/price_history.json"},campgroundStayHistory:function(o){return le+"/api/campgrounds/"+o+"/stay_history.json"},campgroundCurrentStayHistory:function(o,c,v){return le+"/api/campgrounds/"+o+"/stay_history.json?start="+c+"&end="+v},campground_stay_history_detail:function(o){return le+"/api/campground_stay_history/"+o+".json"},available_campsite_classes:function(o,c,v){return le+"/api/campgrounds/"+o+"/available_campsite_classes.json?arrival="+c+"&departure="+v},campground_stay_history:le+"/api/campground_stay_history.json",addPrice:function(o){return le+"/api/campgrounds/"+o+"/addPrice.json"},editPrice:function(o){return le+"/api/campgrounds/"+o+"/updatePrice.json"},campgroundCampsites:function(o){return le+"/api/campgrounds/"+o+"/campsites.json"},campground_booking_ranges:function(){return le+"/api/campground_booking_ranges.json"},campground_booking_ranges_detail:function(o){return le+"/api/campground_booking_ranges/"+o+".json"},campground_status_history_detail:function(o){return le+"/api/campground_booking_ranges/"+o+".json?original=true"},delete_campground_price:function(o){return le+"/api/campgrounds/"+o+"/deletePrice.json"},campsites:le+"/api/campsites.json",campsites_stay_history:le+"/api/campsites_stay_history.json",campsites_stay_history_detail:function(o){return le+"/api/campsites_stay_history/"+o+".json"},campsites_price_history:function(o){return le+"/api/campsites/"+o+"/price_history.json"},campsite_current_price:function(o,c,v){return le+"/api/campsites/"+o+"/current_price.json?arrival="+c+"&departure="+v},campsites_current_price:function(){return le+"/api/campsites/current_price_list.json"},campsite_status_history:function(o){return le+"/api/campsites/"+o+"/status_history.json?closures=True"},campsite:function(o){return le+"/api/campsites/"+o+".json"},campsiteStayHistory:function(o){return le+"/api/campsites/"+o+"/stay_history.json"},bulk_close_campsites:function(){return le+"/api/campsites/bulk_close.json"},campsite_booking_ranges:function(){return le+"/api/campsite_booking_ranges.json"},campsite_booking_ranges_detail:function(o){return le+"/api/campsite_booking_ranges/"+o+".json"},campsite_status_history_detail:function(o){return le+"/api/campsite_booking_ranges/"+o+".json?original=true"},available_campsites:function(o,c,v){return le+"/api/campgrounds/"+o+"/available_campsites.json?arrival="+c+"&departure="+v},available_campsites_booking:function(o,c,v,n){return le+"/api/campgrounds/"+o+"/available_campsites_booking.json?arrival="+c+"&departure="+v+"&booking="+n},features:le+"/api/features.json",campsite_rate:le+"/api/campsite_rate.json",campsiterate_detail:function(o){return le+"/api/campsite_rate/"+o+".json"},rates:le+"/api/rates.json",booking_policy:le+"/api/booking_policy/",campsite_classes:le+"/api/campsite_classes.json",campsite_classes_active:le+"/api/campsite_classes.json?active_only=true",campsite_class:function(o){return le+"/api/campsite_classes/"+o+".json"},addCampsiteClassPrice:function(o){return le+"/api/campsite_classes/"+o+"/addPrice.json"},editCampsiteClassPrice(o){return le+"/api/campsite_classes/"+o+"/updatePrice.json"},deleteCampsiteClassPrice(o){return le+"/api/campsite_classes/"+o+"/deletePrice.json"},campsiteclass_price_history:function(o){return le+"/api/campsite_classes/"+o+"/price_history.json"},closureReasons:function(){return le+"/api/closureReasons.json"},priceReasons:function(){return le+"/api/priceReasons.json"},maxStayReasons:function(){return le+"/api/maxStayReasons.json"},discountReasons:function(){return le+"/api/discountReasons.json"},bulkPricing:function(){return le+"/api/bulkPricing"},bookings:le+"/api/booking.json",booking:function(o){return le+"/api/booking/"+o+".json"},booking_refunds:le+"/api/reports/booking_refunds",countries:le+"/api/countries.json",users:le+"/api/users.json",usersLookup:function(o){return encodeURI(le+"/api/users.json?q="+o)},profile:le+"/api/profile",contacts:le+"/api/contacts.json"},Ie=Ot(),re={apiError:function(o){let c="";if(o.status===400)try{c=JSON.parse(o.responseText).non_field_errors[0].replace(/[\[\]"]/g,"")}catch{c=o.responseText.replace(/[\[\]"]/g,"")}else o.status===404?c="The resource you are looking for does not exist.":c=o.responseText.replace(/[\[\]"]/g,"");return c},apiVueResourceError:function(o){let c="";if(o.status===400){let v=o.body[0];try{c=JSON.parse(v).non_field_errors[0].replace(/[\[\]"]/g,"")}catch{c=v.replace(/[\[\]"]/g,"")}}else o.status===404&&(c="The resource you are looking for does not exist.");return c},getCookie:function(o){let c=null;if(document.cookie&&document.cookie!==""){let v=document.cookie.split(";");for(let n=0;n<v.length;n++){let d=v[n].trim();if(d.substring(0,o.length+1).trim()===o+"="){c=decodeURIComponent(d.substring(o.length+1));break}}}return c},namePopover:function(o,c){c.on("mouseover",".name_popover",function(v){o(this).popover("show"),o(this).on("mouseout",function(){o(this).popover("hide")})})},add_endpoint_json:function(o,c){return o.split(".json")[0]+"/"+c+".json"},dtPopover:function(o,c=30,v="hover"){let n="...",d=vt.truncate(o,{length:c,omission:n,separator:" "}),i="<span>"+d+"</span>",x=vt.template('<a href="#" role="button" data-toggle="popover" data-trigger="'+v+'" data-placement="top auto"data-html="true" data-content="<%= text %>" >more</a>');return vt.endsWith(d,n)&&(i+=x({text:o})),i},dtPopoverCellFn:function(o){s(o).find('[data-toggle="popover"]').popover().on("click",function(c){return c.preventDefault(),!0})}},Oe={addError:(o,c)=>{s(o).closest(".form-group").addClass("has-error"),s(o).trigger("focus"),s(o).trigger("select"),s(o).addClass("tooltip-err"),s(o).tooltip().attr("data-original-title",c),Oe.errors.push(c)},removeError:o=>{s(o).removeClass("tooltip-err"),s(o).closest(".form-group").removeClass("has-error")},isNotEmpty:o=>{var c=s(o).val();if(Oe.removeError(o),c==""||c==null){var v=s(o).attr("data-error-msg")?s(o).attr("data-error-msg"):"Field is required";return Oe.addError(o,v),!1}return!0},isNumber:o=>{if(isNotEmpty(o)){var c=o.value;Oe.removeError(o);for(var v=0;v<c.length;v++){var n=c.substring(v,v+1);if(n<"0"||n>"9"){var d=s(o).attr("data-error-msg")?s(o).attr("data-error-msg"):"Field is not a number";return Oe.addError(o,d),Oe.errors.push(d),!1}}if(o.value.length<9){var d=s(o).attr("data-error-msg")?s(o).attr("data-error-msg"):"Field is not a number";return Oe.addError(o,d),Oe.errors.push(d),!1}return!0}return!1},validate:o=>{Oe.errors=[],Oe.isValid=!0,s(".tooltip-err").tooltip("destroy");var c=s(o).find(":input");return s.each(c,function(v,n){(s(n).attr("required")=="required"||s(n).attr("required")=="true")&&(Oe.isNotEmpty(n)||(Oe.isValid=!1)),s(n).attr("number")&&(Oe.isNumber(n)||(Oe.isValid=!1))}),Oe},errors:Array(),isValid:!0},_t=Oe;console.log(".imported jquery");window.$=s;window.jquery=s;window.jQuery=s;console.log("here",s);Xt();const ce=Yt(Ut),xt=function(o,c,v){let n;return function(){const d=this,i=arguments,x=function(){n=null,o.apply(d,i)};clearTimeout(n),n=setTimeout(x,c)}},xe=function(o,c={}){const{localization:v,display:n,restrictions:d,...i}=c,x={localization:{format:"dd/MM/yyyy",...v},display:{keepOpen:!1,components:{clock:!1},icons:{type:"icons",time:"bi bi-clock",date:"bi bi-calendar-week",up:"bi bi-arrow-up",down:"bi bi-arrow-down",previous:"bi bi-chevron-left",next:"bi bi-chevron-right",today:"bi bi-calendar-check",clear:"bi bi-trash",close:"bi bi-x"},...n},restrictions:{...d}},O=Object.assign({},x,i);return new At(o.length?o[0]:o,O)},ne={formatDate:Vt,parseDate:qt,addDays:Ft,isWithinInterval:jt},Ee={__name:"alert",props:{type:{type:String},dismissable:{type:Boolean,default:!1},show:{type:Boolean,default:!1},duration:{type:Number,default:0},width:{type:String},placement:{type:String}},setup(o){const c=o;return ge(()=>c.show,v=>{v&&c.duration&&setTimeout(()=>{c.show=!1},c.duration)}),(v,n)=>g((C(),S("div",{class:Le({alert:!0,"alert-success":o.type=="success","alert-warning":o.type=="warning","alert-info":o.type=="info","alert-danger":o.type=="danger",top:o.placement==="top","top-right":o.placement==="top-right"}),transition:"fade",style:It({width:o.width}),role:"alert"},[g(e("button",{type:"button",class:"close",onClick:n[0]||(n[0]=d=>o.show=!1)},n[1]||(n[1]=[e("span",null,"×",-1)]),512),[[ae,o.dismissable]]),Ke(v.$slots,"default")],6)),[[ae,o.show]])}};function Se(o,c,v){typeof o=="string"?this.tableElement=s(o):this.tableElement=o,this.api=this.tableElement.dataTable().api(),this.columnIndexes=[],this.columnsShownIndexes=[],this.columnsHiddenIndexes=[],this.currentBreakpoint="",this.lastBreakpoint="",this.lastColumnsHiddenIndexes=[];var n=window.location.pathname.split("/").pop(),d=this.api.settings().context[0];this.tableId=d.sTableId,this.saveState=d.oInit.bStateSave,this.cookieName="DataTablesResponsiveHelper_"+this.tableId+(n?"_"+n:""),this.lastStateExists=!1,this.expandColumn=void 0,this.origBreakpointsDefs=void 0,this.breakpoints={},this.options={hideEmptyColumnsInRowDetail:!1,clickOn:"icon",showDetail:null,hideDetail:null},this.expandIconTemplate='<span class="responsiveExpander"></span>',this.rowTemplate='<tr class="row-detail"><td><ul><!--column item--></ul></td></tr>',this.rowLiTemplate='<li><span class="columnTitle"><!--column title--></span>: <span class="columnValue"><!--column value--></span></li>',this.disabled=!0,this.skipNextWindowsWidthChange=!1,this.init(c,v)}Se.prototype.init=function(o,c){this.origBreakpointsDefs=o,this.initBreakpoints(),this.disable(!1),s.extend(this.options,c)};Se.prototype.initBreakpoints=function(){if(this.saveState&&this.getState(),!this.lastStateExists){var o=[];for(var c in this.origBreakpointsDefs)o.push({name:c,upperLimit:this.origBreakpointsDefs[c],columnsToHide:[]});o.sort(function(t,M){return t.upperLimit-M.upperLimit});for(var v=0,n=0;n<o.length;n++)o[n].lowerLimit=v,v=o[n].upperLimit;o.push({name:"always",lowerLimit:v,upperLimit:1/0,columnsToHide:[]}),this.breakpoints={};var n,d;for(n=0,d=o.length;n<d;n++)this.breakpoints[o[n].name]=o[n];var i=this.api.columns().header(),x=[];for(n=0,d=i.length;n<d;n++)this.api.column(n).visible()&&(this.columnIndexes.push(n),x.push(i[n]));for(var O=0;O<x.length;O++){var p=s(x[O]);p.attr("data-class")==="expand"&&(this.expandColumn=this.columnIndexes[O]);var D=p.attr("data-hide");if(D!==void 0)for(var b=D.split(/,\s*/),n=0;n<b.length;n++){var P=b[n];if(P==="always")for(var c in this.breakpoints)this.breakpoints[c].name!=="default"&&this.breakpoints[c].columnsToHide.push(this.columnIndexes[O]);else this.breakpoints[P]!==void 0&&this.breakpoints[P].columnsToHide.push(this.columnIndexes[O])}}}};Se.prototype.setWindowsResizeHandler=function(o){if(o===void 0&&(o=!0),o){var c=this;s(window).bind("resize",function(){c.respond()})}else s(window).unbind("resize")};Se.prototype.respond=function(){if(!this.disabled){var o=this,c=s(window).width(),v=[];for(var n in this.breakpoints){var d=this.breakpoints[n];(!d.lowerLimit||c>d.lowerLimit)&&(!d.upperLimit||c<=d.upperLimit)&&(this.currentBreakpoint=d.name,v=d.columnsToHide)}var i=!1;if(!this.skipNextWindowsWidthChange)if(this.lastBreakpoint.length===0&&v.length)i=!0;else if(this.lastBreakpoint!=this.currentBreakpoint)i=!0;else if(this.columnsHiddenIndexes.length!==v.length)i=!0;else{var x=this.difference(this.columnsHiddenIndexes,v).length,O=this.difference(v,this.columnsHiddenIndexes).length;i=x+O>0}i&&(this.skipNextWindowsWidthChange=!0,this.columnsHiddenIndexes=v,this.columnsShownIndexes=this.difference(this.columnIndexes,this.columnsHiddenIndexes),this.showHideColumns(),this.lastBreakpoint=this.currentBreakpoint,this.setState(),this.skipNextWindowsWidthChange=!1),this.columnsHiddenIndexes.length?(this.tableElement.addClass("has-columns-hidden"),s("tr.detail-show",this.tableElement).each(function(p,D){var b=s(D);b.next(".row-detail").length===0&&Se.prototype.showRowDetail(o,b)})):(this.tableElement.removeClass("has-columns-hidden"),s("tr.row-detail",this.tableElement).each(function(p){Se.prototype.hideRowDetail(o,s(this).prev())}))}};Se.prototype.showHideColumns=function(){for(var o=0,c=this.columnsShownIndexes.length;o<c;o++)this.api.column(this.columnsShownIndexes[o]).visible(!0);for(var o=0,c=this.columnsHiddenIndexes.length;o<c;o++)this.api.column(this.columnsHiddenIndexes[o]).visible(!1);var v=this;s("tr.row-detail",this.tableElement).each(function(){Se.prototype.hideRowDetail(v,s(this).prev())}),this.tableElement.hasClass("has-columns-hidden")&&s("tr.detail-show",this.tableElement).each(function(n,d){Se.prototype.showRowDetail(v,s(d))})};Se.prototype.createExpandIcon=function(o){if(!this.disabled)for(var c=s("td",o),v=0,n=c.length;v<n;v++){var d=c[v],i=this.api.cell(d).index().column;if(d=s(d),i===this.expandColumn){if(s("span.responsiveExpander",d).length==0)switch(d.prepend(this.expandIconTemplate),this.options.clickOn){case"cell":d.on("click",{responsiveDatatablesHelperInstance:this},this.showRowDetailEventHandler);break;case"row":s(o).on("click",{responsiveDatatablesHelperInstance:this},this.showRowDetailEventHandler);break;default:d.on("click","span.responsiveExpander",{responsiveDatatablesHelperInstance:this},this.showRowDetailEventHandler);break}break}}};Se.prototype.showRowDetailEventHandler=function(o){var c=o.data.responsiveDatatablesHelperInstance;if(!c.disabled){var v=s(this);if(v.closest("table").hasClass("has-columns-hidden")){var n=v.closest("tr");n.hasClass("detail-show")?Se.prototype.hideRowDetail(c,n):Se.prototype.showRowDetail(c,n),n.toggleClass("detail-show"),o.stopPropagation()}}};Se.prototype.showRowDetail=function(o,c){for(var v=o.api,n=v.columns().header(),d=s(o.rowTemplate),i=s("ul",d),x=0;x<o.columnsHiddenIndexes.length;x++){var O=o.columnsHiddenIndexes[x],p=v.row(c).index(),D=v.cell(p,O).node();if(!o.options.hideEmptyColumnsInRowDetail||D.innerHTML.trim().length){var b=s(o.rowLiTemplate),P=s(n[O]).attr("data-name");s(".columnTitle",b).html(P!==void 0?P:n[O].innerHTML);for(var t=s(D).contents(),M=t.clone(),Y=0,y=t.length;Y<y;Y++){var k=t[Y];k.nodeType===Node.ELEMENT_NODE&&k.tagName==="SELECT"&&(M[Y].selectedIndex=k.selectedIndex)}s(".columnValue",b).append(M).data("originalTdSource",D),b.attr("data-column",O);var U=s(D).attr("class");U!=="undefined"&&U!==!1&&U!==""&&b.addClass(U),i.append(b)}}var $=o.columnIndexes.length-o.columnsHiddenIndexes.length;d.find("> td").attr("colspan",$),c.after(d),o.options.showDetail&&o.options.showDetail(d)};Se.prototype.hideRowDetail=function(o,c){var v=c.next(".row-detail");o.options.hideDetail&&o.options.hideDetail(v),v.find("li").each(function(){var n=s(this).find("span.columnValue"),d=n.contents(),i=n.data("originalTdSource");s(i).empty().append(d)}),v.remove()};Se.prototype.disable=function(o){this.disabled=o===void 0||o,this.disabled?(this.setWindowsResizeHandler(!1),s("tbody tr.row-detail",this.tableElement).remove(),s("tbody tr",this.tableElement).removeClass("detail-show"),s("tbody tr span.responsiveExpander",this.tableElement).remove(),this.columnsHiddenIndexes=[],this.columnsShownIndexes=this.columnIndexes,this.showHideColumns(),this.tableElement.removeClass("has-columns-hidden"),this.tableElement.off("click","span.responsiveExpander",this.showRowDetailEventHandler)):this.setWindowsResizeHandler()};Se.prototype.getState=function(){var o=JSON.parse(localStorage.getItem(this.cookieName));o&&(this.columnIndexes=o.columnIndexes,this.breakpoints=o.breakpoints,this.expandColumn=o.expandColumn,this.lastBreakpoint=o.lastBreakpoint,this.lastStateExists=!0)};Se.prototype.setState=function(){var o=this.difference(this.lastColumnsHiddenIndexes,this.columnsHiddenIndexes).length,c=this.difference(this.columnsHiddenIndexes,this.lastColumnsHiddenIndexes).length;if(o+c>0){var v={columnIndexes:this.columnIndexes,columnsHiddenIndexes:this.columnsHiddenIndexes,breakpoints:this.breakpoints,expandColumn:this.expandColumn,lastBreakpoint:this.lastBreakpoint};localStorage.setItem(this.cookieName,JSON.stringify(v)),this.lastColumnsHiddenIndexes=this.columnsHiddenIndexes.slice(0)}};Se.prototype.difference=function(o,c){var v=[],n,d={};for(n=c.length-1;n>=0;n--)d[c[n]]=!0;for(n=o.length-1;n>=0;n--)d[o[n]]!==!0&&v.push(o[n]);return v};const Wt={id:"DataTable"},Kt=["id"],Qt=["data-class"],Xe={__name:"datatable",props:{dtHeaders:{type:Array,required:!0},dtOptions:{type:Object,required:!0},id:{required:!0}},setup(o,{expose:c}){const v=o,n=a(null),d=a(null),i=function(){var x,O={tablet:992,phone:768},p={autoWidth:!1,preDrawCallback:function(){x||(x=new Se(n.value,O))},rowCallback:function(b){x.createExpandIcon(b)},drawCallback:function(b){x.respond()}},D=Object.assign(v.dtOptions,p);d.value=s(n.value).DataTable(D),s(n.value).on("resize",function(b){d.value.draw(!0)})};return $e(function(){n.value=s("#"+v.id),s.fn.dataTable.ext.errMode="throw",i()}),c({vmDataTable:d,table:n}),(x,O)=>(C(),S("div",Wt,[e("table",{class:"hover table border table-striped table-bordered dt-responsive",cellspacing:"0",width:"100%",id:o.id},[e("thead",null,[e("tr",null,[(C(!0),S(ie,null,de(o.dtHeaders,(p,D)=>(C(),S("th",{"data-class":D==0?"expand":null},H(p),9,Qt))),256))])]),O[0]||(O[0]=e("tbody",null,null,-1))],8,Kt)]))}},et=(o,c)=>{const v=o.__vccOpts||o;for(const[n,d]of c)v[n]=d;return v},Zt=["transition"],es={class:"modal-content"},ts={class:"modal-header"},ss={class:"modal-title"},os={class:"modal-body"},as={class:"modal-footer"},ls={__name:"bootstrap-modal",props:{title:{type:String,default:"Modal"},small:{type:Boolean,default:!1},large:{type:Boolean,default:!1},full:{type:Boolean,default:!1},force:{type:Boolean,default:!1},transition:{type:String,default:"modal"},showOK:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},okText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},okClass:{type:String,default:"btn btn-primary"},cancelClass:{type:String,default:"btn btn-danger btn-outline"},closeWhenOK:{type:Boolean,default:!1},isModalOpen:{type:Boolean,default:!1}},emits:["ok","cancel"],setup(o,{expose:c,emit:v}){const n=v,d=o,i=a(null),x=Q(()=>({"modal-lg":d.large,"modal-sm":d.small,"modal-full":d.full})),O=Q(()=>d.isModalOpen);c({isModalOpen:d.isModalOpen}),Ht(()=>{document.body.className=document.body.className.replace(/\s?modal-open/,"")});const p=function(){n("ok"),d.closeWhenOK},D=function(){n("cancel")},b=function(){d.force||D()};return ge(()=>O,function(P){P?document.body.className+=" modal-open":window.setTimeout(()=>{document.body.className=document.body.className.replace(/\s?modal-open/,"")},i.value||0)}),(P,t)=>g((C(),S("div",{transition:o.transition},[e("div",{class:"modal",onClick:_e(b,["self"])},[e("div",{class:Le(["modal-dialog",x.value])},[e("div",es,[e("div",ts,[e("h5",ss,[Ke(P.$slots,"title",{},()=>[W(H(o.title),1)],!0)]),e("button",{type:"button",class:"btn btn-default","data-dismiss":"modal","aria-label":"Close",onClick:D},t[0]||(t[0]=[e("span",{"aria-hidden":"true"},"×",-1)]))]),e("div",os,[Ke(P.$slots,"default",{},void 0,!0)]),e("div",as,[Ke(P.$slots,"footer",{},()=>[o.showOK?(C(),S("button",{key:0,id:"okBtn",type:"button",class:Le(o.okClass),onClick:p},H(o.okText),3)):fe("",!0),o.showCancel?(C(),S("button",{key:1,type:"button",class:Le(o.cancelClass),onClick:D},H(o.cancelText),3)):fe("",!0)],!0)])])],2)]),t[1]||(t[1]=e("div",{class:"modal-backdrop show"},null,-1))],8,Zt)),[[ae,O.value]])}},Ae=et(ls,[["__scopeId","data-v-5d8dd9ec"]]),ns={class:"row",id:"reasons"},rs={class:"form-group"},is={key:0,class:"form-control form-select"},ds=["value"],us=["value"],qe={__name:"reasons",props:{type:{required:!0},value:{},large:{default:!1}},emits:["input"],setup(o,{emit:c}){const v=o,n=c,d=a([]),i=function(){s.get(G.closureReasons(),function(D){d.value=D})},x=function(){s.get(G.maxStayReasons(),function(D){d.value=D})},O=function(){s.get(G.priceReasons(),function(D){d.value=D})},p=function(){s.get(G.discountReasons(),function(D){d.value=D})};return $e(function(){if(v.type)switch(v.type.toLowerCase()){case"close":i();break;case"stay":x();break;case"price":O();break;case"discount":p()}}),(D,b)=>(C(),S("div",ns,[e("div",rs,[e("div",{class:Le({"col-md-4":o.large,"col-md-2":!o.large})},b[1]||(b[1]=[e("label",null,"Reason: ",-1)]),2),e("div",{class:Le({"col-md-8":o.large,"col-md-4":!o.large})},[!d.value.length>0?(C(),S("select",is,b[2]||(b[2]=[e("option",{value:""},"Loading...",-1)]))):(C(),S("select",{key:1,name:"open_reason",value:o.value,onChange:b[0]||(b[0]=P=>n("input",P.target.value)),class:"form-control form-select"},[b[3]||(b[3]=e("option",{value:""},null,-1)),(C(!0),S(ie,null,de(d.value,P=>(C(),S("option",{value:P.id},H(P.text),9,us))),256))],40,ds))],2)])]))}},cs={class:"modal-body"},ps={id:"closeCGForm",class:"form-horizontal"},vs={class:"row"},ms={class:"form-group"},fs={class:"col-md-4"},_s={class:"input-group date",id:"close_cg_range_start"},gs={class:"row"},hs={class:"form-group"},ys={class:"col-md-4"},bs={class:"input-group date",id:"close_cg_range_end"},ks={class:"row"},$s={class:"form-group"},Cs={class:"col-md-5"},ws={__name:"closeCampground",emits:["isOpenCloseCG","refreshCGTable"],setup(o,{emit:c}){a("");const v=a({campground:"",range_start:"",range_end:"",closure_reason:"",status:"1",details:""}),n=a(""),d=a(""),i=a(!1),x=a(!1),O=a(""),p=a(""),D=a(null),b=c,P=Q(function(){return i.value}),t=Q(function(){return x.value}),M=Q(function(){return v.value.closure_reason==="1"}),Y=function(){b("isOpenCloseCG",!1),v.value={campground:"",range_start:"",range_end:"",closure_reason:"",status:"1",details:""},x.value=!1,D.value.selected=""},y=function(){p.value.valid()&&k()},k=function(){var $=v.value;s.ajax({url:G.campground_booking_ranges(),method:"POST",xhrFields:{withCredentials:!0},data:$,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(u,f,q){Y(),b("refreshCGTable")},error:function(u){i.value=!0,O.value=re.apiError(u)}})},U=function(){p.value.validate({rules:{closure_start:"required",closure_reason:"required",closure_details:{required:{depends:function($){return M.value}}}},messages:{closure_start:"Enter a start date",closure_reason:"Select a closure reason from the options",closure_details:"Details required if Other reason is selected"},showErrors:function($,u){s.each(this.validElements(),function(A,w){var m=s(w);m.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var f=0;f<u.length;f++){var q=u[f];s(q.element).tooltip({trigger:"focus"}).attr("data-original-title",q.message).parents(".form-group").addClass("has-error")}}})};return $e(function(){Ie.on("closeCG",function(f){v.value.campground=f.id});const $=s("#close_cg_range_start"),u=s("#close_cg_range_end");n.value=xe($,{restrictions:{minDate:new Date}}),d.value=xe(u,{useCurrent:!1}),$.on("change.td",function(f){const q=n.value.dates.lastPicked;v.value.range_start=q?ne.formatDate(q,"dd/MM/yyyy"):"",q&&d.value.updateOptions({restrictions:{minDate:q}})}),u.on("change.td",function(f){const q=d.value.dates.lastPicked;v.value.range_end=q?ne.formatDate(q,"dd/MM/yyyy"):""}),p.value=s("#closeCGForm"),U()}),($,u)=>(C(),Ye(Ae,{title:"(Temporarily) close campground",large:!0,onOk:u[5]||(u[5]=f=>y()),onCancel:u[6]||(u[6]=f=>Y()),isModalOpen:t.value},{default:ue(()=>[e("div",cs,[e("form",ps,[e("div",vs,[ee(Ee,{show:P.value,"onUpdate:show":u[0]||(u[0]=f=>P.value=f),type:"danger"},{default:ue(()=>[W(H(O.value),1)]),_:1},8,["show"]),e("div",ms,[u[8]||(u[8]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_start"},"Closure start: ")],-1)),e("div",fs,[e("div",_s,[g(e("input",{name:"closure_start","onUpdate:modelValue":u[1]||(u[1]=f=>v.value.range_start=f),type:"text",class:"form-control"},null,512),[[X,v.value.range_start]]),u[7]||(u[7]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),e("div",gs,[e("div",hs,[u[10]||(u[10]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_start"},"Reopen on: ")],-1)),e("div",ys,[e("div",bs,[g(e("input",{name:"closure_end","onUpdate:modelValue":u[2]||(u[2]=f=>v.value.range_end=f),type:"text",class:"form-control"},null,512),[[X,v.value.range_end]]),u[9]||(u[9]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"close",modelValue:v.value.closure_reason,"onUpdate:modelValue":u[3]||(u[3]=f=>v.value.closure_reason=f),ref_key:"reason",ref:D},null,8,["modelValue"]),g(e("div",ks,[e("div",$s,[u[11]||(u[11]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_details"},"Details: ")],-1)),e("div",Cs,[g(e("textarea",{name:"closure_details","onUpdate:modelValue":u[4]||(u[4]=f=>v.value.details=f),class:"form-control",id:"close_cg_details"},null,512),[[X,v.value.details]])])])],512),[[ae,M.value]])])])]),_:1},8,["isModalOpen"]))}},xs={class:"modal-body"},Ds={id:"openCGForm",class:"form-horizontal"},Ts={class:"row"},Ss={class:"form-group"},Ms={class:"col-md-4"},Es={class:"row"},Ps={class:"form-group"},Rs={class:"col-md-4"},Os={class:"input-group date",id:"open_cg_range_end"},Ys={class:"row"},Us={class:"form-group"},As={class:"col-md-5"},Vs={__name:"openCampground",emits:["isOpenOpenCG","refreshCGTable"],setup(o,{emit:c}){const v=a(""),n=a(""),d=a({range_end:"",closure_reason:"",details:""}),i=a(""),x=a(!1),O=a(!1),p=a(""),D=a(""),b=Q(function(){return x.value}),P=Q(function(){return O.value}),t=Q(function(){return d.value.closure_reason==="1"}),M=c,Y=function(){M("isOpenOpenCG",!1),O.value=!1},y=function(){D.value.valid()&&k()},k=function(){var $=d.value;const u=i.value.dates.lastPicked;$.range_end=u?ne.formatDate(u,"dd/MM/yyyy"):"",s.ajax({url:G.campground_booking_ranges_detail(v.value),method:"PATCH",xhrFields:{withCredentials:!0},data:$,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(f,q,A){Y(),M("refreshCGTable")},error:function(f){x.value=!0,p.value=re.apiError(f)}})},U=function(){D.value.validate({rules:{open_start:"required",open_reason:"required",open_details:{required:{depends:function($){return t.value}}}},messages:{open_start:"Enter a reopening date",open_reason:"Select an open reason from the options",open_details:"Details required if Other reason is selected"},showErrors:function($,u){s.each(this.validElements(),function(A,w){var m=s(w);m.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var f=0;f<u.length;f++){var q=u[f];s(q.element).tooltip({trigger:"focus"}).attr("data-original-title",q.message).parents(".form-group").addClass("has-error")}}})};return $e(function(){Ie.on("openCG",function(u){v.value=u.id,n.value=u.closure});const $=s("#open_cg_range_end");i.value=xe($,{useCurrent:!1,restrictions:{minDate:ne.addDays(new Date,1)}}),$.on("change.td",function(u){const f=i.value.dates.lastPicked;d.value.range_end=f?ne.formatDate(f,"dd/MM/yyyy"):""}),D.value=s("#openCGForm"),U()}),($,u)=>(C(),Ye(Ae,{title:"Open campground",large:!0,onOk:u[5]||(u[5]=f=>y()),onCancel:u[6]||(u[6]=f=>Y()),isModalOpen:P.value},{default:ue(()=>[e("div",xs,[e("form",Ds,[e("div",Ts,[ee(Ee,{show:b.value,"onUpdate:show":u[0]||(u[0]=f=>b.value=f),type:"danger"},null,8,["show"]),e("div",Ss,[u[7]||(u[7]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_current_closure"},"Current Closure: ")],-1)),e("div",Ms,[g(e("input",{id:"open_cg_current_closure","onUpdate:modelValue":u[1]||(u[1]=f=>n.value=f),disabled:"",type:"text",class:"form-control"},null,512),[[X,n.value]])])])]),e("div",Es,[e("div",Ps,[u[9]||(u[9]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_end"},"Reopen on: ")],-1)),e("div",Rs,[e("div",Os,[g(e("input",{name:"open_start","onUpdate:modelValue":u[2]||(u[2]=f=>d.value.range_end=f),type:"text",class:"form-control"},null,512),[[X,d.value.range_end]]),u[8]||(u[8]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"close",modelValue:d.value.closure_reason,"onUpdate:modelValue":u[3]||(u[3]=f=>d.value.closure_reason=f)},null,8,["modelValue"]),g(e("div",Ys,[e("div",Us,[u[10]||(u[10]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_details"},"Details: ")],-1)),e("div",As,[g(e("textarea",{name:"open_details","onUpdate:modelValue":u[4]||(u[4]=f=>d.value.details=f),class:"form-control",id:"open_cg_details"},null,512),[[X,d.value.details]])])])],512),[[ae,t.value]])])])]),_:1},8,["isModalOpen"]))}},qs={class:"panel-heading clearfix"},Fs={class:"panel-title pull-left",style:{"padding-top":"7.5px"}},js={class:"btn-group pull-right"},Dt={__name:"base-panel-heading",props:{title:String},setup(o){return(c,v)=>(C(),S("div",qs,[e("h3",Fs,H(o.title),1),e("div",js,[Ke(c.$slots,"default",{style:"justify-content: space-around;"})])]))}},Is={id:"bulk-close"},Hs={class:"body"},Ls={name:"closeForm",class:"form-horizontal"},Ns={class:"row"},Bs={class:"form-group"},Gs={class:"col-md-8"},Js=["value"],zs={class:"row"},Xs={class:"form-group"},Ws={class:"col-md-8"},Ks={class:"row"},Qs={class:"form-group"},Zs={class:"col-md-8"},eo={class:"row"},so={class:"form-group"},oo={class:"col-md-8"},ao={__name:"bulk-close",emits:["close"],setup(o,{expose:c,emit:v}){const n=Ge(),d=crypto.randomUUID(),i="close_cg_range_end"+d,x="close_cg_range_start"+d,O=a(!1),p=a(null),D=a(null),b=a(""),P=a(""),t=a(""),M=a(""),Y=a(""),y=a([]),k=a(null),U=Q(function(){return b.value==="1"}),$=Q(function(){return n.getters.campgrounds}),u=v,f=function(){u("close"),P.value="",t.value="",y.value=[],b.value="",D.value.clear(),p.value.clear(),O.value=!1},q=function(){const B=s("#"+x),te=s("#"+i);D.value=xe(B,{restrictions:{minDate:new Date}}),p.value=xe(te,{useCurrent:!1}),B.on("change.td",function(I){const h=D.value.dates.lastPicked;P.value=h?ne.formatDate(h,"dd/MM/yyyy"):"",h&&p.value.updateOptions({restrictions:{minDate:h}})}),te.on("change.td",function(I){const h=p.value.dates.lastPicked;t.value=h?ne.formatDate(h,"dd/MM/yyyy"):""}),E(),A(),w()},A=function(){$.value.length==0&&n.dispatch("fetchCampgrounds")},w=function(){setTimeout(function(){s("#bc-campgrounds").select2({theme:"bootstrap",allowClear:!0,placeholder:"Select Campgrounds",tags:!1}).on("select2:select",function(B){y.value=s(B.currentTarget).val()}).on("select2:unselect",function(B){y.value=s(B.currentTarget).val()})},100)},m=function(){if(k.value.valid()&&y.value.length>0){let B={range_start:P.value,range_end:t.value,campgrounds:y.value,closure_reason:b.value,status:"1"};b.value=="1"&&(B.details=M.value),s.ajax({url:G.bulk_close,method:"POST",xhrFields:{withCredentials:!0},data:B,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(te,I,h){n.dispatch("updateAlert",{visible:!0,type:"success",message:te}),f()},error:function(te){n.dispatch("updateAlert",{visible:!0,type:"danger",message:re.apiError(te)}),f()}})}},E=function(){k.value.validate({rules:{closure_start:"required",closure_status:"required",open_reason:"required",closure_details:{required:{depends:function(B){return U.value}}}},messages:{closure_start:"Enter a start date",closure_status:"Select a closure reason from the options",closure_details:"Details required if Other reason is selected"},showErrors:function(B,te){s.each(this.validElements(),function(T,R){var _=s(R);_.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var I=0;I<te.length;I++){var h=te[I];s(h.element).tooltip({trigger:"focus"}).attr("data-original-title",h.message).parents(".form-group").addClass("has-error")}}})};return c({isModalOpen:O,initSelectTwo:w}),$e(function(){k.value=s(document.forms.closeForm),q()}),(B,te)=>(C(),S("div",Is,[ee(Ae,{okText:"Close Campgrounds",onOk:te[5]||(te[5]=I=>m()),force:!0},{default:ue(()=>[te[12]||(te[12]=e("h4",{slot:"title"},"Bulk Close Campgrounds",-1)),e("div",Hs,[ee(Ee,{show:!1,type:"danger"},{default:ue(()=>[W(H(Y.value),1)]),_:1}),e("form",Ls,[e("div",Ns,[e("div",Bs,[te[6]||(te[6]=e("div",{class:"col-md-4"},[e("label",{for:"Campgrounds"},"Campgrounds")],-1)),e("div",Gs,[g(e("select",{class:"form-control",name:"campgrounds",placeholder:"",multiple:"","onUpdate:modelValue":te[0]||(te[0]=I=>y.value=I)},[(C(!0),S(ie,null,de($.value,I=>(C(),S("option",{value:I.id},H(I.name),9,Js))),256))],512),[[ke,y.value]])])])]),e("div",zs,[e("div",Xs,[te[8]||(te[8]=e("div",{class:"col-md-4"},[e("label",{for:"open_cg_range_start"},"Closure start: ")],-1)),e("div",Ws,[e("div",{class:"input-group date",id:x},[g(e("input",{name:"closure_start","onUpdate:modelValue":te[1]||(te[1]=I=>P.value=I),type:"text",class:"form-control"},null,512),[[X,P.value]]),te[7]||(te[7]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),e("div",Ks,[e("div",Qs,[te[10]||(te[10]=e("div",{class:"col-md-4"},[e("label",{for:"open_cg_range_start"},"Reopen on: ")],-1)),e("div",Zs,[e("div",{class:"input-group date",id:i},[g(e("input",{name:"closure_end","onUpdate:modelValue":te[2]||(te[2]=I=>t.value=I),type:"text",class:"form-control"},null,512),[[X,t.value]]),te[9]||(te[9]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"close",modelValue:b.value,"onUpdate:modelValue":te[3]||(te[3]=I=>b.value=I),large:!0},null,8,["modelValue"]),g(e("div",eo,[e("div",so,[te[11]||(te[11]=e("div",{class:"col-md-4"},[e("label",null,"Details: ")],-1)),e("div",oo,[g(e("textarea",{name:"closure_details","onUpdate:modelValue":te[4]||(te[4]=I=>M.value=I),class:"form-control",id:"close_cg_details"},null,512),[[X,M.value]])])])],512),[[ae,U.value]])])])]),_:1})]))}},lo={id:"groundsList"},no={class:"panel-group",id:"returns-accordion",role:"tablist","aria-multiselectable":"true"},ro={class:"panel panel-default border p-3",id:"returns"},io={class:"form-group text-end"},uo={id:"returns-collapse",oldclass:"panel-collapse collapse in",role:"tabpanel","aria-labelledby":"returns-heading"},co={class:"panel-body"},po={id:"groundsList"},vo={class:"col-12"},mo={class:"form",id:"campgrounds-filter-form"},fo={class:"row"},_o={class:"col-md-8"},go={class:"row"},ho={class:"col-md-3"},yo={class:"form-group"},bo={class:"col-md-3"},ko={class:"form-group"},$o=["value"],Co={class:"col-md-3"},wo={class:"form-group"},xo=["value"],Do={class:"col-md-3"},To={class:"form-group"},So=["value"],Mo={class:"col-12"},Eo={__name:"campgrounds",setup(o){const c=Ne(),v=Ge();a([]),a([]);const n=a("Campgrounds"),d=a("All"),i=a("All"),x=a("All"),O=a("All"),p=a(null),D=a(null);a(!1);const b=a(!1),P=a(!1),t=a(!1),M=a({responsive:!0,columnDefs:[{targets:[0,3],responsivePriority:1},{defaultContent:"-",targets:"_all"}],ajax:{url:G.campgrounds_datatable,dataSrc:""},columns:[{data:"name"},{data:"active",mRender:function(I,h,T){var R=I==!0?"Open":"Temporarily Closed",_="<td >__Status__</td>";return _+=I?"":"<br/><br/>"+T.current_closure,_.replace("__Status__",R)}},{data:"region"},{data:"district"},{data:"park"},{mRender:function(I,h,T){var R=T.id,_="";if(T.active)var _=`<td ><a href='#' class='detailRoute' data-campground="__ID__" >Edit </a><br/><a href='#' class='statusCG' data-status='close' data-campground="__ID__" > Close </a>`;else var _=`<td ><a href='#' class='detailRoute' data-campground="__ID__" >Edit </a><br/><a href='#' class='statusCG' data-status='open' data-campground="__ID__" data-current_closure="__Current_Closure__" data-current_closure_id="__Current_Closure_ID__">Open</a>`;return _+="</td>",_=_.replace(/__Current_Closure__/,T.current_closure),_=_.replace(/__Current_Closure_ID__/,T.current_closure_id),_.replace(/__ID__/g,R)}}],processing:!0}),Y=Q(()=>v.getters.regions),y=Q(()=>v.getters.districts),k=Q(()=>v.getters.parks);ge(()=>t,function(I){D.value.isModalOpen=I,D.value.initSelectTwo()}),ge(()=>i,function(I){I!="All"?p.value.vmDataTable.columns(2).search(I).draw():p.value.vmDataTable.columns(2).search("").draw()}),ge(()=>d,function(I){I!="All"?p.value.vmDataTable.columns(1).search(I).draw():p.value.vmDataTable.columns(1).search("").draw()}),ge(()=>O,function(I){I!="All"?p.value.vmDataTable.columns(3).search(I).draw():p.value.vmDataTable.columns(3).search("").draw()}),ge(()=>x,function(I){I!="All"?p.value.vmDataTable.columns(4).search(I).draw():p.value.vmDataTable.columns(4).search("").draw()});const U=function(){t.value=!1,p.value.vmDataTable.ajax.reload()},$=function(I){b.value=I},u=function(I){P.value=I},f=function(){P.value=!0},q=function(){b.value=!0},A=function(){p.value.vmDataTable.ajax.reload()},w=function(I){c.push({name:"cg_detail",params:{id:I}})},m=function(I){c.push({name:"cg_add"})},E=function(){Y.value.length==0&&v.dispatch("fetchRegions")},B=function(){k.value.length==0&&v.dispatch("fetchParks")},te=function(){y.value.length==0&&v.dispatch("fetchDistricts")};return $e(function(){p.value.vmDataTable.on("click",".detailRoute",function(I){I.preventDefault();var h=s(this).attr("data-campground");w(h)}),p.value.vmDataTable.on("click",".statusCG",function(I){I.preventDefault();var h=s(this).attr("data-campground"),T=s(this).attr("data-status"),R=s(this).attr("data-current_closure")?s(this).attr("data-current_closure"):"",_=s(this).attr("data-current_closure_id")?s(this).attr("data-current_closure_id"):"";if(T==="open"){var V={id:_,closure:R};Ie.emit("openCG",V),q()}else if(T==="close"){var V={id:h};Ie.emit("closeCG",V),f()}}),p.value.vmDataTable.on("click",".addBooking",function(I){I.preventDefault();var h=s(this).attr("data-campground");c.push({name:"add-booking",params:{cg:h}})}),E(),B(),te()}),(I,h)=>(C(),S("div",lo,[ee(ws,{onIsOpenCloseCG:u,onRefreshCGTable:A}),ee(Vs,{onIsOpenOpenCG:$,onRefreshCGTable:A}),e("div",no,[e("div",ro,[ee(Dt,{title:n.value},{default:ue(()=>[e("div",io,[e("a",{style:{"margin-top":"20px"},class:"btn btn-primary",onClick:h[0]||(h[0]=T=>m())},"Add Campground"),e("a",{style:{"margin-top":"20px"},class:"btn btn-primary",onClick:h[1]||(h[1]=T=>t.value=!t.value)}," Close Campgrounds")])]),_:1},8,["title"]),e("div",uo,[e("div",co,[e("div",po,[e("div",vo,[e("form",mo,[e("div",fo,[e("div",_o,[e("div",go,[e("div",ho,[e("div",yo,[h[8]||(h[8]=e("label",{for:"campgrounds-filter-status"},"Status: ",-1)),g(e("select",{"onUpdate:modelValue":h[2]||(h[2]=T=>d.value=T),class:"form-control form-select",name:"status",id:"campgrounds-filter-status"},h[7]||(h[7]=[e("option",{value:"All"},"All",-1),e("option",{value:"Open"},"Open",-1),e("option",{value:"Temporarily Closed"},"Temporarily Closed ",-1)]),512),[[ke,d.value]])])]),e("div",bo,[e("div",ko,[h[10]||(h[10]=e("label",{for:"applications-filter-region"},"Region: ",-1)),g(e("select",{class:"form-control form-select","onUpdate:modelValue":h[3]||(h[3]=T=>i.value=T)},[h[9]||(h[9]=e("option",{value:"All"},"All",-1)),(C(!0),S(ie,null,de(Y.value,T=>(C(),S("option",{value:T.name},H(T.name),9,$o))),256))],512),[[ke,i.value]])])]),e("div",Co,[e("div",wo,[h[12]||(h[12]=e("label",{for:"applications-filter-region"},"District: ",-1)),g(e("select",{class:"form-control form-select","onUpdate:modelValue":h[4]||(h[4]=T=>O.value=T)},[h[11]||(h[11]=e("option",{value:"All"},"All",-1)),(C(!0),S(ie,null,de(y.value,T=>(C(),S("option",{value:T.name},H(T.name),9,xo))),256))],512),[[ke,O.value]])])]),e("div",Do,[e("div",To,[h[14]||(h[14]=e("label",{for:"applications-filter-region"},"Park: ",-1)),g(e("select",{class:"form-control form-select","onUpdate:modelValue":h[5]||(h[5]=T=>x.value=T)},[h[13]||(h[13]=e("option",{value:"All"},"All",-1)),(C(!0),S(ie,null,de(k.value,T=>(C(),S("option",{value:T.name},H(T.name),9,So))),256))],512),[[ke,x.value]])])])])])])])]),e("div",Mo,[ee(Xe,{dtHeaders:["Campground","Status","Region","District","Park","Action"],dtOptions:M.value,ref_key:"dtGrounds",ref:p,id:"campground-table"},null,8,["dtOptions"])])])])])])]),ee(ao,{show:t.value,ref_key:"bulkClose",ref:D,onClose:h[6]||(h[6]=T=>U())},null,8,["show"])]))}},Po={__name:"confirmbox",props:{options:{required:!0,type:Object},id:{required:!0},cancelText:{default:"Cancel"}},setup(o){const c=o,{options:v,id:n,cancelText:d}=at(c),i=crypto.randomUUID(),x="confirmModal"+i,O="modalIcon"+i,p="modalText"+i,D="modalButtons"+i;Array();const b=function(P){const t=P,M=s("#"+x),Y=s("#"+O),y=s("#"+p),k="#"+D,U=t.id,$=typeof t.autoclose<"u"?t.autoclose:!0;s(Y).html(t.icon),s(y).html(t.message),s(k).html(""),typeof t.buttons<"u"&&s.each(t.buttons,function(u,f){typeof f.eventHandler<"u"&&f.eventHandler,s(k).append('<button type="button" data-click='+f.event+' class="btn '+f.bsColor+`" style='margin-bottom:10px;'>`+f.text+"</button>"),s(function(){U===n.value&&s("button[data-click]").on("click",function(){s(this).attr("data-click")==f.event&&f.handler(),$&&s(M).modal("hide")})})}),s(k).append(`<button type="button" data-dismiss="modal" class="btn btn-default" style='margin-bottom:10px;'>`+d.value+"</button>")};return $e(function(){b(v.value),Ie.on("showAlert",function(P){console.log("ShowAlert +1"),console.log(x),console.log(P),console.log(s("#"+x)),P===n.value&&s("#"+x).modal("show")})}),(P,t)=>(C(),S("div",{id:x,class:"modal iiifade"},[e("div",{class:"modal-dialog modal-sm"},[e("div",{class:"modal-content"},[e("div",{class:"modal-body"},[e("div",{class:"row"},[e("div",{id:O,class:"col-sm-12 text-center",style:{"font-size":"75px"}}),e("div",{class:"col-sm-12 text-center"},[e("p",{id:p})])])]),e("div",{class:"modal-footer"},[e("div",{class:"row"},[e("div",{class:"col-lg-12",id:D})])])])])]))}},rt=et(Po,[["__scopeId","data-v-e6c74134"]]),Ro={class:"modal-body"},Oo={name:"closeForm",class:"form-horizontal"},Yo={class:"row"},Uo={class:"form-group"},Ao={class:"col-md-4"},Vo={class:"row"},qo={class:"form-group"},Fo={class:"col-md-4"},jo={class:"row"},Io={class:"form-group"},Ho={class:"col-md-4"},Lo={__name:"close",props:{statusHistory:{type:Object,required:!0},title:{type:String,required:!0}},emits:["inFocus","submit"],setup(o,{expose:c,emit:v}){const n=o,d=v;a("");const i=crypto.randomUUID(),x="close_cg_range_start"+i,O="close_cg_range_end"+i;a(""),a(!1);const p=a(!1),D=a(""),b=a(null),P=a(n.statusHistory),t=a(!1),M=a(null),Y=a(null),y=Q(function(){return p.value}),k=Q(function(){return t.value}),U=Q(function(){return P.value.id?P.value.id:""}),$=Q(function(){return P.value.closure_reason==="1"}),u=function(){p.value=!1,D.value="",t.value=!1,P.value.id="",P.value.range_start="",P.value.range_end="",P.value.status="1",P.value.details="",P.value.reason="",P.value.closure_reason="",Y.value.clear(),M.value.clear()},f=function(){b.value.valid()&&(U.value?d("updateRange"):d("closeRange"))},q=function(){b.value.validate({rules:{closure_start:"required",closure_status:"required",closure_details:{required:{depends:function(A){return $}}}},messages:{closure_start:"Enter a start date",closure_status:"Select a closure reason from the options",closure_details:"Details required if Other reason is selected"},showErrors:function(A,w){s.each(this.validElements(),function(B,te){var I=s(te);I.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var m=0;m<w.length;m++){var E=w[m];s(E.element).tooltip({trigger:"focus"}).attr("data-original-title",E.message).parents(".form-group").addClass("has-error")}}})};return $e(()=>{P.value.status=1,P.value.reason="",b.value=s(document.forms.closeForm);const A=s("#"+x),w=s("#"+O);M.value=xe(A,{restrictions:{minDate:new Date}}),Y.value=xe(w,{useCurrent:!1}),A.on("change.td",function(m){const E=M.value.dates.lastPicked;P.value.range_start=E?ne.formatDate(E,"dd/MM/yyyy"):"",E&&Y.value.updateOptions({restrictions:{minDate:E}})}),w.on("change.td",function(m){const E=Y.value.dates.lastPicked;P.value.range_end=E?ne.formatDate(E,"dd/MM/yyyy"):""}),q()}),c({close:u,closure_id:U,statusHistory:P,isOpen:t,errors:p,errorString:D}),(A,w)=>(C(),Ye(Ae,{title:o.title,large:!0,onOk:w[5]||(w[5]=m=>f()),onCancel:w[6]||(w[6]=m=>u()),isModalOpen:k.value},{default:ue(()=>[e("div",Ro,[e("form",Oo,[e("div",Yo,[ee(Ee,{show:y.value,"onUpdate:show":w[0]||(w[0]=m=>y.value=m),type:"danger"},{default:ue(()=>[W(H(D.value),1)]),_:1},8,["show"]),e("div",Uo,[w[8]||(w[8]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_start"},"Closure start: ")],-1)),e("div",Ao,[e("div",{class:"input-group date",id:x},[g(e("input",{name:"closure_start","onUpdate:modelValue":w[1]||(w[1]=m=>P.value.range_start=m),type:"text",class:"form-control"},null,512),[[X,P.value.range_start]]),w[7]||(w[7]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),e("div",Vo,[e("div",qo,[w[10]||(w[10]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_start"},"Reopen on: ")],-1)),e("div",Fo,[e("div",{class:"input-group date",id:O},[g(e("input",{name:"closure_end","onUpdate:modelValue":w[2]||(w[2]=m=>P.value.range_end=m),type:"text",class:"form-control"},null,512),[[X,P.value.range_end]]),w[9]||(w[9]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"close",modelValue:P.value.closure_reason,"onUpdate:modelValue":w[3]||(w[3]=m=>P.value.closure_reason=m)},null,8,["modelValue"]),g(e("div",jo,[e("div",Io,[w[11]||(w[11]=e("div",{class:"col-md-2"},[e("label",null,"Details: ")],-1)),e("div",Ho,[g(e("textarea",{name:"closure_details","onUpdate:modelValue":w[4]||(w[4]=m=>P.value.details=m),class:"form-control",id:"close_cg_details"},null,512),[[X,P.value.details]])])])],512),[[ae,$.value]])])])]),_:1},8,["title","isModalOpen"]))}},No={class:"row"},Bo={class:"well"},Go={class:"col-sm-4"},Tt={__name:"closureHistory",props:{datatableURL:{type:String,required:!0},closeCampground:{type:Boolean,default:!0},object_id:{type:Number,required:!0}},setup(o){const c=o,{datatableURL:v,closeCampground:n,object_id:d}=at(c),i=Q(()=>n.value?"(Temporarily) Close Campground":"(Temporarily) Close Campsite"),x=a(null),O=a(null);a({}),a({});const p=a({id:"",status:1,reason:"",closure_reason:""}),D=a(null),b=a({icon:"<i class='fa fa-exclamation-triangle fa-2x text-danger' aria-hidden='true'></i>",message:"Are you sure you want to Delete this closure Period",buttons:[{text:"Delete",event:"deleteClosure",bsColor:"btn-danger",handler:function(){Y(D.value),D.value=null},autoclose:!0}],id:"deleteClosure"}),P=["Closure Start","Reopen On","Closure Reason","Details","Action"],t={responsive:!0,processing:!0,deferRender:!0,columnDefs:[{defaultContent:"-",targets:"_all"}],ajax:{url:v.value,dataSrc:""},order:[],columns:[{data:"range_start",mRender:function(A,w,m){return ce(A).format("DD/MM/YYYY")},orderable:!1},{data:"range_end",mRender:function(A,w,m){return A?ce(A).format("DD/MM/YYYY"):""},orderable:!1},{mRender:function(A,w,m){return m.reason?m.reason:""},orderable:!1},{data:"details",orderable:!1,mRender:function(A,w,m){return parseInt(m.closure_reason)==1?A:""}},{data:"editable",mRender:function(A,w,m){if(A){var E=m.id,B=`<td ><a href='#' class='editRange' data-range="__ID__" >Edit</a><br/><a href='#' class='deleteRange' data-range="__ID__" >Delete</a></td>`;return B.replace(/__ID__/g,E)}else return""},orderable:!1}],language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"}},M=function(){x.value.isOpen=!0},Y=function(A){var w=k(A);s.ajax({method:"DELETE",url:w,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).done(function(m){O.value.vmDataTable.ajax.reload()})},y=function(){return n.value?G.campground_booking_ranges():G.campsite_booking_ranges()},k=function(A){return n.value?G.campground_status_history_detail(A):G.campsite_status_history_detail(A)},U=function(A){s.ajax({url:k(A),method:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(w,m,E){p.value=w,M()},error:function(w){}})},$=function(){f(y(),"POST")},u=function(){f(k(x.value.closure_id),"PUT")},f=function(A,w){var m=s.extend({},x.value.statusHistory);n.value?m.campground=d.value:m.campsite=d.value,s.ajax({url:A,method:w,xhrFields:{withCredentials:!0},data:m,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(E,B,te){x.value.close(),O.value.vmDataTable.ajax.reload()},error:function(E){var B=re.apiError(E);x.value.errorString=B,x.value.errors=!0}})},q=function(){O.value.vmDataTable.on("click",".editRange",function(A){A.preventDefault();var w=s(this).data("range");U(w)}),O.value.vmDataTable.on("click",".deleteRange",function(A){A.preventDefault();var w=s(this).data("range");D.value=w,Ie.emit("showAlert","deleteClosure")})};return $e(function(){q()}),(A,w)=>(C(),S("div",No,[ee(Lo,{ref_key:"closeModal",ref:x,onCloseRange:w[0]||(w[0]=m=>$()),onUpdateRange:w[1]||(w[1]=m=>u()),title:i.value,statusHistory:p.value},null,8,["title","statusHistory"]),e("div",Bo,[w[3]||(w[3]=e("div",{class:"col-sm-8"},[e("h1",null,"Closure History")],-1)),e("div",Go,[e("button",{onClick:w[2]||(w[2]=m=>M()),class:"btn btn-primary table_btn"},"Add Closure Period")]),ee(Xe,{ref_key:"closure_dt",ref:O,dtHeaders:P,dtOptions:t,id:"cg_table"},null,512)]),ee(rt,{id:"deleteClosure",options:b.value},null,8,["options"])]))}},Jo={class:"modal-body"},zo={name:"priceForm",class:"form-horizontal"},Xo={class:"row"},Wo={class:"form-group"},Ko={class:"col-md-4"},Qo=["value"],Zo={class:"row"},ea={class:"form-group"},ta={class:"col-md-4"},sa=["readonly"],oa={class:"row"},aa={class:"form-group"},la={class:"col-md-4"},na=["readonly"],ra={class:"row"},ia={class:"form-group"},da={class:"col-md-4"},ua=["readonly"],ca={class:"row"},pa={class:"form-group"},va={class:"col-md-4"},ma=["readonly"],fa={class:"row"},_a={class:"form-group"},ga={class:"col-md-4"},ha={class:"input-group date"},ya={class:"row"},ba={class:"form-group"},ka={class:"col-md-5"},$a={class:"row"},Ca={class:"form-group"},wa={class:"col-md-2"},xa={class:"col-md-4"},Da=["value"],Ta={__name:"priceHistoryDetail",props:{priceHistory:{type:Object,required:!0}},emits:["addPriceHistory","updatePriceHistory"],setup(o,{expose:c,emit:v}){const n=v,d=o;a("");const i=a(""),x=a(""),O=a([]),p=a([]),D=a(d.priceHistory);a(""),a(""),a(!1),a("");const b=a(!1),P=a(""),t=a(""),M=a(!1),Y=Q(function(){return b.value}),y=Q(function(){return M.value});Q(function(){return d.priceHistory.id?d.priceHistory.id:""});const k=Q(function(){return d.priceHistory.closure_reason==="1"});ge(()=>i,function(A){A!=""?s.each(O.value,function(w,m){m.id==A&&(console.log("SELECTED RATE"),console.log(m),D.value.rate=m.id,D.value.adult=m.adult,D.value.concession=m.concession,D.value.child=m.child,D.value.infant=m.infant,console.log("RATE POLICY"))}):(delete D.value.rate,D.value.adult="",D.value.concession="",D.value.child="",D.value.infant="",D.value.booking_policy="")});const U=function(){delete D.value.original,b.value=!1,i.value="",D.value.period_start="",D.value.details="",P.value="",M.value=!1},$=function(){s(t.value).valid()&&(D.value.id||D.value.original?n("updatePriceHistory",D.value):n("addPriceHistory",D.value))},u=function(){fetch(G.rates,function(A){O.value=A})},f=function(){console.log("fetchBookingPolicy 1"),console.log(G.booking_policy),fetch(G.booking_policy,function(A){p.value=A,console.log("fetchBookingPolicy"),console.log(p.value)})},q=function(){s(t.value).validate({rules:{adult:"required",concession:"required",child:"required",infant:"required",period_start:"required",details:{required:{depends:function(A){return D.value.reason==="1"}}}},messages:{adult:"Enter an adult rate",concession:"Enter a concession rate",child:"Enter a child rate",infant:"Enter a infant rate",period_start:"Enter a start date",details:"Details required if Other reason is selected"},showErrors:function(A,w){s.each(this.validElements(),function(B,te){var I=s(te);I.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var m=0;m<w.length;m++){var E=w[m];s(E.element).tooltip({trigger:"focus"}).attr("data-original-title",E.message).parents(".form-group").addClass("has-error")}}})};return $e(function(){s('[data-toggle="tooltip"]').tooltip(),t.value=document.forms.priceForm;const A=s(t.value.period_start),w=xe(A,{useCurrent:!1,restrictions:{minDate:ne.addDays(new Date,1)}});A.on("change.td",function(m){const E=w.dates.lastPicked;D.value.period_start=E?ne.formatDate(E,"dd/MM/yyyy"):""}),q(),f(),u()}),c({title:x,isOpen:M,errorString:P,errors:b,selected_rate:i}),(A,w)=>(C(),Ye(Ae,{title:x.value,large:!0,onOk:w[10]||(w[10]=m=>$()),onClose:w[11]||(w[11]=m=>U()),isModalOpen:y.value,onCancel:w[12]||(w[12]=m=>U())},{default:ue(()=>[e("div",Jo,[e("form",zo,[ee(Ee,{show:Y.value,"onUpdate:show":w[0]||(w[0]=m=>Y.value=m),type:"danger"},{default:ue(()=>[W(H(P.value),1)]),_:1},8,["show"]),e("div",Xo,[e("div",Wo,[w[14]||(w[14]=e("div",{class:"col-md-2"},[e("label",null,[e("i",{class:"fa fa-question-circle","data-toggle":"tooltip","data-placement":"bottom",title:"Select a rate to prefill the price fields otherwise use the manual entry"}),W("Select Rate: ")])],-1)),e("div",Ko,[g(e("select",{name:"rate","onUpdate:modelValue":w[1]||(w[1]=m=>i.value=m),class:"form-control"},[w[13]||(w[13]=e("option",{value:""},"Manual Entry",-1)),(C(!0),S(ie,null,de(O.value,m=>(C(),S("option",{value:m.id},H(m.name),9,Qo))),256))],512),[[ke,i.value]])])])]),e("div",Zo,[e("div",ea,[w[15]||(w[15]=e("div",{class:"col-md-2"},[e("label",null,"Adult Price: ")],-1)),e("div",ta,[g(e("input",{readonly:i.value!="",name:"adult","onUpdate:modelValue":w[2]||(w[2]=m=>D.value.adult=m),type:"text",class:"form-control"},null,8,sa),[[X,D.value.adult]])])])]),e("div",oa,[e("div",aa,[w[16]||(w[16]=e("div",{class:"col-md-2"},[e("label",null,"Concession Price: ")],-1)),e("div",la,[g(e("input",{readonly:i.value!="",name:"concession","onUpdate:modelValue":w[3]||(w[3]=m=>D.value.concession=m),type:"text",class:"form-control"},null,8,na),[[X,D.value.concession]])])])]),e("div",ra,[e("div",ia,[w[17]||(w[17]=e("div",{class:"col-md-2"},[e("label",null,"Child Price: ")],-1)),e("div",da,[g(e("input",{readonly:i.value!="",name:"child","onUpdate:modelValue":w[4]||(w[4]=m=>D.value.child=m),type:"text",class:"form-control"},null,8,ua),[[X,D.value.child]])])])]),e("div",ca,[e("div",pa,[w[18]||(w[18]=e("div",{class:"col-md-2"},[e("label",null,"Infant Price: ")],-1)),e("div",va,[g(e("input",{readonly:i.value!="",name:"infant","onUpdate:modelValue":w[5]||(w[5]=m=>D.value.infant=m),type:"text",class:"form-control"},null,8,ma),[[X,D.value.infant]])])])]),e("div",fa,[e("div",_a,[w[20]||(w[20]=e("div",{class:"col-md-2"},[e("label",null,"Period start: ")],-1)),e("div",ga,[e("div",ha,[g(e("input",{name:"period_start","onUpdate:modelValue":w[6]||(w[6]=m=>D.value.period_start=m),type:"text",class:"form-control"},null,512),[[X,D.value.period_start]]),w[19]||(w[19]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"price",modelValue:D.value.reason,"onUpdate:modelValue":w[7]||(w[7]=m=>D.value.reason=m)},null,8,["modelValue"]),g(e("div",ya,[e("div",ba,[w[21]||(w[21]=e("div",{class:"col-md-2"},[e("label",null,"Details: ")],-1)),e("div",ka,[g(e("textarea",{name:"details","onUpdate:modelValue":w[8]||(w[8]=m=>D.value.details=m),class:"form-control"},null,512),[[X,D.value.details]])])])],512),[[ae,k.value]]),e("div",$a,[e("div",Ca,[e("div",wa,[e("label",null,"Booking Policy: "+H(D.value.booking_policy),1)]),e("div",xa,[g(e("select",{name:"rate","onUpdate:modelValue":w[9]||(w[9]=m=>D.value.booking_policy=m),class:"form-control"},[w[22]||(w[22]=e("option",{value:""},"Select Booking Policy",-1)),(C(!0),S(ie,null,de(p.value.dataitems,m=>(C(),S("option",{value:m.id},H(m.policy_name),9,Da))),256))],512),[[ke,D.value.booking_policy]])])])])])])]),_:1},8,["title","isModalOpen"]))}},Sa={class:"modal-body"},Ma={name:"priceForm",class:"form-horizontal"},Ea={class:"row"},Pa={class:"form-group"},Ra={class:"col-md-4"},Oa={class:"row"},Ya={class:"form-group"},Ua={class:"col-md-4"},Aa={class:"row"},Va={class:"form-group"},qa={class:"col-md-4"},Fa={class:"row"},ja={class:"form-group"},Ia={class:"col-md-4"},Ha={class:"row"},La={class:"form-group"},Na={class:"col-md-4"},Ba={class:"row"},Ga={class:"form-group"},Ja={class:"col-md-4"},za={class:"row"},Xa={class:"form-group"},Wa={class:"col-md-4"},Ka={class:"row"},Qa={class:"form-group"},Za={class:"col-md-4"},el={class:"input-group date",date:""},tl={class:"row"},sl={class:"form-group"},ol={class:"col-md-5"},al={__name:"parkPriceHistoryDetail",props:{priceHistory:{type:Object,required:!0}},emits:["addParkPriceHistory","updateParkPriceHistory"],setup(o,{expose:c,emit:v}){const n=o,d=a(""),i=a(""),x=a(""),O=a(""),p=a(!1),D=a(null),b=a(n.priceHistory),P=a(!1),t=a(""),M=a(""),Y=a(!1),y=a(null),k=v,U=Q(function(){return P.value}),$=Q(function(){return Y.value}),u=Q(function(){return b.value.id?b.value.id:""}),f=Q(function(){return b.value.reason=="1"}),q=function(){delete b.value.original,P.value=!1,y.value="",b.value={vehicle:"",concession:"",motorbike:"",campervan:"",caravan:"",trailer:"",gst:!0,period_start:"",reason:"",details:""},t.value="",Y.value=!1},A=function(){s(M.value).valid()&&k(b.value.id?"updateParkPriceHistory":"addParkPriceHistory",b.value)},w=function(){s(M.value).validate({rules:{vehicle:"required",concession:"required",motorbike:"required",campervan:"required",trailer:"required",period_start:"required",details:{required:{depends:function(m){return b.value.reason==="1"}}}},messages:{vehicle:"Enter an vehicle rate",concession:"Enter a concession rate",motorbike:"Enter a motorbike rate",campervan:"Enter a campervan rate",caravan:"Enter a caravan rate",trailer:"Enter a trailer rate",period_start:"Enter a start date",details:"Details required if Other reason is selected"},showErrors:function(m,E){s.each(this.validElements(),function(I,h){var T=s(h);T.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var B=0;B<E.length;B++){var te=E[B];s(te.element).tooltip({trigger:"focus"}).attr("data-original-title",te.message).parents(".form-group").addClass("has-error")}}})};return $e(()=>{s('[data-toggle="tooltip"]').tooltip(),M.value=document.forms.priceForm;const m=s(M.value.period_start).closest(".date"),E=xe(m,{useCurrent:!1,restrictions:{minDate:ne.addDays(new Date,1)}});m.on("change.td",function(B){const te=E.dates.lastPicked;b.value.period_start=te?ne.formatDate(te,"yyyy-MM-dd"):""}),w()}),c({close:q,addHistory:A,showError:U,isOpen:Y,closure_id:u,requireDetails:f,id:d,title:i,current_closure:x,closeStartPicker:O,showDetails:p,closeEndPicker:D,selected_rate:y}),(m,E)=>(C(),Ye(Ae,{title:"Add Park Price History",large:!0,onOk:E[11]||(E[11]=B=>A()),onCancel:E[12]||(E[12]=B=>q()),onClose:E[13]||(E[13]=B=>q()),isModalOpen:$.value},{default:ue(()=>[e("div",Sa,[e("form",Ma,[ee(Ee,{show:U.value,"onUpdate:show":E[0]||(E[0]=B=>U.value=B),type:"danger"},{default:ue(()=>[W(H(t.value),1)]),_:1},8,["show"]),e("div",Ea,[e("div",Pa,[E[14]||(E[14]=e("div",{class:"col-md-2"},[e("label",null,"Car : ")],-1)),e("div",Ra,[g(e("input",{name:"vehicle","onUpdate:modelValue":E[1]||(E[1]=B=>b.value.vehicle=B),type:"number",class:"form-control"},null,512),[[X,b.value.vehicle]])])])]),e("div",Oa,[e("div",Ya,[E[15]||(E[15]=e("div",{class:"col-md-2"},[e("label",null,"Concession : ")],-1)),e("div",Ua,[g(e("input",{name:"concession","onUpdate:modelValue":E[2]||(E[2]=B=>b.value.concession=B),type:"number",class:"form-control"},null,512),[[X,b.value.concession]])])])]),e("div",Aa,[e("div",Va,[E[16]||(E[16]=e("div",{class:"col-md-2"},[e("label",null,"Motorbike : ")],-1)),e("div",qa,[g(e("input",{name:"motorbike","onUpdate:modelValue":E[3]||(E[3]=B=>b.value.motorbike=B),type:"number",class:"form-control"},null,512),[[X,b.value.motorbike]])])])]),e("div",Fa,[e("div",ja,[E[17]||(E[17]=e("div",{class:"col-md-2"},[e("label",null,"Campervan : ")],-1)),e("div",Ia,[g(e("input",{name:"motorbike","onUpdate:modelValue":E[4]||(E[4]=B=>b.value.campervan=B),type:"number",class:"form-control"},null,512),[[X,b.value.campervan]])])])]),e("div",Ha,[e("div",La,[E[18]||(E[18]=e("div",{class:"col-md-2"},[e("label",null,"Caravan : ")],-1)),e("div",Na,[g(e("input",{name:"caravan","onUpdate:modelValue":E[5]||(E[5]=B=>b.value.caravan=B),type:"number",class:"form-control"},null,512),[[X,b.value.caravan]])])])]),e("div",Ba,[e("div",Ga,[E[19]||(E[19]=e("div",{class:"col-md-2"},[e("label",null,"Trailer : ")],-1)),e("div",Ja,[g(e("input",{name:"motorbike","onUpdate:modelValue":E[6]||(E[6]=B=>b.value.trailer=B),type:"number",class:"form-control"},null,512),[[X,b.value.trailer]])])])]),e("div",za,[e("div",Xa,[E[20]||(E[20]=e("div",{class:"col-md-2"},[e("label",null,"GST : ")],-1)),e("div",Wa,[g(e("input",{name:"gst",id:"gst","onUpdate:modelValue":E[7]||(E[7]=B=>b.value.gst=B),type:"checkbox",checked:"",class:""},null,512),[[Te,b.value.gst]])])])]),e("div",Ka,[e("div",Qa,[E[22]||(E[22]=e("div",{class:"col-md-2"},[e("label",null,"Period start: ")],-1)),e("div",Za,[e("div",el,[g(e("input",{name:"period_start","onUpdate:modelValue":E[8]||(E[8]=B=>b.value.period_start=B),type:"text",class:"form-control"},null,512),[[X,b.value.period_start]]),E[21]||(E[21]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"price",modelValue:b.value.reason,"onUpdate:modelValue":E[9]||(E[9]=B=>b.value.reason=B)},null,8,["modelValue"]),g(e("div",tl,[e("div",sl,[E[23]||(E[23]=e("div",{class:"col-md-2"},[e("label",null,"Details: ")],-1)),e("div",ol,[g(e("textarea",{name:"details","onUpdate:modelValue":E[10]||(E[10]=B=>b.value.details=B),class:"form-control"},null,512),[[X,b.value.details]])])])],512),[[ae,f.value]])])])]),_:1},8,["isModalOpen"]))}},ll={class:"row"},nl={class:"well"},rl={class:"col-sm-4"},dt={__name:"priceHistory",props:{showAddBtn:{type:Boolean,default:!0},addPriceHistory:{type:Boolean,default:!0},addParkPrice:{type:Boolean,default:!1},level:{validator:function(o){var c=["campground","campsite_class","campsite","park"];return s.inArray(o,c)>-1}},historyDeleteURL:{type:String},object_id:{type:Number,required:!0},dt_options:{type:Object,required:!0,columnDefs:[{defaultContent:"-",targets:"_all"}]},dt_headers:{type:Array,default:()=>["Period Start","Period End","Adult Price","Concession Price","Child Price","Comment","Action"]}},setup(o,{expose:c}){const v=o,n=a(null),d=a(null),i=a({reason:""}),x=a({vehicle:"",concession:"",motorbike:"",reason:{id:1},period_start:"",details:"",booking_policy:""}),O=a(null),p=a({icon:"<i class='fa fa-exclamation-triangle fa-2x text-danger' aria-hidden='true'></i>",message:"Are you sure you want to Delete this Price History Record",buttons:[{text:"Delete",event:"delete",bsColor:"btn-danger",handler:function(){t(O.value),O.value=null},autoclose:!0}],id:"deleteHistory"}),D=function(){return i.value.id||i.value.original?"Update Price History":(s("#gst").prop("checked",!0),"Add Price History")},b=function(){d.value.title=D(),d.value.isOpen=!0},P=function(){i.value={reason:"",details:""},x.value={reason:"",details:""},d.value.isOpen=!1},t=function(q){console.log("DELETEING"),console.log(q);const A=v.level.value;var w=null;A=="park"?(w=G.park_entry_rate(q.rate_id),console.log(w),s.ajax({beforeSend:function(m){m.setRequestHeader("Content-Type","application/json"),m.setRequestHeader("Accept","application/json")},method:"DELETE",url:w,xhrFields:{withCredentials:!0},headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).done(function(m){n.value.vmDataTable.ajax.reload()})):A!="campsite"?(w=v.historyDeleteURL,s.ajax({beforeSend:function(m){m.setRequestHeader("Content-Type","application/json"),m.setRequestHeader("Accept","application/json")},method:"POST",url:w,xhrFields:{withCredentials:!0},data:JSON.stringify(q),headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).done(function(m){n.value.vmDataTable.ajax.reload()})):(w=G.campsiterate_detail(q),s.ajax({beforeSend:function(m){m.setRequestHeader("Content-Type","application/json"),m.setRequestHeader("Accept","application/json")},method:"DELETE",url:w,xhrFields:{withCredentials:!0},headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).done(function(m){n.value.vmDataTable.ajax.reload()}))},M=function(){return v.level=="campground"?G.addPrice(v.object_id):v.level=="campsite"?G.campsite_rate:G.addCampsiteClassPrice(v.object_id)},Y=function(){return v.level=="campground"?G.editPrice(v.object_id):v.level=="campsite"?G.campsiterate_detail(i.value.id):G.editCampsiteClassPrice(v.object_id)},y=function(q){v.level=="campsite"&&(i.value.campsite=v.object_id),u(M(),"POST",JSON.stringify(i))},k=function(q){v.level=="campsite"?(i.value.campsite=v.object_id,u(Y(),"PUT",JSON.stringify(i))):u(Y(),"POST",JSON.stringify(i))},U=function(q){u(G.park_add_price(),"POST",JSON.stringify(q))},$=function(q){u(G.park_entry_rate(x.value.id),"PUT",JSON.stringify(q))},u=function(q,A,w){console.log(w),s.ajax({beforeSend:function(m){m.setRequestHeader("Content-Type","application/json"),m.setRequestHeader("Accept","application/json")},url:q,method:A,xhrFields:{withCredentials:!0},data:w,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(m,E,B){P(),n.value.vmDataTable.ajax.reload()},error:function(m){var E=re.apiError(m);d.value.errorString=E,d.value.errors=!0}})},f=function(){n.value.vmDataTable.on("click",".editPrice",function(q){q.preventDefault();var A=s(this).data("rate");console.log("RATE editPrice"),console.log(A),console.log(G.campsiterate_detail(A)),console.log(v.level);var w=s(this).data("bookingpolicyid");if(v.level=="park")fetch(G.park_entry_rate(A)).then(I=>{x.value=I.body,d.value.selected_rate=A,i.value.period_start=ce(i.value.period_start).format("YYYY-MM-DD"),i.value.period_end!=null&&i.value.period_end,i.value.gst=i.value.gst,i.value.bookingpolicyid=w},I=>{console.log(I)}),b();else if(v.level!="campsite"){var m=s(this).data("date_start"),E=s(this).data("date_end"),B=s(this).data("reason"),te=s(this).data("details"),w=s(this).data("bookingpolicyid");d.value.selected_rate=A,i.value.period_start=ce(m).format("D/MM/YYYY"),i.value.booking_policy=w,i.value.original={date_start:m,rate_id:A,reason:B,details:te,booking_policy:w},E!=null&&i.value.date_end,b()}else s.get(G.campsiterate_detail(A),function(I){i.value.period_start=I.date_start,i.value.id=I.id,i.value.booking_policy=w,i.value.gst=!1,console.log("VM PERT"),console.log(i.value),d.value.selected_rate=I.rate,b()})}),n.value.vmDataTable.on("click",".deletePrice",function(q){q.preventDefault();let A=this;if(v.level!="campsite"){var w={date_start:s(A).data("date_start"),rate_id:s(A).data("rate")};s(A).data("date_end")!=null&&(w.date_end=s(A).data("date_end")),O.value=w}else console.log(s(A).data("rate")),O.value=s(A).data("rate");console.log("DELETE PRICE END"),Ie.emit("showAlert","deleteHistory")})};return c({history_dt:n,showHistory:b,closeHistory:P,deleteHistoryRecord:t,getTitle:D,addHistory:y,updateHistory:k,addParkHistory:U,updateParkHistory:$,sendData:u,getAddURL:M,getEditURL:Y,addTableListeners:f}),$e(function(){f()}),(q,A)=>(C(),S("div",ll,[o.addParkPrice?(C(),Ye(al,{key:0,ref_key:"historyModal",ref:d,onAddParkPriceHistory:U,onUpdateParkPriceHistory:$,priceHistory:x.value,onCancel:A[0]||(A[0]=w=>P())},null,8,["priceHistory"])):(C(),Ye(Ta,{key:1,ref_key:"historyModal",ref:d,onAddPriceHistory:y,onUpdatePriceHistory:k,priceHistory:i.value},null,8,["priceHistory"])),e("div",nl,[A[2]||(A[2]=e("div",{class:"col-sm-8"},[e("h1",null,"Price History")],-1)),e("div",rl,[g(e("button",{onClick:A[1]||(A[1]=w=>b()),class:"btn btn-primary table_btn"},"Add Price History",512),[[ae,o.showAddBtn]])]),ee(Xe,{ref_key:"history_dt",ref:n,dtHeaders:o.dt_headers,dtOptions:o.dt_options,id:"ph_table"},null,8,["dtHeaders","dtOptions"])]),ee(rt,{id:"deleteHistory",options:p.value},null,8,["options"])]))}},il={id:"spinnerLoader"},dl={class:"container"},ul={class:"row"},cl={class:"col-lg-12",style:{"margin-top":"20px"}},He={__name:"loader",props:{isLoading:{type:Boolean,default:!1}},setup(o){return(c,v)=>g((C(),S("div",il,[e("div",dl,[e("div",ul,[v[0]||(v[0]=e("div",{class:"col-lg-12"},[e("i",{class:"fa fa-4x fa-spinner fa-spin"})],-1)),e("div",cl,[Ke(c.$slots,"default")])])])],512)),[[ae,o.isLoading]])}},pl={class:"row",imagePicker:""},vl={class:"form-group"},ml={class:"col-sm-12"},fl={class:"btn btn-primary btn-file btn-sm"},_l={class:"form-group"},gl={class:"col-sm-12"},hl={class:"col-sm-12"},yl={class:"upload"},bl={class:"panel panel-default"},kl={class:"overlay"},$l=["onClick"],Cl=["data-index"],wl=["src"],xl={class:"panel-footer"},Dl={class:"row"},Tl={class:"col-lg-12"},Sl={class:"form-group"},Ml=["onUpdate:modelValue"],El={__name:"imagePicker",props:{showCaption:{type:Boolean,default:!1},images:{type:Array,required:!0}},setup(o){const c=o,v=a(null),n=a(0),d=a(!1),i=a(""),x=a(null),O=a({dots:!0,infinite:!0,speed:300,adaptiveHeight:!0,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:!1,dots:!0}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]});$e(function(){P(),Ie.on("campgroundFetched",function(){c.images&&(s(".upload").slick("unslick"),i.value="Loading Images...",d.value=!0,t())}),n.value=c.images.length});const p=function(y){i.value="Loading Images...",d.value=!0,c.images.splice(y,1),s(".upload").slick("unslick"),t()},D=function(){var y=s("div[data-index]");s(y).on("mouseover",function(k){s(this).siblings(".overlay").addClass("show").on("mouseleave",function(U){s(this).removeClass("show")})})},b=function(){i.value="Removing Images...",d.value=!0,c.images.splice(0,c.images.length),s(".upload").slick("unslick"),t()},P=function(){x.value=s(".upload").not(".slick-initialized").slick(O.value)},t=function(){setTimeout(function(){P()},100),setTimeout(function(){d.value=!1,s(".upload").slick("resize")},400)},M=function(){s(".upload").slick("unslick"),d.value=!0;var y=v.value;if(y.files&&y.files[0]){y.files.length>1?i.value="Adding Images...":i.value="Adding Image...";for(var k=0;k<y.files.length;k++){var U=new FileReader;U.onload=function($){n.value++,c.images.push({image:$.target.result,caption:""})},U.readAsDataURL(y.files[k])}s(y).val(""),t()}},Y=Q(function(){return c.images&&c.images.length>1});return kt(function(){D()}),(y,k)=>(C(),S("div",pl,[e("div",vl,[e("div",ml,[e("span",fl,[k[1]||(k[1]=e("i",{class:"fa fa-fw fa-camera"},null,-1)),e("input",{multiple:"",ref_key:"imagePicker",ref:v,type:"file",name:"img",onChange:k[0]||(k[0]=U=>M())},null,544),k[2]||(k[2]=W(" Add Image "))]),g(e("button",{class:"btn btn-sm btn-danger",onClick:_e(b,["prevent"])},"Clear All",512),[[ae,Y.value]])])]),e("div",_l,[ee(He,{isLoading:d.value},{default:ue(()=>[W(H(i.value),1)]),_:1},8,["isLoading"]),e("div",gl,[g(e("div",hl,[e("div",yl,[(C(!0),S(ie,null,de(o.images,(U,$)=>(C(),S("div",bl,[e("div",kl,[e("button",{type:"button",class:"btn btn-danger btn-block",onClick:_e(u=>p($),["prevent"])},k[3]||(k[3]=[W(" Remove "),e("i",{class:"fa fa-w fa-trash-o"},null,-1)]),8,$l)]),e("div",{class:"panel-body","data-index":$},[e("img",{src:U.image,class:"img",alt:"Responsive image"},null,8,wl),g(e("div",xl,[e("div",Dl,[e("div",Tl,[e("div",Sl,[g(e("input",{type:"text",class:"form-control",placeholder:"Caption","onUpdate:modelValue":u=>U.caption=u},null,8,Ml),[[X,U.caption]])])])])],512),[[ae,o.showCaption]])],8,Cl)]))),256))])],512),[[ae,!d.value]])])])]))}},Pl={id:"cg_attr"},Rl={id:"attForm"},Ol={class:"col-sm-12"},Yl={class:"row"},Ul={class:"col-lg-12"},Al={class:"panel panel-primary"},Vl={id:"main-panel",class:"panel-body"},ql={class:"row"},Fl={class:"col-md-10 col-lg-12"},jl={class:"row"},Il={class:"col-md-6 col-lg-6"},Hl={class:"form-group"},Ll={class:"col-md-4 col-lg-3"},Nl={class:"form-group"},Bl={class:"row"},Gl={class:"col-md-10 col-lg-6"},Jl={class:"form-group"},zl={name:"park",class:"form-control"},Xl=["value"],Wl={class:"row"},Kl={class:"col-md-6 col-lg-3"},Ql={class:"form-group"},Zl={class:"col-md-4 col-lg-3"},en={class:"form-group"},tn={class:"col-md-4 col-lg-3"},sn=["value"],on={class:"row"},an={class:"col-lg-12",style:{"padding-top":"20px"}},ln={class:"row"},nn={class:"col-lg-12"},rn={class:"panel panel-primary"},dn={class:"panel-body"},un={class:"row"},cn={class:"form-group"},pn={class:"col-md-8"},vn=["value"],mn={class:"row"},fn={class:"col-md-3"},_n={class:"col-md-5"},gn={class:"row"},hn={class:"col-sm-6 col-lg-4 features"},yn={class:"panel panel-primary"},bn={class:"list-group"},kn=["onClick"],$n={class:"col-sm-6 col-lg-4 features"},Cn={class:"panel panel-primary"},wn={class:"list-group"},xn=["onClick"],Dn={class:"row"},Tn={class:"col-md-12"},Sn={class:"form-group"},Mn={class:"row"},En={class:"col-sm-12"},Pn={class:"form-group pull-right"},St={__name:"campground-attr",props:{createCampground:{type:Boolean,default:!0},priceSet:{type:Array,default:()=>[{val:0,name:"Campground level"},{val:1,name:"Campsite Type level"},{val:2,name:"Campsite level"}]},campground:{type:Object,default:()=>({address:{},images:[]})}},setup(o){const c=Ne(),v=Ge(),n=o,{campground:d,createCampground:i,priceSet:x}=at(n);let O=null;const p=a(!1),D=a([]),b=a([]),P=a(null),t=a(!1),M=a(""),Y=a(!1),y=a(!1),k=a([]),U=Q(function(){return t.value}),$=Q(function(){return b.value.length>0}),u=Q(function(){return D.value.length<1}),f=Q(function(){let Z=d.value.contact;if(Z!=null){let F=k.value.find(se=>se.id===Z);return F?F.phone_number:""}else return""}),q=Q(function(){let Z=d.value.contact;if(Z!=null){let F=k.value.find(se=>se.id===Z);return F?F.email:""}else return""}),A=Q(()=>v.getters.parks);ge(()=>d.value,function(){oe()},{deep:!0});const w=function(){c.go(window.history.back())},m=function(){var Z=te(s("#editor"));return P.value.valid()&&Z},E=function(){m()&&I(G.campgrounds,"POST")},B=function(){m()&&I(G.campground(d.value.id),"PUT")},te=function(Z){return Z.parents(".form-group").hasClass("has-error")&&(Z.tooltip("destroy"),Z.attr("data-original-title","").parents(".form-group").removeClass("has-error")),O.getText().trim().length==0?(Z.tooltip({trigger:"focus"}).attr("data-original-title","Description is required").parents(".form-group").addClass("has-error"),!1):!0},I=function(Z,F){y.value=!0;var se=new Array,ve=b.value;i.value&&(d.value.features=b.value),d.value.features.forEach(function(be){se.push(be.id)}),d.value.features=se,d.value.contact=="undefined"&&(d.value.contact=""),s.ajax({beforeSend:function(be){be.setRequestHeader("Content-Type","application/json"),be.setRequestHeader("Accept","application/json")},url:Z,method:F,xhrFields:{withCredentials:!0},data:JSON.stringify(d.value),headers:{"X-CSRFToken":re.getCookie("csrftoken")},contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(be,Pe,Ve){F=="POST"?(c.push({name:"cg_detail",params:{id:be.id}}),y.value=!1):F=="PUT"&&(d.value.features=ve,Y.value=!0,y.value=!1),v.dispatch("updateAlert",{visible:!1,type:"danger",message:""})},error:function(be){y.value=!1,v.dispatch("updateAlert",{visible:!0,type:"danger",message:re.apiError(be)})}})},h=function(){A.value.length==0&&v.dispatch("fetchParks")},T=function(){var Z=G.features;s.ajax({url:Z,dataType:"json",success:function(F,se,ve){D.value=F}})},R=function(Z,F){b.value.push(Z),D.value.splice(F,1),b.value.sort(function(se,ve){return parseInt(se.id)-parseInt(ve.id)})},_=function(Z,F){D.value.push(Z),b.value.splice(F,1),D.value.sort(function(se,ve){return parseInt(se.id)-parseInt(ve.id)})},V=function(){P.value.validate({ignore:"div.ql-editor",rules:{name:"required",park:"required",campground_type:"required",site_type:"required",street:"required",email:{required:!0,email:!0},telephone:"required",postcode:"required",price_level:"required"},messages:{name:"Enter a campground name",park:"Select a park from the options",campground_type:"Select a campground type from the options",site_type:"Select a site type from the options",price_level:"Select a price level from the options"},showErrors:function(Z,F){s.each(this.validElements(),function(be,Pe){var Ve=s(Pe);Ve.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var se=0;se<F.length;se++){var ve=F[se];s(ve.element).tooltip({trigger:"focus"}).attr("data-original-title",ve.message).parents(".form-group").addClass("has-error")}}})},oe=function(){d.value.features&&(i.value||(b.value=d.value.features),s.each(d.value.features,function(Z,F){s.each(D.value,function(se,ve){ve!=null&&F.id==ve.id&&D.value.splice(se,1)})}))};return $e(function(){h(),T(),O=new $t("#editor",{modules:{toolbar:!0},theme:"snow"}),O.clipboard.dangerouslyPasteHTML(0,d.value.description,"api"),O.on("text-change",function(Z,F,se){var ve=s("#editor >.ql-editor").html();d.value.description=ve,te(s("#editor"))}),P.value=s("#attForm"),V(),fetch(G.contacts).then(Z=>{k.value=Z.body}).catch(Z=>{console.log(Z)})}),kt(function(){var Z=!1;d.value.description!=null&&p.value==!1&&(O.clipboard.dangerouslyPasteHTML(0,d.value.description,"api"),Z=!0),Z&&(p.value=!0)}),(Z,F)=>(C(),S("div",Pl,[g(e("div",null,[e("form",Rl,[e("div",Ol,[ee(Ee,{show:Y.value,"onUpdate:show":F[0]||(F[0]=se=>Y.value=se),type:"success",duration:7e3},{default:ue(()=>F[13]||(F[13]=[e("p",null,"Campground successfully updated",-1)])),_:1},8,["show"]),ee(Ee,{show:U.value,"onUpdate:show":F[1]||(F[1]=se=>U.value=se),type:"danger"},{default:ue(()=>[e("p",null,H(M.value),1)]),_:1},8,["show"]),e("div",Yl,[e("div",Ul,[e("div",Al,[F[34]||(F[34]=e("div",{class:"panel-heading"},[e("h5",{class:"panel-title"},"Info")],-1)),e("div",Vl,[e("div",ql,[e("div",Fl,[e("div",jl,[e("div",Il,[e("div",Hl,[F[14]||(F[14]=e("label",{class:"control-label"},"Campground Name",-1)),g(e("input",{autofocus:"true",type:"text",name:"name",id:"name",class:"form-control","onUpdate:modelValue":F[2]||(F[2]=se=>De(d).name=se),required:""},null,512),[[X,De(d).name]])])]),e("div",Ll,[e("div",Nl,[F[15]||(F[15]=e("label",{class:"control-label"},"Oracle Code",-1)),g(e("input",{type:"text",name:"oracle_code",id:"oracle_code",class:"form-control","onUpdate:modelValue":F[3]||(F[3]=se=>De(d).oracle_code=se),required:""},null,512),[[X,De(d).oracle_code]])])])]),e("div",Bl,[e("div",Gl,[e("div",Jl,[F[17]||(F[17]=e("label",{class:"control-label"},"Park",-1)),g(e("select",zl,F[16]||(F[16]=[e("option",null,"Loading...",-1)]),512),[[ae,!A.value.length>0]]),A.value.length>0?g((C(),S("select",{key:0,name:"park",class:"form-control form-select","onUpdate:modelValue":F[4]||(F[4]=se=>De(d).park=se)},[(C(!0),S(ie,null,de(A.value,se=>(C(),S("option",{value:se.id},H(se.name),9,Xl))),256))],512)),[[ke,De(d).park]]):fe("",!0)])])]),e("div",Wl,[e("div",Kl,[e("div",Ql,[F[19]||(F[19]=e("label",{class:"control-label"},"Type",-1)),g(e("select",{id:"campground_type",name:"campground_type",class:"form-control form-select","onUpdate:modelValue":F[5]||(F[5]=se=>De(d).campground_type=se)},F[18]||(F[18]=[e("option",{value:"0"},"Bookable Online",-1),e("option",{value:"1"},"Not Bookable Online",-1),e("option",{value:"2"},"Other accomodation",-1),e("option",{value:"3"},"Unpublished",-1)]),512),[[ke,De(d).campground_type]])])]),e("div",Zl,[e("div",en,[F[21]||(F[21]=e("label",{class:"control-label"},"Booking Configuration",-1)),g(e("select",{id:"site_type",name:"site_type",class:"form-control form-select","onUpdate:modelValue":F[6]||(F[6]=se=>De(d).site_type=se)},F[20]||(F[20]=[e("option",{value:"0"},"Bookable per site",-1),e("option",{value:"1"},"Bookable per site type",-1),e("option",{value:"2"},"Bookable per site type (hide site number) ",-1)]),512),[[ke,De(d).site_type]])])]),e("div",tn,[F[22]||(F[22]=e("label",{class:"control-label"},"Price set at: ",-1)),g(e("select",{id:"price_level",name:"price_level",class:"form-control form-select","onUpdate:modelValue":F[7]||(F[7]=se=>De(d).price_level=se)},[(C(!0),S(ie,null,de(De(x),se=>(C(),S("option",{value:se.val},H(se.name),9,sn))),256))],512),[[ke,De(d).price_level]])])])])]),e("div",on,[F[23]||(F[23]=e("h5",{class:"panel-title"},"Campground Images",-1)),e("div",an,[ee(El,{images:De(d).images},null,8,["images"])])]),F[32]||(F[32]=e("hr",null,null,-1)),e("div",ln,[e("div",nn,[e("div",rn,[F[28]||(F[28]=e("div",{class:"panel-heading"},[e("h5",{class:"panel-title"},"Contact")],-1)),e("div",dn,[e("div",un,[e("div",cn,[F[25]||(F[25]=e("label",{class:"col-md-4 control-label"},"Customer Contact",-1)),e("div",pn,[g(e("select",{class:"form-control form-select",name:"contact","onUpdate:modelValue":F[8]||(F[8]=se=>De(d).contact=se)},[F[24]||(F[24]=e("option",{value:"undefined"},"Select Contact",-1)),(C(!0),S(ie,null,de(k.value,se=>(C(),S("option",{value:se.id},H(se.name),9,vn))),256))],512),[[ke,De(d).contact]])])])]),e("div",mn,[e("div",fn,[F[26]||(F[26]=e("label",{class:"control-label"},"Phone Number",-1)),g(e("input",{type:"text",disabled:"",name:"contact_number",id:"contact_number",class:"form-control","onUpdate:modelValue":F[9]||(F[9]=se=>f.value=se),required:""},null,512),[[X,f.value]])]),e("div",_n,[F[27]||(F[27]=e("label",{class:"control-label"},"Email",-1)),g(e("input",{type:"text",disabled:"",name:"contact_email",id:"contact_email",class:"form-control","onUpdate:modelValue":F[10]||(F[10]=se=>q.value=se),required:""},null,512),[[X,q.value]])])])])])])]),e("div",gn,[e("div",hn,[e("div",yn,[F[29]||(F[29]=e("div",{class:"panel-heading"},[e("h5",{class:"panel-title"},"Features")],-1)),e("div",{class:Le(["panel-body",{"empty-features":u.value}])},[g(e("p",null," All features selected ",512),[[ae,u.value]]),e("ul",bn,[(C(!0),S(ie,null,de(D.value,(se,ve)=>(C(),S("a",{href:"",onClick:_e(be=>R(se,ve),["prevent"]),class:"list-group-item list-group-item-primary"},H(se.name),9,kn))),256))])],2)])]),e("div",$n,[e("div",Cn,[F[30]||(F[30]=e("div",{class:"panel-heading"},[e("h5",{class:"panel-title"},"Selected")],-1)),e("div",{class:Le(["panel-body",{"empty-features":!$.value}])},[g(e("p",null," No features selected ",512),[[ae,!$.value]]),e("ul",wn,[(C(!0),S(ie,null,de(b.value,(se,ve)=>(C(),S("a",{href:"",onClick:_e(be=>_(se,ve),["prevent"]),class:"list-group-item"},H(se.name),9,xn))),256))])],2)])])]),F[33]||(F[33]=Qe('<div class="row"><h4>Additional information</h4></div><div class="row"><div class="col-md-12"><div class="form-group"><label class="control-label">Description</label><div id="editor" class="form-control"></div></div></div></div>',2)),e("div",Dn,[e("div",Tn,[e("div",Sn,[F[31]||(F[31]=e("label",{class:"control-label"},"Additional confirmation information",-1)),g(e("textarea",{id:"additional_info",class:"form-control","onUpdate:modelValue":F[11]||(F[11]=se=>De(d).additional_info=se)},null,512),[[X,De(d).additional_info]])])])]),e("div",Mn,[e("div",En,[e("div",Pn,[De(i)?(C(),S("a",{key:0,href:"#",class:"btn btn-primary",onClick:_e(E,["prevent"])},"Create Campground")):(C(),S("a",{key:1,href:"#",class:"btn btn-primary",onClick:_e(B,["prevent"])},"Update Campground")),e("a",{href:"#",class:"btn btn-default",onClick:_e(w,["prevent"])},"Cancel")])])])])])])])])])],512),[[ae,!y.value]]),ee(He,{isLoading:y.value,"onUpdate:isLoading":F[12]||(F[12]=se=>y.value=se)},{default:ue(()=>F[35]||(F[35]=[W("Loading...")])),_:1},8,["isLoading"])]))}},Rn={class:"modal-body"},On={id:"closeCGForm",class:"form-horizontal"},Yn={class:"row"},Un={class:"form-group"},An={class:"col-md-4"},Vn=["value"],qn={class:"row"},Fn={class:"form-group"},jn={class:"col-md-4"},In={class:"input-group date",id:"close_bcs_range_start"},Hn={class:"row"},Ln={class:"form-group"},Nn={class:"col-md-4"},Bn={class:"input-group date",id:"close_bcs_range_end"},Gn={class:"row"},Jn={class:"form-group"},zn={class:"col-md-5"},Xn={__name:"bulkClose",props:["campsites"],emits:["close","bulkCloseCampsites"],setup(o,{emit:c}){a(""),a("");const v=a(""),n=a({status:1,range_start:"",range_end:"",closure_reason:"",details:"",campsites:[]}),d=a(null),i=a(null),x=a(!1),O=a(!1),p=a(""),D=a(null),b=c,P=Q(function(){return x.value}),t=Q(function(){return n.value.closure_reason==="1"}),M=Q(function(){return O.value});ge(()=>v,$=>{n.value.closure_reason=$});const Y=function(){D.value.valid()&&b("bulkCloseCampsites")},y=function(){b("close"),O.value=!1},k=function(){setTimeout(function(){s("#bcs-campsites").select2({theme:"bootstrap",allowClear:!0,placeholder:"Select campsites",tags:!1}).on("select2:select",function($){n.value.campsites=s($.currentTarget).val()}).on("select2:unselect",function($){n.value.campsites=s($.currentTarget).val()})},100)},U=function(){D.value.validate({rules:{closure_start:"required",closure_reason:"required",closure_details:{required:{depends:function($){return t.value}}}},messages:{closure_start:"Enter a start date",closure_reason:"Select a closure reason from the options",closure_details:"Details required if Other reason is selected"},showErrors:function($,u){s.each(this.validElements(),function(A,w){var m=s(w);m.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var f=0;f<u.length;f++){var q=u[f];s(q.element).tooltip({trigger:"focus"}).attr("data-original-title",q.message).parents(".form-group").addClass("has-error")}}})};return $e(function(){const $=s("#close_bcs_range_start"),u=s("#close_bcs_range_end");d.value=s("#close_bcs_range_start"),i.value=s("#close_bcs_range_end"),d.value=xe($,{restrictions:{minDate:new Date}}),i.value=xe(u,{useCurrent:!1}),$.on("change.td",function(f){const q=d.value.dates.lastPicked;n.value.range_start=q?ne.formatDate(q,"dd/MM/yyyy"):"",q&&i.value.updateOptions({restrictions:{minDate:q}})}),u.on("change.td",function(f){const q=i.value.dates.lastPicked;n.value.range_end=q?ne.formatDate(q,"dd/MM/yyyy"):""}),D.value=s("#closeCGForm"),U(),k()}),($,u)=>(C(),Ye(Ae,{title:"(Temporarily) bulk close campsites",large:!0,onOk:u[6]||(u[6]=f=>Y()),onCancel:u[7]||(u[7]=f=>y()),isModalOpen:M.value},{default:ue(()=>[e("div",Rn,[e("form",On,[e("div",Yn,[ee(Ee,{show:P.value,"onUpdate:show":u[0]||(u[0]=f=>P.value=f),type:"danger"},{default:ue(()=>[W(H(p.value),1)]),_:1},8,["show"]),e("div",Un,[u[8]||(u[8]=e("div",{class:"col-md-2"},[e("label",{for:"bcs-campsites"},"Campsites affected:")],-1)),e("div",An,[g(e("select",{class:"form-control",id:"bcs-campsites",name:"campsites",placeholder:"",multiple:"","onUpdate:modelValue":u[1]||(u[1]=f=>n.value.campsites=f)},[(C(!0),S(ie,null,de(o.campsites,f=>(C(),S("option",{value:f.id},H(f.name)+" - "+H(f.type),9,Vn))),256))],512),[[ke,n.value.campsites]])])])]),e("div",qn,[e("div",Fn,[u[10]||(u[10]=e("div",{class:"col-md-2"},[e("label",{for:"close_bcs_range_start"},"Closure start: ")],-1)),e("div",jn,[e("div",In,[g(e("input",{name:"closure_start","onUpdate:modelValue":u[2]||(u[2]=f=>n.value.range_start=f),type:"text",class:"form-control"},null,512),[[X,n.value.range_start]]),u[9]||(u[9]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),e("div",Hn,[e("div",Ln,[u[12]||(u[12]=e("div",{class:"col-md-2"},[e("label",{for:"close_bcs_range_end"},"Reopen on: ")],-1)),e("div",Nn,[e("div",Bn,[g(e("input",{name:"closure_end","onUpdate:modelValue":u[3]||(u[3]=f=>n.value.range_end=f),type:"text",class:"form-control"},null,512),[[X,n.value.range_end]]),u[11]||(u[11]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"close",ref_key:"reason",ref:v,modelValue:v.value,"onUpdate:modelValue":u[4]||(u[4]=f=>v.value=f)},null,8,["modelValue"]),g(e("div",Gn,[e("div",Jn,[u[13]||(u[13]=e("div",{class:"col-md-2"},[e("label",{for:"close_bcs_details"},"Details: ")],-1)),e("div",zn,[g(e("textarea",{name:"closure_details","onUpdate:modelValue":u[5]||(u[5]=f=>n.value.details=f),class:"form-control",id:"close_bcs_details"},null,512),[[X,n.value.details]])])])],512),[[ae,t.value]])])])]),_:1},8,["isModalOpen"]))}},Wn={class:"modal-body"},Kn={id:"closeCGForm",class:"form-horizontal"},Qn={class:"row"},Zn={class:"form-group"},er={class:"col-md-4"},tr={class:"input-group date",id:"close_cg_range_start"},sr={class:"row"},or={class:"form-group"},ar={class:"col-md-4"},lr={class:"input-group date",id:"close_cg_range_end"},nr={class:"row"},rr={class:"form-group"},ir={class:"col-md-5"},Mt={__name:"closeCampsite",emits:["closeCampsite"],setup(o,{expose:c,emit:v}){const n=a(""),d=a({campsite:"",status:1,range_start:"",range_end:"",closure_reason:"",details:""}),i=a(""),x=a(""),O=a(!1),p=a(""),D=a(""),b=a(!1),P=v,t=Q(function(){return O.value}),M=Q(function(){return b.value}),Y=Q(function(){return d.value.closure_reason==="1"});ge(()=>n,$=>{d.value.closure_reason=$?$.value:void 0},{deep:!0});const y=function(){b.value=!1,d.value={status:1,range_start:"",range_end:"",closure_reason:"",details:""},n.value=""},k=function(){D.value.valid()&&P("closeCampsite")},U=function(){D.value.validate({rules:{closure_start:"required",closure_reason:"required",closure_details:{required:{depends:function($){return Y.value}}}},messages:{closure_start:"Enter a start date",closure_reason:"Select a closure reason from the options",closure_details:"Details required if Other reason is selected"},showErrors:function($,u){s.each(this.validElements(),function(A,w){var m=s(w);m.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var f=0;f<u.length;f++){var q=u[f];s(q.element).tooltip({trigger:"focus"}).attr("data-original-title",q.message).parents(".form-group").addClass("has-error")}}})};return c({formdata:d,isOpen:b,errors:O,errorString:p,close:y}),$e(()=>{const $=s("#close_cg_range_start"),u=s("#close_cg_range_end");i.value=xe($,{restrictions:{minDate:new Date}}),x.value=xe(u,{useCurrent:!1}),$.on("change.td",function(f){const q=i.value.dates.lastPicked;d.value.range_start=q?ne.formatDate(q,"dd/MM/yyyy"):"",q&&x.value.updateOptions({restrictions:{minDate:q}})}),u.on("change.td",function(f){const q=x.value.dates.lastPicked;d.value.range_end=q?ne.formatDate(q,"dd/MM/yyyy"):""}),D.value=s("#closeCGForm"),U()}),($,u)=>(C(),Ye(Ae,{title:"(Temporarily) close campsite",large:!0,onOk:u[5]||(u[5]=f=>k()),onCancel:u[6]||(u[6]=f=>y()),isModalOpen:M.value},{default:ue(()=>[e("div",Wn,[e("form",Kn,[e("div",Qn,[ee(Ee,{show:t.value,"onUpdate:show":u[0]||(u[0]=f=>t.value=f),type:"danger"},{default:ue(()=>[W(H(p.value),1)]),_:1},8,["show"]),e("div",Zn,[u[8]||(u[8]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_start"},"Closure start: ")],-1)),e("div",er,[e("div",tr,[g(e("input",{name:"closure_start","onUpdate:modelValue":u[1]||(u[1]=f=>d.value.range_start=f),type:"text",class:"form-control"},null,512),[[X,d.value.range_start]]),u[7]||(u[7]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),e("div",sr,[e("div",or,[u[10]||(u[10]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_start"},"Reopen on: ")],-1)),e("div",ar,[e("div",lr,[g(e("input",{name:"closure_end","onUpdate:modelValue":u[2]||(u[2]=f=>d.value.range_end=f),type:"text",class:"form-control"},null,512),[[X,d.value.range_end]]),u[9]||(u[9]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"close",modelValue:n.value,"onUpdate:modelValue":u[3]||(u[3]=f=>n.value=f)},null,8,["modelValue"]),g(e("div",nr,[e("div",rr,[u[11]||(u[11]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_details"},"Details: ")],-1)),e("div",ir,[g(e("textarea",{name:"closure_details","onUpdate:modelValue":u[4]||(u[4]=f=>d.value.details=f),class:"form-control",id:"close_cg_details"},null,512),[[X,d.value.details]])])])],512),[[ae,Y.value]])])])]),_:1},8,["isModalOpen"]))}},dr={class:"modal-body"},ur={id:"openCGForm",class:"form-horizontal"},cr={class:"row"},pr={class:"form-group"},vr={class:"col-md-4"},mr={class:"row"},fr={class:"form-group"},_r={class:"col-md-4"},gr={class:"input-group date",id:"open_cg_range_end"},hr={class:"row"},yr={class:"form-group"},br={class:"col-md-5"},kr={__name:"openCampsite",emits:["openCampsite"],setup(o,{emit:c}){a("");const v=a(""),n=a({range_end:"",closure_reason:"",details:""}),d=a(""),i=a(!1);a("");const x=a(null),O=a(!1),p=c,D=Q(function(){return i.value}),b=Q(function(){return O.value}),P=Q(function(){return n.value.closure_reason==="1"}),t=function(){x.value.valid()&&p("openCampsite")},M=function(){x.value.validate({rules:{open_start:"required",open_reason:"required",open_details:{required:{depends:function(Y){return P.value}}}},messages:{open_start:"Enter a reopening date",open_reason:"Select an open reason from the options",open_details:"Details required if Other reason is selected"},showErrors:function(Y,y){s.each(this.validElements(),function($,u){var f=s(u);f.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var k=0;k<y.length;k++){var U=y[k];s(U.element).tooltip({trigger:"focus"}).attr("data-original-title",U.message).parents(".form-group").addClass("has-error")}}})};return $e(function(){const Y=s("#open_cg_range_end");d.value=xe(Y,{useCurrent:!1,restrictions:{minDate:ne.addDays(new Date,1)}}),Y.on("change.td",function(y){const k=d.value.dates.lastPicked;n.value.range_end=k?ne.formatDate(k,"dd/MM/yyyy"):""}),x.value=s("#openCGForm"),M()}),(Y,y)=>(C(),Ye(Ae,{title:"Open campsite",large:!0,onOk:y[5]||(y[5]=k=>t()),isModalOpen:b.value},{default:ue(()=>[e("div",dr,[e("form",ur,[e("div",cr,[ee(Ee,{show:D.value,"onUpdate:show":y[0]||(y[0]=k=>D.value=k),type:"danger"},null,8,["show"]),e("div",pr,[y[6]||(y[6]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_current_closure"},"Current Closure: ")],-1)),e("div",vr,[g(e("input",{id:"open_cg_current_closure","onUpdate:modelValue":y[1]||(y[1]=k=>v.value=k),disabled:"",type:"text",class:"form-control"},null,512),[[X,v.value]])])])]),e("div",mr,[e("div",fr,[y[8]||(y[8]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_range_end"},"Reopen on: ")],-1)),e("div",_r,[e("div",gr,[g(e("input",{name:"open_start","onUpdate:modelValue":y[2]||(y[2]=k=>n.value.range_end=k),type:"text",class:"form-control"},null,512),[[X,n.value.range_end]]),y[7]||(y[7]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"close",modelValue:n.value.closure_reason,"onUpdate:modelValue":y[3]||(y[3]=k=>n.value.closure_reason=k)},null,8,["modelValue"]),g(e("div",hr,[e("div",yr,[y[9]||(y[9]=e("div",{class:"col-md-2"},[e("label",{for:"open_cg_details"},"Details: ")],-1)),e("div",br,[g(e("textarea",{name:"open_details","onUpdate:modelValue":y[4]||(y[4]=k=>n.value.details=k),class:"form-control",id:"open_cg_details"},null,512),[[X,n.value.details]])])])],512),[[ae,P.value]])])])]),_:1},8,["isModalOpen"]))}},$r={class:"modal-body"},Cr={id:"addMaxStayForm",class:"form-horizontal"},wr={class:"row"},xr={class:"form-group"},Dr={class:"col-md-4"},Tr={class:"row"},Sr={class:"form-group"},Mr={class:"col-md-4"},Er={class:"input-group date",id:"stay_start_picker"},Pr={class:"row"},Rr={class:"form-group"},Or={class:"col-md-4"},Yr={class:"input-group date",id:"stay_end_picker"},Ur={class:"row"},Ar={class:"form-group"},Vr={class:"col-md-5"},qr={__name:"addMaximumStayPeriod",props:{campground:{type:Object,required:!0},stay:{type:Object}},emits:["addCgStayHistory","updateStayHistory"],setup(o,{expose:c,emit:v}){const n=o,d=v,i=a(null),x=a(null),O=a(n.stay),p=a(""),D=a(""),b=a(!1),P=a(""),t=a(""),M=a(!1),Y=a(!0),y=a(""),k=Q(function(){return b.value}),U=Q(function(){return M.value}),$=Q(function(){return Y.value?"Add New Maximum Stay Period":"Edit Maximum Stay Period"}),u=Q(function(){return O.value.reason==1}),f=function(){O.value.max_days="",O.value.range_start="",O.value.range_end="",O.value.reason="",O.value.details="",M.value=!1,b.value=!1,P.value="",y.value=""},q=function(){s(t.value).valid()&&(O.value.id?d("updateStayHistory"):d("addCgStayHistory"))},A=function(){t.value.validate({rules:{stay_start:"required",stay_reason:"required",stay_details:{required:{depends:function(w){return O.value.reason==1}}}},messages:{stay_start:"Enter a start date",stay_reason:"Select an open reason from the options",open_details:"Details required if Other reason is selected"},showErrors:function(w,m){s.each(this.validElements(),function(te,I){var h=s(I);h.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var E=0;E<m.length;E++){var B=m[E];s(B.element).tooltip({trigger:"focus"}).attr("data-original-title",B.message).parents(".form-group").addClass("has-error")}}})};return $e(function(){Y.value||(x.value.title="Edit Maximum Stay Period");const w=s("#stay_start_picker"),m=s("#stay_end_picker");p.value=xe(w),D.value=xe(m,{useCurrent:!1}),w.on("change.td",function(E){const B=p.value.dates.lastPicked;O.value.range_start=B?ne.formatDate(B,"dd/MM/yyyy"):"",D.value.updateOptions({restrictions:{minDate:B}}),D.value.toggle()}),m.on("change.td",function(E){const B=D.value.dates.lastPicked;O.value.range_end=B?ne.formatDate(B,"dd/MM/yyyy"):""}),t.value=s("#addMaxStayForm"),A()}),c({isOpen:M,create:Y,close:f}),(w,m)=>(C(),Ye(Ae,{ref_key:"modal",ref:x,title:$.value,large:!0,onOk:m[6]||(m[6]=E=>q()),okText:"Add",onCancel:m[7]||(m[7]=E=>f()),isModalOpen:U.value},{default:ue(()=>[e("div",$r,[e("form",Cr,[e("div",wr,[ee(Ee,{show:k.value,"onUpdate:show":m[0]||(m[0]=E=>k.value=E),type:"danger"},{default:ue(()=>[W(H(P.value),1)]),_:1},8,["show"]),e("div",xr,[m[8]||(m[8]=e("div",{class:"col-md-2"},[e("label",{for:"stay_maximum"},"Maximum Stay: ")],-1)),e("div",Dr,[g(e("input",{placeholder:"Default = 28",id:"stay_maximum","onUpdate:modelValue":m[1]||(m[1]=E=>O.value.max_days=E),type:"text",class:"form-control"},null,512),[[X,O.value.max_days]])])])]),e("div",Tr,[e("div",Sr,[m[10]||(m[10]=e("div",{class:"col-md-2"},[e("label",{for:"stay_start_picker"},"Period Start: ")],-1)),e("div",Mr,[e("div",Er,[g(e("input",{name:"stay_start","onUpdate:modelValue":m[2]||(m[2]=E=>O.value.range_start=E),type:"text",class:"form-control"},null,512),[[X,O.value.range_start]]),m[9]||(m[9]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),e("div",Pr,[e("div",Rr,[m[12]||(m[12]=e("div",{class:"col-md-2"},[e("label",{for:"stay_end_picker"},"Period End: ")],-1)),e("div",Or,[e("div",Yr,[g(e("input",{name:"stay_end","onUpdate:modelValue":m[3]||(m[3]=E=>O.value.range_end=E),type:"text",class:"form-control"},null,512),[[X,O.value.range_end]]),m[11]||(m[11]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])])]),ee(qe,{type:"stay",modelValue:O.value.reason,"onUpdate:modelValue":m[4]||(m[4]=E=>O.value.reason=E),ref_key:"reason",ref:i},null,8,["modelValue"]),g(e("div",Ur,[e("div",Ar,[m[13]||(m[13]=e("div",{class:"col-md-2"},[e("label",{for:"stay_details"},"Details: ")],-1)),e("div",Vr,[g(e("textarea",{name:"stay_details","onUpdate:modelValue":m[5]||(m[5]=E=>O.value.details=E),class:"form-control",id:"stay_details"},null,512),[[X,O.value.details]])])])],512),[[ae,u.value]])])])]),_:1},8,["title","isModalOpen"]))}},Fr={class:"row"},jr={class:"well"},Ir={class:"col-sm-4"},Hr={__name:"stayHistory",props:{datatableURL:{type:String,required:!0},object_id:{type:Number,required:!0}},setup(o){const c=o,v=a(null),n=a(null),d=a({}),i=a({reason:""}),x=a(null),O=a({icon:"<i class='fa fa-exclamation-triangle fa-2x text-danger' aria-hidden='true'></i>",message:"Are you sure you want to Delete this stay Period",buttons:[{text:"Delete",event:"delete",bsColor:"btn-danger",handler:function(){Y(x.value),x.value=null},autoclose:!0}],id:"deleteStay"}),p=a({error:!1,timeout:5e3,errorString:""}),D=a(["ID","Period Start","Period End","Maximum Stay(Nights)","Reason","Comment","Action"]),b=a({responsive:!0,processing:!0,deferRender:!0,order:[],language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"},columnDefs:[{defaultContent:"-",targets:"_all"}],ajax:{url:G.campgroundStayHistory(c.object_id),dataSrc:""},columns:[{data:"id"},{data:"range_start"},{data:"range_end"},{data:"max_days"},{data:"reason"},{data:"details"},{mRender:function(u,f,q){var A=q.id;if(q.editable){var w=`<td ><a href='#' class='editStay' data-stay_period="__ID__" >Edit</a>`;return w+=`<br/><a href='#' class='deleteStay' data-stay_period="__ID__" >Delete</a></td>`,w.replace(/__ID__/g,A)}return""}}]}),P=function(u){u=typeof u<"u"?u:!0,n.value.isOpen=!0,n.value.create=u},t=function(){U(G.campground_stay_history,"POST")},M=function(){U(G.campground_stay_history_detail(i.value.id),"PUT")},Y=function(u){var f=G.campground_stay_history_detail(u);s.ajax({method:"DELETE",url:f,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).done(function(q){y()})},y=function(){v.value.vmDataTable.ajax.reload()},k=function(u){s.ajax({url:G.campground_stay_history_detail(u),method:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(f,q,A){i.value=f,P(!1)},error:function(f){p.value.error=!0,p.value.errorString="There was a problem trying to retrive this stay period",setTimeout(function(){p.value.error=!1},p.value.timeout)}})},U=function(u,f){var q=i.value;f=="POST"&&(q.campground=c.object_id),s.ajax({url:u,method:f,xhrFields:{withCredentials:!0},data:q,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(A,w,m){n.value.close(),y()},error:function(A){p.value.error=!0,p.value.errorString=re.apiError(A)}})},$=function(){v.value.vmDataTable.on("click",".editStay",function(u){u.preventDefault();var f=s(this).attr("data-stay_period");k(f)}),v.value.vmDataTable.on("click",".deleteStay",function(u){u.preventDefault();var f=s(this).attr("data-stay_period");x.value=f,Ie.emit("showAlert","deleteStay")})};return $e(function(){$()}),(u,f)=>(C(),S("div",Fr,[ee(qr,{stay:i.value,campground:d.value,ref_key:"addMaxStayModal",ref:n,onAddCgStayHistory:f[0]||(f[0]=q=>t()),onUpdateStayHistory:f[1]||(f[1]=q=>M())},null,8,["stay","campground"]),e("div",jr,[ee(Ee,{ref:"retrieveStayAlert",show:p.value.error,"onUpdate:show":f[2]||(f[2]=q=>p.value.error=q),type:"danger",duration:p.value.timeout},{default:ue(()=>[W(H(p.value.errorString),1)]),_:1},8,["show","duration"]),f[4]||(f[4]=e("div",{class:"col-sm-8"},[e("h1",null,"Maximum Stay History")],-1)),e("div",Ir,[e("button",{onClick:f[3]||(f[3]=q=>P()),class:"btn btn-primary table_btn"},"Add Max Stay Period")]),ee(Xe,{ref_key:"addMaxStayDT",ref:v,dtHeaders:D.value,dtOptions:b.value,id:"stay_history"},null,8,["dtHeaders","dtOptions"])]),ee(rt,{id:"deleteStay",options:O.value},null,8,["options"])]))}},Lr={class:"panel-group",id:"applications-accordion",role:"tablist","aria-multiselectable":"true"},Nr={class:"card p-3",id:"applications"},Br={id:"applications-collapse",class:"",role:"tabpanel","aria-labelledby":"applications-heading"},Gr={class:"panel-body"},Jr={class:"col-lg-12"},zr={class:"row"},Xr={class:"card p-3",id:"applications",style:{"margin-top":"50px"}},Wr={class:"",role:"tabpanel","aria-labelledby":"applications-heading",id:"campsites"},Kr={class:"panel-body"},Qr={class:"col-lg-12"},Zr={class:"row"},ei={class:"well"},ti={class:"col-sm-offset-8 col-sm-4"},si="Campground",oi={__name:"campground",setup(o){const c=Ne(),v=lt(),n=a(null),d=a(null),i=a(null),x=a(null),O=a(null),p=a(null),D=G.campgroundStayHistory(v.params.id),b=a({address:{},images:[]}),P=a([]);a(!1),a(!1);const t=a(!1),M=a(null),Y=a({responsive:!0,processing:!0,deferRender:!0,order:[],columnDefs:[{defaultContent:"-",targets:"_all"}],ajax:{url:G.campground_price_history(v.params.id),dataSrc:""},columns:[{data:"date_start",mRender:function(_,V,oe){return ce(_).format("DD/MM/YYYY")}},{data:"date_end",mRender:function(_,V,oe){return _?ce(_).format("DD/MM/YYYY"):""}},{data:"adult"},{data:"concession"},{data:"child"},{data:"details",mRender:function(_,V,oe){return _||""}},{data:"editable",mRender:function(_,V,oe){if(_){oe.id;var Z=`<td ><a href='#' class='editPrice' data-date_start="__START__"  data-date_end="__END__"  data-rate="__RATE__" data-reason="__REASON__" data-details="__DETAILS__"  data-bookingpolicyid="__BOOKINGPOLICYID__" >Edit</a><br/>`;return oe.deletable&&(Z+=`<a href='#' class='deletePrice' data-date_start="__START__"  data-date_end="__END__"  data-rate="__RATE__" data-reason="__REASON__" data-details="__DETAILS__">Delete</a></td>`),Z=Z.replace(/__START__/g,oe.date_start),Z=Z.replace(/__END__/g,oe.date_end),Z=Z.replace(/__RATE__/g,oe.rate_id),Z=Z.replace(/__REASON__/g,oe.reason),Z=Z.replace(/__DETAILS__/g,oe.details),Z=Z.replace(/__BOOKINGPOLICYID__/g,oe.booking_policy_id),Z}else return""}}],language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"}}),y=a({responsive:!0,processing:!0,deferRender:!0,ajax:{url:G.campgroundCampsites(v.params.id),dataSrc:""},columnDefs:[{defaultContent:"-",targets:"_all"},{responsivePriority:1,targets:0},{responsivePriority:2,targets:3},{responsivePriority:3,targets:1},{responsivePriority:4,targets:2}],columns:[{data:"name"},{data:"type",mRender:function(_,V,oe){if(_){var Z=25,F=_.length>Z?_.substring(0,Z-1)+"...":_,se='<td> <div class="name_popover" tabindex="0" data-toggle="popover" data-placement="top" data-content="__NAME__" >'+F+"</div></td>";return se.replace("__NAME__",_)}return""}},{data:"active",mRender:function(_,V,oe){return _?"Open":"Closed"}},{data:"price"},{mRender:function(_,V,oe){var Z=oe.id;if(oe.active){var F=`<td ><a href='#' class='detailRoute' data-campsite="__ID__" >Edit</a><br/>`;oe.campground_open&&(F+=`<a href='#' class='statusCS' data-status='close' data-campsite="__ID__" >Close</a></td>`)}else{var F=`<td ><a href='#' class='detailRoute' data-campsite="__ID__" >Edit</a><br/>`;oe.campground_open&&(F+=`<a href='#' class='statusCS' data-status='open' data-campsite="__ID__" data-current_closure='`+oe.current_closure+"' data-current_closure_id='"+oe.current_closure_id+"'>Open</a></td>")}return F.replace(/__ID__/g,Z)}}],language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"}}),k=["Name","Type","Status","Price","Action"],U=a({icon:"<i class='fa fa-exclamation-triangle fa-2x text-danger' aria-hidden='true'></i>",message:"Are you sure you want to Delete ?",buttons:[{text:"Delete",event:"deleteRange",bsColor:"btn-danger",handler:function(){w(M.value),M.value=null},autoclose:!0}],id:"deleteRange"}),$=Q(function(){return G.campground_status_history(v.params.id)});Q(function(){return G.campground_price_history(v.params.id)});const u=Q(function(){return parseInt(v.params.id)}),f=Q(function(){return P.value.length>0}),q=Q(function(){return b.value.id?b.value.id:0}),A=Q(function(){return G.delete_campground_price(u)}),w=function(_){var V=G.campground_booking_ranges_detail(_);s.ajax({method:"DELETE",url:V,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).done(function(oe){x.value.vmDataTable.ajax.reload()})},m=function(){n.value.isOpen=!0},E=function(){var _=d.value.formdata;s.ajax({url:G.campsite_booking_ranges_detail(d.value.id),method:"PATCH",xhrFields:{withCredentials:!0},data:_,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(V,oe,Z){d.value.close(),I()},error:function(V){d.value.errors=!0,d.value.errorString=re.apiError(V)}})},B=function(){const _=n.value.formdata;s.ajax({url:G.campsite_booking_ranges(),method:"POST",xhrFields:{withCredentials:!0},data:_,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(V,oe,Z){n.value.close(),I()},error:function(V){n.value.errors=!0,n.value.errorString=re.apiError(V)}})},te=function(){var _=p.value.formdata;console.log(p.value),console.log(_),s.ajax({url:G.bulk_close_campsites(),method:"POST",xhrFields:{withCredentials:!0},data:_,headers:{"X-CSRFToken":re.getCookie("csrftoken")},dataType:"json",success:function(V,oe,Z){p.value.close(),I()},error:function(V){p.value.errors=!0,p.value.errorString=re.apiError(V)}})},I=function(_){O.value.vmDataTable.ajax.reload()},h=function(){d.value.isOpen=!0},T=function(){s.get(G.campgroundCampsites(v.params.id),function(_){P.value=_})},R=function(){s.ajax({url:G.campground(v.params.id),dataType:"json",success:function(_,V,oe){b.value=_,T(),Ie.emit("campgroundFetched")}})};return $e(function(){O.value.vmDataTable.on("click",".detailRoute",function(_){_.preventDefault();var V=s(this).attr("data-campsite");c.push({name:"view_campsite",params:{id:b.value.id,campsite_id:V}})}),O.value.vmDataTable.on("click",".statusCS",function(_){_.preventDefault();var V=s(this).attr("data-campsite"),oe=s(this).attr("data-status"),Z=s(this).attr("data-current_closure")?s(this).attr("data-current_closure"):"",F=s(this).attr("data-current_closure_id")?s(this).attr("data-current_closure_id"):"";oe==="open"?(h(),d.value.id=F,d.value.current_closure=Z):oe==="close"&&(m(),n.value.formdata.campsite=V)}),re.namePopover(s,O.value.vmDataTable),R()}),(_,V)=>{const oe=nt("router-link");return C(),S("div",Lr,[ee(Mt,{ref_key:"closeCampsiteRef",ref:n,onCloseCampsite:B},null,512),ee(kr,{ref_key:"openCampsiteRef",ref:d,onOpenCampsite:V[0]||(V[0]=Z=>E())},null,512),e("div",Nr,[e("div",{class:"panel-heading",role:"tab",id:"applications-heading"},[e("h4",{class:"panel-title"},H(si))]),e("div",Br,[e("div",Gr,[e("div",Jr,[e("div",zr,[ee(St,{createCampground:!1,campground:b.value},null,8,["campground"])]),ee(Hr,{object_id:u.value,datatableURL:De(D),style:{"margin-top":"100px"}},null,8,["object_id","datatableURL"]),g(ee(dt,{ref_key:"price_dt",ref:i,level:"campground",dt_options:Y.value,historyDeleteURL:A.value,showAddBtn:f.value,object_id:u.value},null,8,["dt_options","historyDeleteURL","showAddBtn","object_id"]),[[ae,b.value.price_level==0]]),ee(Tt,{ref_key:"cg_closure_dt",ref:x,object_id:u.value,datatableURL:$.value},null,8,["object_id","datatableURL"])])])])]),e("div",Xr,[V[4]||(V[4]=e("div",{class:"panel-heading",role:"tab",id:"applications-heading"},[e("h4",{class:"panel-title"}," Camp Sites ")],-1)),e("div",Wr,[e("div",Kr,[e("div",Qr,[e("div",Zr,[e("div",ei,[e("div",ti,[e("button",{onClick:V[1]||(V[1]=Z=>t.value=!0),class:"btn btn-primary table_btn"},"Close Campsites"),ee(oe,{to:{name:"add_campsite",params:{id:q.value}},class:"btn btn-primary table_btn",style:{"margin-right":"1em"}},{default:ue(()=>V[3]||(V[3]=[W("Add Campsite")])),_:1},8,["to"])]),ee(Xe,{ref_key:"cg_campsites_dt",ref:O,dtHeaders:k,dtOptions:y.value,id:"cs_table"},null,8,["dtOptions"])])])])])])]),ee(rt,{id:"deleteRange",options:U.value},null,8,["options"]),ee(Xn,{onBulkCloseCampsites:te,isModalOpen:t.value,onCancel:V[2]||(V[2]=Z=>t.value=!1),ref_key:"bulkCloseCampsitesRef",ref:p,campsites:P.value},null,8,["isModalOpen","campsites"])])}}},ai={class:"panel-group",id:"applications-accordion",role:"tablist","aria-multiselectable":"true"},li={class:"card p-3",id:"applications"},ni={id:"applications-collapse",class:"",role:"tabpanel","aria-labelledby":"applications-heading"},ri={class:"panel-body"},ii={class:"col-lg-12"},di={class:"row"},ui={__name:"addCampground",setup(o){const c=a({address:{},images:[]});return(v,n)=>(C(),S("div",ai,[e("div",li,[n[2]||(n[2]=e("div",{class:"panel-heading",role:"tab",id:"applications-heading"},[e("div",{class:"panel-title"},[e("h3",null,"New Campground")])],-1)),n[3]||(n[3]=e("hr",null,null,-1)),e("div",ni,[e("div",ri,[e("div",ii,[e("div",di,[n[1]||(n[1]=e("div",{class:"col-sm-12"},null,-1)),ee(St,{campground:c.value,"onUpdate:campground":n[0]||(n[0]=d=>c.value=d)},null,8,["campground"])])])])])])]))}},ci={id:"campsite"},pi={class:"col-lg-12 card p-3"},vi={class:"row"},mi={class:"panel panel-primary"},fi={class:"panel-body"},_i={class:"row"},gi={class:"col-md-6"},hi={class:"form-group"},yi={class:"form-control form-select"},bi=["value"],ki={class:"col-md-6"},$i={class:"form-group"},Ci={class:"row"},wi={class:"col-md-6"},xi={class:"form-group"},Di=["disabled"],Ti={class:"col-md-6"},Si={class:"form-group"},Mi=["disabled"],Ei={class:"row"},Pi={class:"col-md-6"},Ri={class:"form-group"},Oi={class:"checkbox"},Yi=["disabled"],Ui={class:"checkbox"},Ai=["disabled"],Vi={class:"checkbox"},qi=["disabled"],Fi={class:"col-md-6"},ji={key:0,class:"form-group"},Ii=["disabled"],Hi={class:"row"},Li={class:"col-sm-6"},Ni={class:"row"},Bi={class:"form-group"},Gi={class:"col-sm-6 col-xs-8"},Ji={class:"col-sm-2 col-xs-4 pull-right"},zi={class:"row",style:{"margin-top":"10px"}},Xi={class:"col-sm-6 pull-right"},Wi={class:"pull-right"},Ki={style:{"margin-top":"50px"}},yt={__name:"campsite",setup(o){const c=Ne(),v=lt(),n=a(null),d=a(null),i=a(null),x=a(null),O=a(null),p=a(!1),D=a(!0),b=a({}),P=a({}),t=a({number:1,campsite_class:"",tent:!1,description:"",campervan:!1,caravan:!1,min_people:"",max_people:"",max_vehicles:""}),M=a([]),Y=a({responsive:!0,processing:!0,deferRender:!0,ajax:{url:G.campsites_price_history(v.params.id),dataSrc:""},columnDefs:[{defaultContent:"-",targets:"_all"}],columns:[{data:"date_start",mRender:function(h,T,R){return ce(h).format("DD/MM/YYYY")}},{data:"date_end",mRender:function(h,T,R){return h?ce(h).add(1,"day").format("DD/MM/YYYY"):""}},{data:"adult"},{data:"concession"},{data:"child"},{data:"details",mRender:function(h,T,R){return h||""}},{data:"editable",mRender:function(h,T,R){if(h&&R.update_level==2){R.id;var _=`<td ><a href='#' class='editPrice' data-rate="__ID__" data-bookingpolicyid="__BOOKINGPOLICYID__">Edit</a><br/>`;return R.deletable&&(_+=`<a href='#' class='deletePrice' data-rate="__ID__">Delete</a></td>`),_=_.replace(/__ID__/g,R.id),_=_.replace(/__BOOKINGPOLICYID__/g,R.booking_policy),_}else return""}}],language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"}}),y=Q(function(){return G.campsite_status_history(O.value)});Q(function(){return G.campsites_stay_history});const k=Q(function(){return parseInt(O.value)}),U=Q(function(){return!!t.value.can_add_rate}),$=Q(function(){return D.value&&t.value.number==1||!D.value}),u=function(){return t.value.campsite_class!=null?t.value.campsite_class:""},f=function(){if(M.value.length>0&&u()){var h=M.value.find(function(T){return T.url==t.value.campsite_class});h&&(t.value.tent=h.tent,t.value.caravan=h.caravan,t.value.campervan=h.campervan,t.value.max_people=h.max_people,t.value.min_people=h.min_people,t.value.description=h.description,t.value.max_vehicles=h.max_vehicles)}},q=function(){const h=t.value.id;i.value.id=h,i.value.isOpen=!0},A=function(){s.ajax({url:G.campsite(O.value),method:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(h,T,R){var _=setInterval(function(){M.value.length>0&&(b.value=h,t.value=JSON.parse(JSON.stringify(h)),h.campsite_class&&f(),clearInterval(_))},100)},error:function(h){h.status==404&&c.push({name:"404"})}})},w=function(){s.get(G.campground(O.value),function(h){P.value=h,t.value.campground=h.id})},m=function(){s.get(G.campsite_classes_active,function(h){M.value=h})},E=function(){c.go(window.history.back())},B=function(){I.value(G.campsites,"POST")},te=function(){I.value(G.campsite(O.value),"PUT")},I=function(h,T){p.value=!0;var R=t.value;s.ajax({beforeSend:function(_){_.setRequestHeader("Content-Type","application/json"),_.setRequestHeader("Accept","application/json")},xhrFields:{withCredentials:!0},url:h,method:T,data:JSON.stringify(R),headers:{"X-CSRFToken":re.getCookie("csrftoken")},success:function(_){Array.isArray(_)&&(_=_[_.length-1]),b.value=_,t.value=JSON.parse(JSON.stringify(_)),_.campsite_class&&f(),setTimeout(function(){p.value=!1},500)},error:function(_){p.value=!1}})};return $e(function(){x.value=document.forms.campsiteForm,O.value=v.params.id,m(),w(),O.value&&(D.value=!1,A())}),(h,T)=>(C(),S("div",ci,[ee(Mt,{ref_key:"closeCampsite",ref:i,onCloseCampsite:T[0]||(T[0]=R=>q())},null,512),e("div",pi,[e("div",vi,[e("form",{name:"campsiteForm",ref_key:"campsiteForm",ref:x},[e("div",mi,[T[21]||(T[21]=e("div",{class:"panel-heading"},[e("h3",{class:"panel-title"},"Campsite Details")],-1)),g(e("div",fi,[e("div",_i,[e("div",gi,[e("div",hi,[T[12]||(T[12]=e("label",{class:"control-label"},"Campsite Type",-1)),g(e("select",yi,T[10]||(T[10]=[e("option",null,"Loading...",-1)]),512),[[ae,!M.value.length>0]]),M.value.length>0?g((C(),S("select",{key:0,onChange:f,name:"campsite_class",class:"form-control form-select","onUpdate:modelValue":T[1]||(T[1]=R=>t.value.campsite_class=R)},[T[11]||(T[11]=e("option",{value:""},null,-1)),(C(!0),S(ie,null,de(M.value,R=>(C(),S("option",{value:R.id},H(R.name),9,bi))),256))],544)),[[ke,t.value.campsite_class]]):fe("",!0)])]),g(e("div",ki,[e("div",$i,[T[13]||(T[13]=e("label",{class:"control-label"},"Campsite Name",-1)),g(e("input",{type:"text",name:"name",class:"form-control","onUpdate:modelValue":T[2]||(T[2]=R=>t.value.name=R),required:""},null,512),[[X,t.value.name]])])],512),[[ae,$.value]])]),e("div",Ci,[e("div",wi,[e("div",xi,[T[14]||(T[14]=e("label",{class:"control-label"},"Minimum Number of People",-1)),g(e("input",{type:"number",name:"name",class:"form-control","onUpdate:modelValue":T[3]||(T[3]=R=>t.value.min_people=R),required:"",disabled:u()!=""},null,8,Di),[[X,t.value.min_people]])])]),e("div",Ti,[e("div",Si,[T[15]||(T[15]=e("label",{class:"control-label"},"Maximum Number of People",-1)),g(e("input",{type:"number",name:"name",class:"form-control","onUpdate:modelValue":T[4]||(T[4]=R=>t.value.max_people=R),required:"",disabled:u()!=""},null,8,Mi),[[X,t.value.max_people]])])])]),e("div",Ei,[e("div",Pi,[e("div",Ri,[e("div",Oi,[e("label",null,[g(e("input",{type:"checkbox","onUpdate:modelValue":T[5]||(T[5]=R=>t.value.tent=R),disabled:u()!=""},null,8,Yi),[[Te,t.value.tent]]),T[16]||(T[16]=W("Tent"))])]),e("div",Ui,[e("label",null,[g(e("input",{type:"checkbox","onUpdate:modelValue":T[6]||(T[6]=R=>t.value.campervan=R),disabled:u()!=""},null,8,Ai),[[Te,t.value.campervan]]),T[17]||(T[17]=W("Campervan"))])]),e("div",Vi,[e("label",null,[g(e("input",{type:"checkbox","onUpdate:modelValue":T[7]||(T[7]=R=>t.value.caravan=R),disabled:u()!=""},null,8,qi),[[Te,t.value.caravan]]),T[18]||(T[18]=W("Caravan"))])])])]),e("div",Fi,[P.value.site_type==0?(C(),S("div",ji,[T[19]||(T[19]=e("label",{class:"control-label"},"Maximum Number of Vehicles",-1)),g(e("input",{type:"number",name:"max_vehicles",class:"form-control","onUpdate:modelValue":T[8]||(T[8]=R=>t.value.max_vehicles=R),required:"",disabled:u()!=""},null,8,Ii),[[X,t.value.max_vehicles]])])):fe("",!0)])]),e("div",Hi,[T[20]||(T[20]=e("div",{class:"col-sm-6"},null,-1)),e("div",Li,[e("div",Ni,[e("div",Bi,[e("div",Gi,[g(e("button",{onClick:_e(B,["prevent"]),type:"button",class:"btn btn-primary btn-create"},"Create",512),[[ae,D.value]])]),e("div",Ji,[g(e("input",{type:"number",class:"form-control",name:"number","onUpdate:modelValue":T[9]||(T[9]=R=>t.value.number=R),value:""},null,512),[[ae,D.value],[X,t.value.number]])])])]),e("div",zi,[e("div",Xi,[e("div",Wi,[g(e("button",{type:"button",style:{"margin-right":"5px"},onClick:te,class:"btn btn-primary"},"Update",512),[[ae,!D.value]]),e("button",{type:"button",class:"btn btn-default pull-right",onClick:E},"Back")])])])])])],512),[[ae,!p.value]])])],512),ee(He,{isLoading:p.value},{default:ue(()=>T[22]||(T[22]=[W("Saving Campsite Data...")])),_:1},8,["isLoading"])]),e("div",Ki,[D.value?fe("",!0):(C(),Ye(dt,{key:0,level:"campsite",ref_key:"price_dt",ref:n,object_id:k.value,dt_options:Y.value,showAddBtn:U.value},null,8,["object_id","dt_options","showAddBtn"])),D.value?fe("",!0):(C(),Ye(Tt,{key:1,ref_key:"cg_closure_dt",ref:d,closeCampground:!1,object_id:k.value,datatableURL:y.value},null,8,["object_id","datatableURL"]))])])]))}},Qi={class:"row"},Zi={class:"col-lg-12"},ed={class:"well"},td={class:"",name:"flsearch"},sd={class:"row"},od={class:"col-md-3"},ad={class:"form-group"},ld={class:"col-lg-4 col-md-3"},nd={class:"form-inline",name:"guest"},rd={class:"form-group"},id={class:"dropdown"},dd={class:"dropdown-menu","aria-labelledby":"dropdownMenu1"},ud={class:"row"},cd={class:"col-sm-8"},pd={class:"item"},vd={style:{color:"#888","font-weight":"300","font-size":"12px"}},md={class:"pull-right"},fd={class:"btn-group btn-group-sm"},_d=["onClick"],gd=["onClick"],hd={class:"form-group"},yd={__name:"bookingpicker",props:{value:{type:Object,default:()=>({where:"",checkin:"",checkout:"",guests:{adults:0,concession:0,children:0,infants:0}})}},setup(o){const c=Ne(),n=a(o.value),d=a(null);a([]);const i=a([]),x=a(""),O=a([{id:"adults",name:"Adults (no concession)",amount:0,description:""},{id:"concession",name:"Concession",amount:0,description:"",helpText:"accepted concession cards"},{id:"children",name:"Children",amount:0,description:"Ages 6-16"},{id:"infants",name:"Infants",amount:0,description:"Ages 0-5"}]),p=Q(function(){return i.value.length>0}),D=function(M){switch(M.amount+=1,M.id){case"adults":n.value.guests.adults=M.amount;break;case"concession":n.value.guests.concession=M.amount;break;case"children":n.value.guests.children=M.amount;break;case"infants":n.value.guests.infants=M.amount;break}P()},b=function(M){switch(M.amount=M.amount>0?M.amount-1:0,M.id){case"adults":n.value.guests.adults=M.amount;break;case"concession":n.value.guests.concession=M.amount;break;case"children":n.value.guests.children=M.amount;break;case"infants":n.value.guests.infants=M.amount;break}P()},P=function(){var M="";s.each(O.value,function(Y,y){Y!=O.value.length-1?y.amount>0&&(M+=y.amount+" "+y.name+",  "):y.amount>0&&(M+=y.amount+" "+y.name+" ")}),x.value=M.replace(/,\s*$/,"")},t=function(){c.push({path:"/map",query:{search:n.value.where,arrival:n.value.checkin,depature:n.value.checkout,adults:n.value.guests.adults,children:n.value.guests.children,concession:n.value.guests.concession,infants:n.value.guests.infants}})};return $e(function(){d.value=document.forms.flsearch;var M=document.forms.when.checkin,Y=document.forms.when.checkout;document.forms.guest.guests;var y=s(M).daterangepicker({autoApply:!0,minDate:new Date,autoUpdateInput:!1});y.on("apply.daterangepicker",function(k,U){s(M).val(U.startDate.format("ddd MMM Do, YYYY")),s(Y).val(U.endDate.format("ddd MMM Do, YYYY")),n.value.checkin=U.startDate.format("YYYY/MM/D"),n.value.checkout=U.endDate.format("YYYY/MM/D")})}),(M,Y)=>(C(),S("div",Qi,[e("div",Zi,[e("div",ed,[e("form",td,[e("div",sd,[e("div",od,[e("div",ad,[Y[3]||(Y[3]=e("label",{for:"where"},"Where",-1)),g(e("input",{type:"text",class:"form-control",name:"where",placeholder:"Region, Park","onUpdate:modelValue":Y[0]||(Y[0]=y=>n.value.where=y)},null,512),[[X,n.value.where]])])]),Y[8]||(Y[8]=Qe('<div class="col-lg-5 col-md-6" data-v-c3b031cb><label for="When" data-v-c3b031cb>When</label><form class="form-inline" name="when" data-v-c3b031cb><div class="form-group" data-v-c3b031cb><input type="text" class="form-control" name="checkin" placeholder="Check In" data-v-c3b031cb></div><div class="form-group" data-v-c3b031cb><label for="" data-v-c3b031cb><i class="fa fa-arrow-right hidden-xs" data-v-c3b031cb></i></label><input type="text" class="form-control" name="checkout" placeholder="Check Out" data-v-c3b031cb></div></form></div>',1)),e("div",ld,[Y[7]||(Y[7]=e("label",{for:"guest"},"Guest",-1)),e("form",nd,[e("div",rd,[e("div",id,[g(e("input",{type:"text",class:"form-control dropdown-toggle",name:"guests",placeholder:"Guest","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true","onUpdate:modelValue":Y[1]||(Y[1]=y=>x.value=y)},null,512),[[X,x.value]]),e("ul",dd,[(C(!0),S(ie,null,de(O.value,y=>(C(),S("li",null,[e("div",ud,[e("div",cd,[e("span",pd,[W(H(y.amount)+" "+H(y.name)+" ",1),e("span",vd,H(y.description),1)]),Y[4]||(Y[4]=e("br",null,null,-1)),g(e("a",{href:"#",class:"text-info"},H(y.helpText),513),[[ae,y.helpText]])]),e("div",md,[e("div",fd,[e("button",{type:"button",class:"btn btn-guest",onClick:_e(k=>D(y),["prevent","stop"])},Y[5]||(Y[5]=[e("span",{class:"glyphicon glyphicon-plus"},null,-1)]),8,_d),e("button",{type:"button",class:"btn btn-guest",onClick:_e(k=>b(y),["prevent","stop"])},Y[6]||(Y[6]=[e("span",{class:"glyphicon glyphicon-minus"},null,-1)]),8,gd)])])])]))),256))])])]),e("div",hd,[e("button",{type:"button",class:"btn btn-primary",onClick:Y[2]||(Y[2]=_e(y=>t(),["prevent"]))}," Search")])])])])])])]),ee(He,{isLoading:p.value},{default:ue(()=>[W(H(i.value.join(" , ")),1)]),_:1},8,["isLoading"])]))}},bd=et(yd,[["__scopeId","data-v-c3b031cb"]]),kd={id:"flsearch"},$d={__name:"first-level-search",setup(o){return(c,v)=>(C(),S("div",kd,[ee(bd)]))}},Cd={id:"change-booking"},wd={class:"form-horizontal",name:"changebookingForm"},xd={class:"row"},Dd={class:"col-lg-12"},Td={class:"form-group"},Sd={class:"col-md-4"},Md=["value"],Ed={class:"form-group"},Pd={class:"col-md-4"},Rd={class:"form-control"},Od=["value"],Yd={__name:"changebooking",props:{booking_id:Number,campgrounds:{type:Array,default:()=>[]}},emits:["loadingCallback"],setup(o,{emit:c}){const v=c,n=o,{campgrounds:d}=at(n),i=a(!1),x=a([]),O=a(null),p=a({campsites:[]}),D=a(!1),b=a(""),P=a(""),t=a(!1);a(null),a(null);const M=Q(function(){return p.value.campground});Q(function(){return p.value.campsites});const Y=Q(function(){return D.value});ge(()=>M,function(u){u?fetch(G.campgroundCampsites(u)).then(f=>{x.value=f.body},f=>{console.log(f)}):x.value=[]});const y=function(){s(O.value).valid()&&U()},k=function(){},U=function(){D.value=!1,t.value=!1;var u=u.value;v("loadingCallback",{value:"processing booking",show:!0}),fetch(G.booking(u.id),{method:"PUT",body:u,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(f=>{v("loadingCallback",{value:"processing booking",show:!1}),P.value="Booking Updated",t.value=!0}).catch(f=>{console.log(f),D.value=!0,b.value=re.apiVueResourceError(f),v("loadingCallback",{value:"processing booking",show:!1})})},$=function(){s(O.value).validate({rules:{arrival:"required",departure:"required",campground:"required",campsite:{required:{depends:function(u){return x.value.length>0}}}},messages:{arrival:"field is required",departure:"field is required",campground:"field is required",campsite:"field is required"},showErrors:function(u,f){s.each(this.validElements(),function(w,m){var E=s(m);E.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var q=0;q<f.length;q++){var A=f[q];s(A.element).tooltip({trigger:"focus"}).attr("data-original-title",A.message).parents(".form-group").addClass("has-error")}}})};return $e(()=>{O.value=document.forms.changebookingForm,$()}),(u,f)=>(C(),S("div",Cd,[ee(Ae,{onOk:f[3]||(f[3]=q=>y()),onCancel:f[4]||(f[4]=q=>k()),title:"Change Booking",large:"",isModalOpen:i.value},{default:ue(()=>[e("form",wd,[e("div",xd,[ee(Ee,{show:Y.value,"onUpdate:show":f[0]||(f[0]=q=>Y.value=q),type:"danger"},{default:ue(()=>[e("strong",null,H(b.value),1)]),_:1},8,["show"]),ee(Ee,{show:t.value,type:"success"},{default:ue(()=>[e("strong",null,H(P.value),1)]),_:1},8,["show"]),e("div",Dd,[f[10]||(f[10]=e("div",{class:"form-group"},[e("label",{class:"col-md-2 control-label pull-left",for:"Dates"},"Dates: "),e("div",{class:"col-md-4"},[e("div",{class:"input-group arrivalPicker date"},[e("input",{type:"text",class:"form-control",name:"arrival",placeholder:"DD/MM/YYYY"}),e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})])])]),e("div",{class:"col-md-4"},[e("div",{class:"input-group departurePicker date"},[e("input",{type:"text",class:"form-control",name:"departure",placeholder:"DD/MM/YYYY"}),e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})])])])],-1)),e("div",Td,[f[6]||(f[6]=e("label",{class:"col-md-2 control-label pull-left",for:"Campground"},"Campground: ",-1)),e("div",Sd,[g(e("select",{class:"form-control",name:"campground","onUpdate:modelValue":f[1]||(f[1]=q=>p.value.campground=q)},[f[5]||(f[5]=e("option",{value:""},"Select Campground",-1)),(C(!0),S(ie,null,de(De(d),q=>(C(),S("option",{value:q.id},H(q.name),9,Md))),256))],512),[[ke,p.value.campground]])])]),g(e("div",Ed,[f[9]||(f[9]=e("label",{class:"col-md-2 control-label pull-left",for:"Campsite"},"Campsite: ",-1)),e("div",Pd,[g(e("select",Rd,f[7]||(f[7]=[e("option",{selected:"",value:""},"Loading...",-1)]),512),[[ae,x.value.length<1]]),x.value.length>0?g((C(),S("select",{key:0,class:"form-control",name:"campsite","onUpdate:modelValue":f[2]||(f[2]=q=>p.value.campsites=q)},[f[8]||(f[8]=e("option",{value:""},"Select Campsite",-1)),(C(!0),S(ie,null,de(x.value,q=>(C(),S("option",{value:q.id},H(q.name),9,Od))),256))],512)),[[ke,p.value.campsites]]):fe("",!0)])],512),[[ae,M.value]])])])])]),_:1},8,["isModalOpen"])]))}},Ud={id:"history-booking"},Ad={class:"row"},Vd={class:"col-lg-12"},qd={class:"row"},Fd={class:"col-sm-3"},jd={class:"col-sm-3"},Id={class:"col-sm-3"},Hd={class:"col-sm-3"},Ld={class:"row",style:{"margin-top":"10px"}},Nd={class:"col-sm-3"},Bd={class:"col-sm-3"},Gd={class:"col-sm-3"},Jd={class:"col-sm-3"},zd={class:"row",style:{"margin-top":"10px"}},Xd={class:"col-sm-4"},Wd={class:"col-sm-8"},Kd={class:"row",style:{"margin-top":"10px"}},Qd={class:"col-sm-6"},Zd={class:"row"},eu={class:"col-sm-4"},tu={class:"col-sm-4"},su={class:"col-sm-4"},ou={key:0,class:"fa fa-check",style:{color:"green"}},au={key:1,class:"fa fa-times",style:{color:"red"}},lu={class:"col-lg-12",style:{"margin-top":"10px"}},nu={__name:"history",props:["booking_id"],setup(o,{expose:c}){const v=o,{booking_id:n}=at(v),d=a(null),i=a(!1),x=a({guests:{},campground_site_type:""}),O=a(!0),p=["Change Date","Arrival","Departure","Campground","Camp Site","Updated By","Details"],D=a({language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"},responsive:!0,processing:!0,ajax:{url:`/api/booking/${n.value}/history.json`,dataSrc:""},order:[],columns:[{data:"created",orderable:!1,searchable:!1,mRender:function(y,k,U){return ce(y).format("DD/MM/YYYY HH:mm:ss")}},{data:"arrival",orderable:!1,searchable:!1,mRender:function(y,k,U){var $=ce(y).format("DD/MM/YYYY");return x.value.arrival==y?`<span style="color:green;">${$}</span>`:`<span style="color:red;">${$}</span>`}},{data:"departure",orderable:!1,searchable:!1,mRender:function(y,k,U){var $=ce(y).format("DD/MM/YYYY");return x.value.departure==y?`<span style="color:green;">${$}</span>`:`<span style="color:red;">${$}</span>`}},{data:"campground",orderable:!1,searchable:!1,mRender:function(y,k,U){return x.value.campground_name==y?`<span style="color:green;">${y}</span>`:`<span style="color:red;">${y}</span>`}},{data:"campsites",orderable:!1,searchable:!1,mRender:function(y,k,U){var $=y.sort().join(","),u=10,f=$.length>u?"class='name_popover'":"",q=$.length>u?$.substring(0,u-1)+"...":$,A="<div "+f+'tabindex="0" data-toggle="popover" data-placement="top" data-content="__NAME__" >'+q+"</div>";return x.value.campsite_names==$?`<span style="color:green;">${A.replace("__NAME__",$)}</span>`:`<span style="color:red;">${A.replace("__NAME__",$)}</span>`}},{data:"updated_by",orderable:!1},{className:"details-control",orderable:!1,data:null,defaultContent:""}]});c({booking:x,isModalOpen:i}),ge(()=>n.value,function(y){ft(()=>{y>0&&(d.value.vmDataTable.ajax.url(`/api/booking/${y}/history.json`),d.value.vmDataTable.ajax.reload(),Y())})});const b=Q(function(){const y={},k=[];for(let $=0;$<x.value.campground_site_type.length;$++){if(x.value.campground_site_type[$].campground_type===0){k.push(x.value.campground_site_type[$].name);continue}y[x.value.campground_site_type[$].type]==null&&(y[x.value.campground_site_type[$].type]=0),y[x.value.campground_site_type[$].type]+=1}for(let $ in y){let u=y[$],f=$.split(":",1)[0];k.push(`${u}x ${f}`)}return k.join(", ")}),P=function(){s(form.value).valid()&&sendData()},t=function(){},M=function(y){var k='<table class="vehicle_history_data" cellpadding="10" cellspacing="40" border="0" style="padding:10px;"><tr><th>Rego</th><th>Type</th><th>Entry Fee</th></tr>';s.each(y.vehicles,function(w,m){var E=m.entry_fee?'<i class="fa fa-check" style="color:green;"></i>':'<i class="fa fa-times" style="color:red;"></i>',B=x.value.vehicle_payment_status.find(I=>I.Rego==m.rego.toUpperCase()),te=B&&B.Fee==m.entry_fee&&B.Rego==m.rego.toUpperCase()&&m.type==B.original_type?"green":"red";k+=`<tr style="color: ${te};">
                                <td>${m.rego}</td>
                                <td>${m.type}</td>
                                <td>${E}</td>
                            </tr>`}),k+="</table>";var U=x.value.guests.adults==y.details.num_adult?`<tr style='color:green;'><td>Adults:</td><td>${y.details.num_adult}</td></tr>`:`<tr style='color:red;'><td>Adults:</td><td>${y.details.num_adult}</td></tr>`,$=x.value.guests.concession==y.details.num_concession?`<tr style='color:green;'><td>Adults (Concession):</td><td>${y.details.num_concession}</td></tr>`:`<tr style='color:red;'><td>Adults (Concession):</td><td>${y.details.num_concession}</td></tr>`,u=x.value.guests.children==y.details.num_child?`<tr style='color:green;'><td>Children:</td><td>${y.details.num_child}</td></tr>`:`<tr style='color:red;'><td>Children:</td><td>${y.details.num_child}</td></tr>`,f=x.value.guests.infants==y.details.num_infant?`<tr style='color:green;'><td>Infants:</td><td>${y.details.num_infant}</td></tr>`:`<tr style='color:red;'><td>Infants:</td><td>${y.details.num_infant}</td></tr>`,q=`<tr><td>Invoice:</td><td><a href='/ledger/payments/invoice-pdf/${y.invoice}' target='_blank' class='text-primary' style='padding-left:0;'><i style='color:red;' class='fa fa-file-pdf-o'></i>&nbsp #${y.invoice}</a></td></tr>`,A=parseFloat(x.value.cost_total)==parseFloat(y.cost_total)?`<tr style='color:green;'><td>Cost:</td><td>${y.cost_total}</td></tr>`:`<tr style='color:red;'><td>Cost:</td><td>${y.cost_total}</td></tr>`;return'<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+U+$+u+f+`<tr><td>Vehicles:</td><td>${k}</td></tr>`+A+q+"</table>"},Y=function(){O.value&&(O.value=!1,d.value.vmDataTable.on("click","td.details-control",function(){var y=s(this).closest("tr"),k=d.value.vmDataTable.row(y);k.child.isShown()?(k.child.hide(),y.removeClass("shown")):(k.child(M(k.data())).show(),y.addClass("shown"))})),re.namePopover(s,d.value.vmDataTable)};return(y,k)=>(C(),S("div",Ud,[ee(Ae,{showOK:!1,cancelText:"Close",onOk:k[0]||(k[0]=U=>P()),onCancel:k[1]||(k[1]=U=>t()),title:"Booking History",large:"",isModalOpen:i.value},{default:ue(()=>[e("div",Ad,[e("div",Vd,[k[16]||(k[16]=e("h3",null,"Current Booking Details",-1)),e("div",qd,[e("div",Fd,[e("span",null,[k[2]||(k[2]=e("strong",null,"Confirmation #",-1)),W(" : PB"+H(x.value.id),1)])]),e("div",jd,[e("span",null,[k[3]||(k[3]=e("strong",null,"Arrival",-1)),W(" : "+H(x.value.arrival|y.formatDate),1)])]),e("div",Id,[e("span",null,[k[4]||(k[4]=e("strong",null,"Departure",-1)),W(" : "+H(x.value.departure|y.formatDate),1)])]),e("div",Hd,[e("span",null,[k[5]||(k[5]=e("strong",null,"Cost",-1)),W(" : "+H(x.value.cost_total|y.formatMoney),1)])])]),e("div",Ld,[e("div",Nd,[e("span",null,[k[6]||(k[6]=e("strong",null,"Adults",-1)),W(" : "+H(x.value.guests.adults),1)])]),e("div",Bd,[e("span",null,[k[7]||(k[7]=e("strong",null,"Adults (Concession)",-1)),W(" : "+H(x.value.guests.concession),1)])]),e("div",Gd,[e("span",null,[k[8]||(k[8]=e("strong",null,"Children",-1)),W(" : "+H(x.value.guests.children),1)])]),e("div",Jd,[e("span",null,[k[9]||(k[9]=e("strong",null,"Infants",-1)),W(" : "+H(x.value.guests.infants),1)])])]),e("div",zd,[e("div",Xd,[e("span",null,[k[10]||(k[10]=e("strong",null,"Campground",-1)),W(" : "+H(x.value.campground_name),1)])]),e("div",Wd,[e("label",null,"Camp Site (Type): "+H(b.value),1)])]),e("div",Kd,[e("div",Qd,[k[15]||(k[15]=e("h4",null,"Vehicles",-1)),(C(!0),S(ie,null,de(x.value.vehicle_payment_status,U=>(C(),S("div",Zd,[e("div",eu,[e("span",null,[k[11]||(k[11]=e("strong",null,"Rego",-1)),W(" : "+H(U.Rego),1)])]),e("div",tu,[e("span",null,[k[12]||(k[12]=e("strong",null,"Type",-1)),W(" : "+H(U.Type),1)])]),e("div",su,[e("span",null,[k[13]||(k[13]=e("strong",null,"Entry Fee",-1)),k[14]||(k[14]=W(" : ")),U.Fee?(C(),S("i",ou)):(C(),S("i",au))])])]))),256))])])]),e("div",lu,[k[17]||(k[17]=e("h3",null,"Booking History Details",-1)),De(n)>0?(C(),Ye(Xe,{key:0,ref_key:"booking_history_table",ref:d,id:"booking_history-table",dtOptions:D.value,dtHeaders:p},null,8,["dtOptions"])):fe("",!0)])])]),_:1},8,["isModalOpen"])]))}},ru={class:"row"},iu={class:"col-lg-12"},du={class:"card p-3",style:{overflow:"auto"}},uu={class:"row"},cu={class:"col-lg-12"},pu={key:1,type:"button",class:"btn btn-default pull-right",disabled:""},vu={class:"row"},mu={class:"col-md-4"},fu={class:"form-group"},_u={class:"form-control"},gu=["value"],hu={class:"col-md-4"},yu={class:"form-group"},bu={class:"form-control",name:""},ku=["value"],$u={class:"col-md-4"},Cu={class:"form-group"},wu={class:"row",style:{"margin-bottom":"10px"}},xu={class:"col-md-4"},Du={class:"input-group date",id:"booking-date-from"},Tu={class:"col-md-4"},Su={class:"input-group date",id:"booking-date-to"},Mu={key:0,class:"col-md-4"},Eu={class:"form-group"},Pu={class:"row"},Ru={class:"col-lg-12"},Ou={__name:"dashboard",setup(o){const c=Ge(),v=a(!1),n=a(null),d=a(null),i=a(null),x=a(null),O=a(null),p=a({language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"},responsive:!1,serverSide:!0,processing:!0,searchDelay:800,ajax:{url:G.bookings,dataSrc:"results",data:function(h){return k.value&&(h.arrival=k.value),U.value&&(h.departure=U.value),Y.value!="All"&&(h.campground=Y.value),y.value!="All"&&(h.region=y.value),h.canceled=$.value,h.refund_status=u.value,h}},columnDefs:[{responsivePriority:1,targets:0},{responsivePriority:2,targets:2},{responsivePriority:3,targets:8}],columns:[{data:"campground_name",orderable:!1,searchable:!1},{data:"campground_region",orderable:!1,searchable:!1},{mRender:function(h,T,R){var _=R.firstname?R.firstname:"",V=R.lastname?R.lastname:"",oe=_+" "+V,Z=25,F=oe.length>Z?oe.substring(0,Z-1)+"...":oe,se=oe.length>Z?'class="name_popover"':"",ve="";R.customer_account_phone&&(ve+=R.customer_account_phone+"<BR>"),R.customer_account_mobile!=R.customer_account_phone&&R.customer_account_mobile!=R.customer_booking_phone&&R.customer_account_mobile.length>1&&(ve+=R.customer_account_mobile+"<BR>"),R.customer_booking_phone!=R.customer_account_mobile&&R.customer_booking_phone!=R.customer_account_phone&&R.customer_booking_phone.length>1&&(ve+=R.customer_booking_phone+"<BR>");var be="<td ><div "+se+' tabindex="0" data-toggle="popover" data-placement="top" data-content="__NAME__">'+F+"<BR>"+ve;return be.replace(/__SHNAME__/g,F),be.replace(/__NAME__/g,oe)},orderable:!1,searchable:!1},{data:"id",orderable:!1,searchable:!1,mRender:function(h,T,R){return R.status!="Canceled"?"<a href='/api/get_confirmation/"+R.id+"' target='_blank' class='text-primary'>PB"+h+"</a><br/>":"PB"+R.id}},{data:"campground_site_type",mRender:function(h,T,R){for(var _={},V=[],oe=0;oe<h.length;oe++){if(h[oe].campground_type===0){V.push(h[oe].name);continue}_[h[oe].type]==null&&(_[h[oe].type]=0),_[h[oe].type]+=1}for(var Z in _){var F=_[Z],se=Z.split(":",1)[0];V.push(`${F}x ${se}`)}if(V.length==1){var ve=15,be=V[0]>ve?V[0].substring(0,ve-1):V[0],Pe='<td> <div class="name_popover" tabindex="0" data-toggle="popover" data-placement="top" data-content="__NAME__" >'+be+"</div></td>";return Pe.replace("__NAME__",V[0])}else if(h.length>1){var Ve=V.join(", "),ve=15,be="Multiple",Pe='<td><span class="name_popover" tabindex="0" data-toggle="popover" data-placement="top" data-content="__NAME__" >'+be+"</span></td>";return Pe.replace("__NAME__",Ve)}return"<td></td>"},orderable:!1,searchable:!1},{data:"status",orderable:!1,searchable:!1,mRender:function(h,T,R){if(h==="Canceled"&&R.cancellation_reason!=null){let _=re.dtPopover(R.cancellation_reason);return`<span>${h}</span><br/><br/>${_}`}return h},createdCell:re.dtPopoverCellFn},{data:"arrival",orderable:!1,searchable:!1,mRender:function(h,T,R){return ce(h).format("DD/MM/YYYY")}},{data:"departure",orderable:!1,searchable:!1,mRender:function(h,T,R){return ce(h).format("DD/MM/YYYY")}},{mRender:function(h,T,R){var _=h==!0?"Open":"Temporarily Closed",V=JSON.stringify(R),oe="",Z="/ledger-toolkit-api/invoice-pdf/"+R.invoice_reference;R.invoice_reference&&""+Z;var F="<td >",se=s("#ledger_ui_url").val();return console.log(se),R.invoices.length>0&&(F+="<a href='"+se+"/ledger/payments/oracle/payments?invoice_no="+R.invoices[0]+"'>Ledger Payments</a><br>",F+="<a href='/booking-history/"+R.id+"'>Booking History</a><br>"),R.editable&&""+R.id+pt(V),""+R.id+pt(V),R.has_history&&(F+="<a href='edit/"+R.id+"' class='text-primary' data-history = '"+pt(V)+"' > View History</a><br/>"),s.each(R.active_invoices,(ve,be)=>{oe+="<a href='/ledger-toolkit-api/invoice-pdf/"+be+"' target='_blank' class='text-primary'><i style='color:red;' class='fa fa-file-pdf-o'></i>&nbsp #"+be+"</a><br/>"}),F+=oe,F+="</td>",F.replace("__Status__",_)},orderable:!1,searchable:!1}]}),D=a(["Campground","Region","Person","Confirmation #"," Camp Site(Type)","Status","From","To","Action"]),b=a(null),P=a(null),t=a([]),M=a(-1),Y=a("All"),y=a("All"),k=a(""),U=a(""),$=a("False"),u=a("All");ge(()=>Y,function(){i.value.vmDataTable.ajax.reload()}),ge(()=>y,function(){i.value.vmDataTable.ajax.reload()}),ge(()=>$,function(){i.value.vmDataTable.ajax.reload()}),ge(()=>u,function(){i.value.vmDataTable.ajax.reload()});const f=Q(function(){return t.value.length>0}),q=Q(function(){return c.getters.regions}),A=Q(function(){return c.getters.campgrounds}),w=function(h){const{value:T,show:R}=h;R?t.value.push(T):t.value.splice(T,1)},m=function(){t.value.push("fetching campgrounds"),A.value.length==0&&c.dispatch("fetchCampgrounds"),t.value.splice("fetching campgrounds",1)},E=function(){q.value.length==0&&c.dispatch("fetchRegions")},B=function(){const h={useCurrent:!1,keepInvalid:!0,display:{buttons:{clear:!0}}},T=s("#booking-date-from");b.value=xe(T,h);const R=s("#booking-date-to");P.value=xe(R,{...h}),i.value.vmDataTable.on("click","a[data-history]",function(_){_.preventDefault();var V=JSON.parse(s(this).attr("data-history"));V.value=V.id,O.value.booking=V,O.value.isModalOpen=!0}),s(n.value).select2({theme:"bootstrap"}).on("select2:select",function(_){var V=s(_.currentTarget);Y.value=V.val()}).on("select2:unselect",function(_){s(_.currentTarget),Y.value="All"}),s(d.value).select2({theme:"bootstrap"}).on("select2:select",function(_){var V=s(_.currentTarget);y.value=V.val()}).on("select2:unselect",function(_){s(_.currentTarget),y.value="All"}),R.on("change.td",function(_){const V=P.value.dates.lastPicked;U.value=V?ne.formatDate(V,"dd/MM/yyyy"):"",i.value.vmDataTable.ajax.reload()}),console.log("Date from: "+k.value),T.on("change.td",function(_){const V=b.value.dates.lastPicked;console.log("dateFromPicker"),console.log(V),k.value=V?ne.formatDate(V,"dd/MM/yyyy"):"",i.value.vmDataTable.ajax.reload(),V&&P.value.updateOptions({restrictions:{minDate:V}})}),re.namePopover(s,i.value.vmDataTable),s(document).on("keydown",function(_){_.ctrlKey&&(_.key=="p"||_.charCode==16||_.charCode==112||_.keyCode==80)&&(_.preventDefault(),Ie.emit("showAlert","printBooking"),_.stopImmediatePropagation())})},te=function(){var h=[];let T={arrival:k.value!=null?k.value:"",departure:U.value!=null?U.value:"",campground:Y.value!="All"?Y.value:"",region:y.value!="All"?y.value:"",canceled:$.value,"search[value]":i.value.vmDataTable.search()};for(var R in T)T.hasOwnProperty(R)&&h.push(encodeURIComponent(R)+"="+encodeURIComponent(T[R]));return h.join("&")},I=function(){v.value=!0,fetch(G.bookings+"?"+te.value()).then(h=>{var T=h.body.results,R=require("json2csv"),_=["Created"],_=[..._,...D.value];_.splice(_.length-1,1),_=[..._,"Adults","Concession","Children","Infants","Regos","Canceled","Cancelation Reason","Cancelation Date","Canceled By"],_.splice(4,0,"Email"),_.splice(5,0,"Phone"),_.splice(9,0,"Booking Total"),_.splice(10,0,"Booking Override Price"),_.splice(11,0,"Override Reason"),_.splice(12,0,"Amount Paid"),_.splice(24,0,"Booking Type");var V={0:"Reception booking",1:"Internet booking",2:"Black booking",3:"Temporary reservation"},oe=[];s.each(T,function(Ze,pe){var ye={};s.each(_,function(Fe,he){switch(Fe){case 0:ye[he]=ce(pe.created).format("DD/MM/YYYY HH:mm:ss");break;case 1:ye[he]=pe.campground_name;break;case 2:ye[he]=pe.campground_region;break;case 3:ye[he]=pe.firstname+" "+pe.lastname;break;case 4:ye[he]=pe.email;break;case 5:ye[he]=pe.phone;break;case 6:ye[he]=pe.id;break;case 7:for(var Ue={},ze=[],J=0;J<pe.campground_site_type.length;J++){if(pe.campground_site_type[J].campground_type===0){ze.push(pe.campground_site_type[J].name);continue}Ue[pe.campground_site_type[J].type]==null&&(Ue[pe.campground_site_type[J].type]=0),Ue[pe.campground_site_type[J].type]+=1}for(var L in Ue){var z=Ue[L],me=L.split(":",1)[0];ze.push(`${z}x ${me}`)}var we=ze.join(", ");ye[he]=we;break;case 8:ye[he]=pe.status;break;case 9:ye[he]=pe.cost_total;break;case 10:pe.override_reason==null?ye[he]="":ye[he]=pe.cost_total-pe.discount;break;case 11:ye[he]=pe.override_reason;break;case 12:ye[he]=pe.amount_paid;break;case 13:ye[he]=ce(pe.arrival).format("DD/MM/YYYY");break;case 14:ye[he]=ce(pe.departure).format("DD/MM/YYYY");break;case 15:ye[he]=pe.guests.adults;break;case 16:ye[he]=pe.guests.concession;break;case 17:ye[he]=pe.guests.children;break;case 18:ye[he]=pe.guests.infants;break;case 19:ye[he]=pe.vehicle_payment_status.map(je=>{var We=Object.keys(je).map(Re=>{if(Re=="Fee"||Re=="original_type")return"avoid";if(Re=="Paid"){if(je[Re]=="Yes")return"Status : Entry Fee Paid";if(je[Re]=="No")return"Status : Unpaid";if(je[Re]=="pass_required")return"Status : Park Pass Required"}else return Re+" : "+je[Re]});return We.filter(Re=>Re!="avoid")}).join(" | ");break;case 20:ye[he]=pe.is_canceled;break;case 21:ye[he]=pe.cancelation_reason;break;case 22:ye[he]=pe.cancelation_time?ce(pe.cancelation_time).format("DD/MM/YYYY HH:mm:ss"):"";break;case 23:ye[he]=pe.canceled_by;break;case 24:typeof V[pe.booking_type]<"u"?ye[he]=V[pe.booking_type]:ye[he]=pe.booking_type;break}}),oe.push(ye)});var Z=R({data:oe,fields:_}),F=document.createElement("a"),se=new Blob([Z],{type:"text/csv"}),ve=ve.value=="All"?"All Campgrounds ":s("#filterCampground")[0].selectedOptions[0].text,be=ve.value=="All"?be.value=="All"?"All Regions":s("#filterRegion")[0].selectedOptions[0].text:"",Pe=k.value?U.value?"From "+k.value+" To "+U.value:"From "+k.value:U.value?" To "+U.value:"",Ve=ve+"_"+be+"_"+Pe+".csv";if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(se,Ve);else{var Je=URL.createObjectURL(se);F.href=Je,F.download=Ve,document.body.appendChild(F),F.click(),setTimeout(function(){document.body.removeChild(F),window.URL.revokeObjectURL(Je)},0)}v.value=!1},h=>{v.value=!1,mt({type:"error",title:"Export Error",text:re.apiVueResourceError(h)})})};return $e(function(){m(),E(),B()}),Lt(()=>{k.value=ce().startOf("day").format("DD/MM/YYYY"),console.log("filterDateFrom.value"),console.log(k.value),ft(()=>{i.value.vmDataTable.ajax.reload()})}),(h,T)=>(C(),S("div",ru,[g(e("div",iu,[e("div",du,[e("div",uu,[e("div",cu,[v.value?(C(),S("button",pu,T[8]||(T[8]=[e("i",{class:"fa fa-circle-o-notch fa-spin","aria-hidden":"true"},null,-1),W(" Exporting to CSV ")]))):(C(),S("button",{key:0,type:"button",class:"btn btn-outline-secondary pull-right",id:"print-btn",onClick:T[0]||(T[0]=R=>I())},T[7]||(T[7]=[e("i",{class:"fa fa-file-excel-o","aria-hidden":"true"},null,-1),W(" Export to CSV ")])))])]),e("div",vu,[e("div",mu,[e("div",fu,[T[11]||(T[11]=e("label",{for:""},"Campground",-1)),g(e("select",_u,T[9]||(T[9]=[e("option",{value:""},"Loading...",-1)]),512),[[ae,f.value]]),f.value?fe("",!0):g((C(),S("select",{key:0,ref_key:"campgroundSelector",ref:n,class:"form-control","onUpdate:modelValue":T[1]||(T[1]=R=>Y.value=R),id:"filterCampground"},[T[10]||(T[10]=e("option",{value:"All"},"All",-1)),(C(!0),S(ie,null,de(A.value,R=>(C(),S("option",{value:R.id},H(R.name),9,gu))),256))],512)),[[ke,Y.value]])])]),e("div",hu,[e("div",yu,[T[14]||(T[14]=e("label",{for:""},"Region",-1)),g(e("select",bu,T[12]||(T[12]=[e("option",{value:""},"Loading...",-1)]),512),[[ae,f.value]]),f.value?fe("",!0):g((C(),S("select",{key:0,ref_key:"regionSelector",ref:d,class:"form-control","onUpdate:modelValue":T[2]||(T[2]=R=>y.value=R),id:"filterRegion"},[T[13]||(T[13]=e("option",{value:"All"},"All",-1)),(C(!0),S(ie,null,de(q.value,R=>(C(),S("option",{value:R.id},H(R.name),9,ku))),256))],512)),[[ke,y.value]])])]),e("div",$u,[e("div",Cu,[T[16]||(T[16]=e("label",{for:""},"Cancelled",-1)),g(e("select",{class:"form-control","onUpdate:modelValue":T[3]||(T[3]=R=>$.value=R),id:"filterCanceled"},T[15]||(T[15]=[e("option",{value:"True"},"Yes",-1),e("option",{value:"False"},"No",-1)]),512),[[ke,$.value]])])])]),e("div",wu,[e("div",xu,[T[18]||(T[18]=e("label",{for:""},"Date From",-1)),e("div",Du,[g(e("input",{type:"text",class:"form-control",placeholder:"DD/MM/YYYY","onUpdate:modelValue":T[4]||(T[4]=R=>k.value=R)},null,512),[[X,k.value]]),T[17]||(T[17]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])]),e("div",Tu,[T[20]||(T[20]=e("label",{for:""},"Date To",-1)),e("div",Su,[g(e("input",{type:"text",class:"form-control",placeholder:"DD/MM/YYYY","onUpdate:modelValue":T[5]||(T[5]=R=>U.value=R)},null,512),[[X,U.value]]),T[19]||(T[19]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])]),$.value=="True"?(C(),S("div",Mu,[e("div",Eu,[T[22]||(T[22]=e("label",{for:""},"Refund Status",-1)),g(e("select",{class:"form-control","onUpdate:modelValue":T[6]||(T[6]=R=>u.value=R),id:"filterRefundStatus"},T[21]||(T[21]=[e("option",{value:"All"},"All",-1),e("option",{value:"Refunded"},"Refunded",-1),e("option",{value:"Partially Refunded"},"Partially Refunded",-1),e("option",{value:"Not Refunded"},"Not Refunded",-1)]),512),[[ke,u.value]])])])):fe("",!0)]),e("div",Pu,[e("div",Ru,[ee(Xe,{ref_key:"bookings_table",ref:i,id:"bookings-table",dtOptions:p.value,dtHeaders:D.value},null,8,["dtOptions","dtHeaders"])])])]),ee(Yd,{ref_key:"changebooking",ref:x,booking_id:M.value,campgrounds:A.value,onLoadingCallback:w},null,8,["booking_id","campgrounds"]),ee(nu,{ref_key:"bookingHistory",ref:O,booking_id:M.value},null,8,["booking_id"])],512),[[ae,!f.value]]),ee(He,{isLoading:f.value},{default:ue(()=>[W(H(t.value.join(" , ")),1)]),_:1},8,["isLoading"])]))}},Yu={id:"addBooking"},Uu={name:"bookingForm"},Au={class:"row"},Vu={class:"col-lg-12"},qu={class:"well"},Fu={class:"row"},ju={class:"col-md-12"},Iu={class:"col-md-6"},Hu={class:"text-primary pull-left"},Lu={class:"col-md-12"},Nu=["href"],Bu={key:0,class:"col-md-12"},Gu={class:"row"},Ju={class:"col-md-12"},zu={class:"form-group"},Xu={class:"col-md-12"},Wu={class:"col-md-4"},Ku={class:"form-group"},Qu={class:"col-md-8"},Zu={class:"dropdown guests"},ec={class:"dropdown-menu","aria-labelledby":"dropdownMenu1"},tc={class:"row"},sc={class:"col-sm-4"},oc={class:"item"},ac={style:{color:"#888","font-weight":"300","font-size":"12px"}},lc={class:"pull-right"},nc={class:"btn-group btn-group-sm"},rc=["onClick"],ic=["onClick"],dc={class:"row"},uc={class:"col-lg-12"},cc={key:0,id:"campsite-booking"},pc={class:"col-lg-12 text-center"},vc={class:"row"},mc={class:"col-sm-12"},fc={class:"column table-scroll"},_c={class:"hover table table-striped table-bordered dt-responsive nowrap",cellspacing:"0",width:"100%",name:"campsite"},gc=["disabled"],hc={class:"form-group"},yc={class:"form-group"},bc=["value","disabled"],kc={class:"row"},$c={class:"col-lg-12"},Cc={key:0,id:"campsite-class-booking"},wc={class:"row"},xc={class:"col-lg-12 text-center"},Dc={class:"row"},Tc={class:"col-sm-12"},Sc={class:"column table-scroll"},Mc={class:"hover table table-striped table-bordered dt-responsive nowrap",cellspacing:"0",width:"100%",name:"campsite-type"},Ec={class:"site"},Pc={class:"site"},Rc={class:"book"},Oc={class:"numBook"},Yc=["max","onUpdate:modelValue","onChange"],Uc={class:"row"},Ac={class:"col-lg-12"},Vc={class:"well"},qc={class:"row"},Fc={class:"col-lg-6"},jc={class:"row"},Ic={class:"col-md-12"},Hc={class:"form-group"},Lc={id:"matched_emails"},Nc=["value"],Bc={class:"col-md-6"},Gc={class:"row"},Jc={class:"col-md-6"},zc={class:"form-group"},Xc={class:"col-md-6"},Wc={class:"form-group"},Kc={class:"row"},Qc={class:"col-md-6"},Zc={class:"form-group"},ep={class:"col-md-6"},tp={class:"form-group"},sp=["value"],op={class:"row"},ap={class:"col-md-6"},lp={class:"form-group"},np={class:"col-lg-6"},rp={class:"row"},ip={class:"col-lg-12"},dp={key:0,class:"text-primary"},up={key:1,class:"text-primary"},cp={class:"row"},pp={class:"col-md-12"},vp={class:"form-group"},mp={class:"dropdown guests"},fp={class:"dropdown-menu","aria-labelledby":"dropdownMenu1"},_p={class:"row"},gp={class:"col-sm-8"},hp={class:"item"},yp={class:"pull-right"},bp={class:"btn-group btn-group-sm"},kp=["onClick"],$p=["onClick"],Cp={class:"row"},wp={class:"col-md-6"},xp={class:"form-group"},Dp={class:"required"},Tp=["name","onUpdate:modelValue"],Sp={class:"col-md-6"},Mp={key:0,class:"form-group"},Ep=["onUpdate:modelValue"],Pp={key:0},Rp={class:"row"},Op={class:"col-lg-12"},Yp={class:"well"},Up={class:"row"},Ap={class:"col-lg-6"},Vp={class:"row"},qp={class:"col-lg-12"},Fp={class:"form-group"},jp={class:"input-group"},Ip=["placeholder","value"],Hp={class:"row"},Lp={class:"col-lg-12"},Np={class:"form-group"},Bp={key:0,class:"input-group"},Gp=["placeholder"],Jp={class:"row"},zp={class:"col-lg-12"},Xp={key:0,class:"form-group"},Wp={key:1,class:"form-group"},Kp={class:"row"},Qp={class:"col-lg-12"},Zp={class:"form-group"},ev={class:"col-lg-6"},tv={class:"row"},sv={class:"col-lg-12"},ov={slot:"footer"},av={__name:"addbooking",setup(o){const c=Ne(),v=lt(),n=Ge(),d=a(!1),i=a(!1),x=a(null),O=a([]),p=a(""),D=a(""),b=a(""),P=a(null),t=a({arrival:"",departure:"",guests:{adult:2,concession:0,child:0,infant:0},campground:"",campsites:[],campsite_classes:[],email:"",firstname:"",surname:"",postcode:"",country:"AU",phone:"",vehicle:"",price:"0",override_price:"0",override_reason:"",override_reason_info:"",send_invoice:!0,parkEntry:{vehicles:0},entryFees:{vehicles:0,motorbike:0,concession:0,entry_fee:0,regos:[]}}),M=a([]),Y=a({}),y=a(""),k=a([{id:"adult",name:"Adults (no concession)",amount:2,description:""},{id:"concession",name:"Concession",amount:0,description:"",helpText:"accepted concession cards"},{id:"child",name:"Children",amount:0,description:"Ages 6-16"},{id:"infant",name:"Infants",amount:0,description:"Ages 0-5"}]),U=a([{id:"vehicle",name:"Vehicle",amount:0,price:0,description:"Vehicle Registration",rego:"",entry_fee:!0},{id:"concession",name:"Concession",amount:0,price:0,description:"Concession Vehicle Registration",helpText:"accepted concession cards",rego:"",entry_fee:!0},{id:"motorbike",name:"Motorbike",amount:0,price:0,description:"Motorbike Registration",rego:"",entry_fee:!0}]),$=a([]),u=a([]),f=a({entry_fee_required:!1,entry_fee:0}),q=a([]),A=a({id:null,period_start:null,period_end:null,reason:1,details:"other",vehicle:"0.00",concession:"0.00",motorbike:"0.00",editable:!1}),w=a([]),m=a({}),E=a({}),B=a(-1),te=a("campsite"),I=a({CAMPSITE:"campsite",CLASS:"class"}),h=a([]),T=Q(function(){return M.value.length>0});Q(function(){var r=t.value.parkEntry.vehicles<=10?t.value.parkEntry.vehicles:10;return t.value.parkEntry.vehicles=r,r});const R=Q({get:function(){return t.value.campsites?h.value.length==t.value.campsites.length:!1},set:function(r){var l=[];r&&t.value.campsites.forEach(function(K){l.push(K.id)}),h.value=l,F()}}),_=Q(function(){var r=[];return te.value==I.value.CAMPSITE?r=h.value:t.value.campsite_classes.forEach(function(l){for(var K=0;K<l.selected_campsite_class;K++)r.push(l.campsites[K])}),r}),V=Q(function(){var r=[];return t.value.campsites.forEach(function(l){r.push(l.status)}),r.find(function(l,K){if(l=="booked"||l=="closed & booked")return!0})});ge(()=>p,function(r){F()}),ge(()=>B,function(r){p.value=t.value.campsite_classes[r].campsites[0]}),ge(()=>D,function(r){t.value.arrival&&s.each(w.value,function(l,K){const N={start:ne.parseDate(K.range_start,"dd/MM/yyyy",new Date),end:ne.parseDate(K.range_end,"dd/MM/yyyy",new Date)},Ce=ne.parseDate(t.value.arrival,"yyyy-MM-dd",new Date);ne.isWithinInterval(arrival,N)&&(console.log("updating departure date Options"),E.value.updateOptions({restrictions:{maxDate:ne.addDays(Ce,K.max_days)}}),E.value.clear())}),oe(),F()}),ge(()=>b,function(r){oe(),F()}),ge(()=>te,function(r){oe()});const oe=function(){te.value==I.value.CAMPSITE&&ve(),te.value==I.value.CLASS&&be()},Z=function(r){_t.isNotEmpty(r.target)},F=function(){t.value.price=0;var r=_.value;if(p.value&&t.value.arrival&&t.value.departure){var l=ce(t.value.arrival,"YYYY-MM-DD"),K=ce(t.value.departure,"YYYY-MM-DD");K.diff(l,"days"),fetch(G.campsites_current_price(),{method:"POST",body:{campsites:r,arrival:l.format("YYYY-MM-DD"),departure:K.format("YYYY-MM-DD")},headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(N=>{P.value=null,P.value=N.body,he()}).catch(N=>{console.log(N)})}},se=function(){M.value.push("fetching countries"),fetch(G.countries).then(r=>{O.value=r.body,M.value.splice("fetching countries",1)}).catch(r=>{console.log(r),M.value.splice("fetching countries",1)})},ve=function(){D.value&&b.value&&(M.value.push("fetching campsites"),fetch(G.available_campsites(t.value.campground,ce(t.value.arrival,"YYYY-MM-DD").format("YYYY/MM/DD"),ce(t.value.departure,"YYYY-MM-DD").format("YYYY/MM/DD"))).then(r=>{t.value.campsites=r.body,t.value.campsites.length>0&&(p.value=t.value.campsites[0].id),M.value.splice("fetching campsites",1)}).catch(r=>{console.log(r),M.value.splice("fetching campsites",1)}))},be=function(){D.value&&b.value&&(M.value.push("fetching campsite classes"),fetch(G.available_campsite_classes(t.value.campground,ce(t.value.arrival,"YYYY-MM-DD").format("YYYY/MM/DD"),ce(t.value.departure,"YYYY-MM-DD").format("YYYY/MM/DD"))).then(r=>{t.value.campsite_classes=r.body,t.value.campsite_classes.length>0&&(p.value=t.value.campsite_classes[0].campsites[0],B.value=0),M.value.splice("fetching campsite classes",1)}).catch(r=>{console.log(r),M.value.splice("fetching campsite classes",1)}))},Pe=function(){M.value.push("fetching campground");var r=v.params.cg;fetch(G.campground(r)).then(l=>{Y.value=l.body,t.value.campground=Y.value.id,te.value=Y.value.site_type==0?I.value.CAMPSITE:I.value.CLASS,Ve(),ve(),Je(),Ze(),M.value.splice("fetching campground",1)}).catch(l=>{console.log(l),M.value.splice("fetching campground",1)})},Ve=function(){M.value.push("fetching stay history"),fetch(G.campgroundStayHistory(Y.value.id)).then(r=>{r.body.length>0&&(w.value=r.body),M.value.splice("fetching stay history",1)}).catch(r=>{console.log(r),M.value.splice("fetching stay history",1)})},Je=function(){M.value.push("fetching park"),fetch(G.park(Y.value.park)).then(r=>{f.value=r.body,M.value.splice("fetching park",1)}).catch(r=>{console.log(r),M.value.splice("fetching park",1)})},Ze=function(){const r=new Be().startOf("date");D.value=r,t.value.arrival=r;const l=s(x.value.arrival).closest(".date"),K=s(x.value.departure).closest(".date");m.value=xe(l,{defaultDate:r,restrictions:{minDate:new r}}),E.value=xe(K,{useCurrent:!1}),l.on("change.td",function(N){t.value.arrival=ne.formatDate(m.value.dates.lastPicked,"yyyy-MM-dd"),D.value=t.value.arrival,b.value="",t.value.departure="";var Ce=N.date.clone(),Me=Ce.clone().add(1,"days"),st=Me.clone().add(180,"days");E.value.clear(),E.value.updateOptions({restrictions:{minDate:Me,maxDate:st}})}),K.on("change.td",function(N){E.value.dates.lastPicked?(t.value.departure=ne.formatDate(E.value.dates.lastPicked,"yyyy-MM-dd"),b.value=t.value.departure):(t.value.departure=null,b.value=t.value.departure)}),fetch(G.campgroundCampsites(Y.value.id)).then(N=>{var Ce=N.body;fetch(G.campsite_current_price(Ce[0].id,ce().format("YYYY-MM-DD"),ce().add(1,"days").format("YYYY-MM-DD"))).then(Me=>{P.value=null,P.value=Me.body,M.value.splice("updating prices",1)}).catch(Me=>{console.log(Me),M.value.splice("updating prices",1)})},N=>{console.log(N)})},pe=function(r){switch(r.amount+=1,r.id){case"adult":t.value.guests.adult=r.amount;break;case"concession":t.value.guests.concession=r.amount;break;case"child":t.value.guests.child=r.amount;break;case"infant":t.value.guests.infant=r.amount;break}Fe()},ye=function(r){switch(r.amount=r.amount>0?r.amount-1:0,r.id){case"adult":t.value.guests.adult=r.amount;break;case"concession":t.value.guests.concession=r.amount;break;case"child":t.value.guests.child=r.amount;break;case"infant":t.value.guests.infant=r.amount;break}Fe()},Fe=function(){var r="";s.each(k,function(l,K){l!=k.length-1?K.amount>0&&(r+=K.amount+" "+K.name+",  "):K.amount>0&&(r+=K.amount+" "+K.name+" ")}),y.value=r.replace(/,\s*$/,""),he()},he=function(){t.value.price=0,f.value.entry_fee_required?J(function(){s.each(P.value,function(r,l){for(var K in t.value.guests)t.value.guests.hasOwnProperty(K)&&(t.value.price+=t.value.guests[K]*l.rate[K])}),Ue(),t.value.price=t.value.price+t.value.entryFees.entry_fee}):s.each(P.value,function(r,l){for(var K in t.value.guests)t.value.guests.hasOwnProperty(K)&&(t.value.price+=t.value.guests[K]*l.rate[K])})},Ue=function(){t.value.entryFees.entry_fee=0,p.value&&t.value.arrival&&t.value.departure&&s.each(q.value,function(r,l){if(l=JSON.parse(JSON.stringify(l)),A.value&&l.entry_fee)switch(l.id){case"vehicle":t.value.entryFees.entry_fee+=parseInt(A.value.vehicle),t.value.entryFees.vehicle++;break;case"motorbike":t.value.entryFees.entry_fee+=parseInt(A.value.motorbike),t.value.entryFees.motorbike++;break;case"concession":t.value.entryFees.entry_fee+=parseInt(A.value.concession),t.value.entryFees.concession++;break}})},ze=xt(function(r){fetch(G.usersLookup(t.value.email)).then(l=>{$.value=l.body,u.value=[],s.each($.value,function(K,N){u.value.push(N.email)}),L()})},1e3),J=function(r){t.value.arrival?fetch(G.park_current_price(f.value.id,t.value.arrival)).then(l=>{var K=l.body;K.constructor!=Array?A.value=l.body:(A.value.vehicle="0.00",A.value.motorbike="0.00",A.value.concession="0.00"),r()}):(A.value.vehicle="0.00",A.value.motorbike="0.00",A.value.concession="0.00",r())},L=function(r){s.each($.value,function(l,K){if(K.email==t.value.email)return t.value.firstname=K.first_name,t.value.surname=K.last_name,t.value.phone=K.mobile_number,K.profile_addresses[0]&&(t.value.postcode=K.profile_addresses[0].postcode,t.value.country=K.profile_addresses[0].country),!1})},z=function(){we()&&(M.value.push("processing booking"),t.value.entryFees={vehicle:0,motorbike:0,concession:0,entry_fee:0,regos:[]},s.each(q.value,function(r,l){switch(l=JSON.parse(JSON.stringify(l)),(l.rego!=null||l.rego!="null")&&t.value.entryFees.regos.push({type:l.id,rego:l.rego,entry_fee:l.entry_fee}),l.id){case"vehicle":t.value.entryFees.entry_fee+=parseInt(A.value.vehicle),t.value.entryFees.vehicle++;break;case"motorbike":t.value.entryFees.entry_fee+=parseInt(A.value.motorbike),t.value.entryFees.motorbike++;break;case"concession":t.value.entryFees.entry_fee+=parseInt(A.value.concession),t.value.entryFees.concession++;break}}),t.value.arrival,t.value.departure,t.value.guests,_.value,P.value,A.value,t.value.price,t.value.override_price,t.value.override_reason,t.value.override_reason_info,t.value.send_invoice,t.value.email,t.value.firstname,t.value.surname,t.value.phone,t.value.country,t.value.postcode,t.value.entryFees.regos,n.dispatch("updateAlert",{visible:!1,type:"danger",message:""}),fetch(G.bookings,{method:"POST",body:t,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(r=>{M.value.splice("processing booking",1);var l=s("#invoice_frame");l[0].src="/ledger/payments/invoice/"+r.body.invoices[0],i.value=!1,c.push({name:"booking-dashboard"})}).catch(r=>{let l=re.apiVueResourceError(r);n.dispatch("updateAlert",{visible:!0,type:"danger",message:l}),M.value.splice("processing booking",1)}))},me=function(){i.value=!1,c.push({name:"booking-dashboard"})},we=function(){return s(x.value).valid()},je=function(r){var l=q.value.filter(function(K){return K.rego==r.value});return l.length<=1},We=function(){return!(d&&t.value.override_price!=null&&t.value.override_reason=="")},Re=function(r){r.selected_campsite_class=Math.max(0,Math.min(r.selected_campsite_class,r.campsites.length)),F()},tt=function(){for(var r={rules:{arrival:"required",departure:"required",guests:"required",campsite:"required",email:{required:!0,email:!0},firstname:"required",surname:"required",phone:"required",postcode:"required",country:"required",price_level:"required",open_reason:"required",overrideReason:{required:{depends:function(N){return We()}}}},messages:{firstname:"Fill in all details"},showErrors:function(N,Ce){s.each(this.validElements(),function(gt,ct){var Pt=s(ct);Pt.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var Me=0;Me<Ce.length;Me++){var st=Ce[Me];s(st.element).tooltip({trigger:"focus"}).attr("data-original-title",st.message).parents(".form-group").addClass("has-error")}}},l=0;l<t.value.parkEntry.vehicles;l++)r.rules["vehicleRego_"+l]={required:!0,noDuplicateRego:!0},r.messages["vehicleRego_"+l]={required:"Fill in vehicle details",noDuplicateRego:"Duplicate regos not permitted.If unknown add number, e.g. Hire1, Hire2"};var K=s(x.value);K.data("validator",null),s.validator.addMethod("noDuplicateRego",function(N,Ce){return je(Ce)}),K.validate(r)},ut=function(r){var l=t.value.parkEntry.vehicles;if(r.amount<10&&l<10){r.amount=r.amount<10?r.amount+=1:r.amount,t.value.parkEntry.vehicles++;var K=JSON.parse(JSON.stringify(r));entry_fee_required.value||(K.entry_fee=!1),q.value.push(K)}t.value.price=t.value.price-t.value.entryFees.entry_fee,Ue(),t.value.price=t.value.price+t.value.entryFees.entry_fee,tt()},j=function(r){var l=t.value.parkEntry.vehicles;if(r.amount>0&&l>0)for(var K=!1,N=r.amount-1;N>=0;N--){for(var Ce=q.value.length-1;Ce>=0;Ce--)if(r.description==q.value[Ce].description){r.amount=r.amount>0?r.amount-=1:r.amount,q.value.splice(Ce,1),t.value.parkEntry.vehicles--,K=!0;break}if(K)break}t.value.price=t.value.price-t.value.entryFees.entry_fee,Ue(),t.value.price=t.value.price+t.value.entryFees.entry_fee,tt()};return $e(function(){x.value=document.forms.bookingForm,Pe(),se(),Fe(),tt()}),(r,l)=>{const K=nt("router-link");return C(),S("div",Yu,[g(e("form",Uu,[e("div",Au,[e("div",Vu,[e("div",qu,[e("div",Fu,[e("div",ju,[e("div",Iu,[e("h3",Hu,"Add internal booking for "+H(Y.value.name),1)])]),e("div",Lu,[e("p",null,[l[21]||(l[21]=W("Internal bookings can be made for campsites closed to public bookings.")),e("a",{target:"_blank",href:"/availability_admin/?site_id="+Y.value.id}," Check closures",8,Nu),l[22]||(l[22]=W(" before adding a closed site to a booking."))])]),Y.value.site_type==1||Y.value.site_type==2?(C(),S("div",Bu,[e("p",null,[l[24]||(l[24]=W("To book closed sites, you must allocate specific site numbers/names - switch to the ")),ee(K,{to:{name:"booking-close-classes"}},{default:ue(()=>l[23]||(l[23]=[W("full camp site list.")])),_:1}),l[25]||(l[25]=W(" The allocated site number/name is for management purposes only - it will not be visible to the public."))])])):fe("",!0),e("div",Gu,[e("div",Ju,[e("div",zu,[e("div",Xu,[l[30]||(l[30]=Qe('<label class="control-label pull-left required" for="Dates">Dates: </label><div class="col-md-3"><div class="input-group date" id="dateArrival"><input type="text" class="form-control" name="arrival" placeholder="Arrival"><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div><div class="col-md-3"><div class="input-group date" id="datedeparture"><input type="text" class="form-control" name="departure" placeholder="Departure"><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div>',3)),e("div",Wu,[e("div",Ku,[l[29]||(l[29]=e("label",{class:"control-label pull-left required",for:"Campground"},"Guests: ",-1)),e("div",Qu,[e("div",Zu,[g(e("input",{type:"text",class:"form-control dropdown-toggle",name:"guests",placeholder:"Guests","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true","onUpdate:modelValue":l[0]||(l[0]=N=>y.value=N)},null,512),[[X,y.value]]),e("ul",ec,[(C(!0),S(ie,null,de(k.value,N=>(C(),S("li",null,[e("div",tc,[e("div",sc,[e("span",oc,[W(H(N.amount)+" "+H(N.name)+" ",1),e("span",ac,H(N.description),1)]),l[26]||(l[26]=e("br",null,null,-1)),g(e("a",{href:"#",class:"text-info"},H(N.helpText),513),[[ae,N.helpText]])]),e("div",lc,[e("div",nc,[e("button",{type:"button",class:"btn btn-guest",onClick:_e(Ce=>pe(N),["prevent","stop"])},l[27]||(l[27]=[e("span",{class:"glyphicon glyphicon-plus"},null,-1)]),8,rc),e("button",{type:"button",class:"btn btn-guest",onClick:_e(Ce=>ye(N),["prevent","stop"])},l[28]||(l[28]=[e("span",{class:"glyphicon glyphicon-minus"},null,-1)]),8,ic)])])])]))),256))])])])])])])])])]),e("div",dc,[e("div",uc,[Y.value.site_type==0?(C(),S("div",cc,[g(e("div",pc,l[31]||(l[31]=[e("h2",null,"No Campsites Available For The Provided Dates",-1)]),512),[[ae,t.value.campsites.length<1]])])):fe("",!0)])]),e("div",vc,[e("div",mc,[g(e("div",null,[e("div",fc,[e("table",_c,[e("thead",null,[e("tr",null,[l[33]||(l[33]=e("th",{class:"form-group"},"Campsite",-1)),l[34]||(l[34]=e("th",{class:"form-group"},"Status",-1)),e("th",null,[l[32]||(l[32]=W("Sites to book ")),g(e("input",{class:"checkbox",type:"checkbox",id:"selectAll","onUpdate:modelValue":l[1]||(l[1]=N=>R.value=N),disabled:V.value},null,8,gc),[[Te,R.value]])])])]),e("tbody",null,[(C(!0),S(ie,null,de(t.value.campsites,N=>(C(),S("tr",null,[e("td",hc,H(N.name)+" - "+H(N.type),1),e("td",yc,H(N.status),1),e("td",null,[g(e("input",{class:"checkbox",type:"checkbox",value:N.id,disabled:N.status=="booked"||N.status=="closed & booked","onUpdate:modelValue":l[2]||(l[2]=Ce=>h.value=Ce),onChange:l[3]||(l[3]=Ce=>F()),number:""},null,40,bc),[[Te,h.value]])])]))),256))])])])],512),[[ae,t.value.campsites.length>0]])])]),e("div",kc,[e("div",$c,[Y.value.site_type==1||Y.value.site_type==2?(C(),S("div",Cc,[e("div",wc,[g(e("div",xc,l[35]||(l[35]=[e("h2",null,"No Campsites Available For The Provided Dates",-1)]),512),[[ae,t.value.campsite_classes.length<1]])])])):fe("",!0)])]),e("div",Dc,[e("div",Tc,[g(e("div",null,[e("div",Sc,[e("table",Mc,[l[36]||(l[36]=e("thead",null,[e("tr",null,[e("th",{class:"site"},"Campsite"),e("th",{class:"form-group"},"Status"),e("th",{class:"book"},"Availability"),e("th",{class:"numBook"},"Number of sites to book")])],-1)),e("tbody",null,[(C(!0),S(ie,null,de(t.value.campsite_classes,N=>(C(),S("tr",null,[e("td",Ec,H(N.name),1),e("td",Pc,H(N.status),1),e("td",Rc,H(N.campsites.length)+" available ",1),e("td",Oc,[g(e("input",{type:"number",id:"numberRange",min:"0",max:N.campsites.length,class:"form-control","onUpdate:modelValue":Ce=>N.selected_campsite_class=Ce,onChange:Ce=>Re(N)},null,40,Yc),[[X,N.selected_campsite_class]])])]))),256))])])])],512),[[ae,t.value.campsite_classes.length>0]])])])])])])]),e("div",Uc,[e("div",Ac,[e("div",Vc,[e("div",qc,[e("div",Fc,[l[44]||(l[44]=e("div",{class:"row"},[e("div",{class:"col-lg-12"},[e("h3",{class:"text-primary"},"Personal Details")])],-1)),e("div",jc,[e("div",Ic,[e("div",Hc,[l[37]||(l[37]=e("label",{for:"Email",class:"required"},"Email",-1)),g(e("input",{type:"text",name:"email",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=N=>t.value.email=N),list:"matched_emails",onKeyup:l[5]||(l[5]=N=>De(ze)())},null,544),[[X,t.value.email]]),e("datalist",Lc,[u.value?(C(!0),S(ie,{key:0},de(u.value,N=>(C(),S("option",{value:N},null,8,Nc))),256)):fe("",!0)])])]),g(e("div",Bc,l[38]||(l[38]=[e("div",{class:"form-group"},[e("label",{for:"Confirm Email",class:"required"},"Confirm Email"),e("input",{type:"text",name:"confirm_email",class:"form-control"})],-1)]),512),[[ae,!1]])]),e("div",Gc,[e("div",Jc,[e("div",zc,[l[39]||(l[39]=e("label",{for:"First Name",class:"required"},"First Name",-1)),g(e("input",{type:"text",name:"firstname",class:"form-control","onUpdate:modelValue":l[6]||(l[6]=N=>t.value.firstname=N)},null,512),[[X,t.value.firstname]])])]),e("div",Xc,[e("div",Wc,[l[40]||(l[40]=e("label",{for:"Surname",class:"required"},"Surname",-1)),g(e("input",{type:"text",name:"surname",class:"form-control","onUpdate:modelValue":l[7]||(l[7]=N=>t.value.surname=N)},null,512),[[X,t.value.surname]])])])]),e("div",Kc,[e("div",Qc,[e("div",Zc,[l[41]||(l[41]=e("label",{for:"Postcode",class:"required"},"Postcode",-1)),g(e("input",{type:"text",name:"postcode",class:"form-control","onUpdate:modelValue":l[8]||(l[8]=N=>t.value.postcode=N)},null,512),[[X,t.value.postcode]])])]),e("div",ep,[e("div",tp,[l[42]||(l[42]=e("label",{for:"Country",class:"required"},"Country",-1)),g(e("select",{class:"form-control",name:"country","onUpdate:modelValue":l[9]||(l[9]=N=>t.value.country=N)},[(C(!0),S(ie,null,de(O.value,N=>(C(),S("option",{value:N.iso_3166_1_a2},H(N.printable_name),9,sp))),256))],512),[[ke,t.value.country]])])])]),e("div",op,[e("div",ap,[e("div",lp,[l[43]||(l[43]=e("label",{for:"Phone",class:"required"},[W("Phone "),e("span",{class:"text-muted"},"(mobile prefered)")],-1)),g(e("input",{type:"text",name:"phone",class:"form-control","onUpdate:modelValue":l[10]||(l[10]=N=>t.value.phone=N)},null,512),[[X,t.value.phone]])])])])]),e("div",np,[e("div",rp,[e("div",ip,[f.value.entry_fee_required?(C(),S("h3",dp,[l[45]||(l[45]=W("Park Entry Fees ")),e("small",null,"($"+H(r.$filters.formatMoney(A.value.vehicle,2))+"/per vehicle)",1)])):(C(),S("h3",up,"Vehicle Details"))])]),e("div",cp,[e("div",pp,[e("div",vp,[l[50]||(l[50]=e("label",{for:"vehicles",class:"required"},"Number of Vehicles",-1)),e("div",mp,[g(e("input",{type:"number",min:"0",max:"10",name:"vehicles",class:"form-control dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",readonly:"true","onUpdate:modelValue":l[11]||(l[11]=N=>t.value.parkEntry.vehicles=N)},null,512),[[X,t.value.parkEntry.vehicles]]),e("ul",fp,[(C(!0),S(ie,null,de(U.value,N=>(C(),S("li",null,[e("div",_p,[e("div",gp,[e("span",hp,[W(H(N.amount)+" "+H(N.name)+" ",1),l[46]||(l[46]=e("span",{style:{color:"#888","font-weight":"300","font-size":"12px"}},null,-1))]),l[47]||(l[47]=e("br",null,null,-1)),g(e("a",{href:"#",class:"text-info"},H(N.helpText),513),[[ae,N.helpText]])]),e("div",yp,[e("div",bp,[e("button",{type:"button",class:"btn btn-guest",onClick:_e(Ce=>ut(N),["prevent","stop"])},l[48]||(l[48]=[e("span",{class:"glyphicon glyphicon-plus"},null,-1)]),8,kp),e("button",{type:"button",class:"btn btn-guest",onClick:_e(Ce=>j(N),["prevent","stop"])},l[49]||(l[49]=[e("span",{class:"glyphicon glyphicon-minus"},null,-1)]),8,$p)])])])]))),256))])])])])]),(C(!0),S(ie,null,de(q.value,(N,Ce)=>(C(),S("div",Cp,[e("div",wp,[e("div",xp,[e("label",Dp,H(N.description),1),g(e("input",{type:"text",class:"form-control",name:"vehicleRego_"+Ce,required:"required","onUpdate:modelValue":Me=>N.rego=Me,onChange:Z},null,40,Tp),[[X,N.rego]])])]),e("div",Sp,[f.value.entry_fee_required?(C(),S("div",Mp,[l[51]||(l[51]=e("label",null,"Entry fee",-1)),g(e("input",{type:"checkbox",class:"form-control","onUpdate:modelValue":Me=>N.entry_fee=Me,onChange:l[12]||(l[12]=Me=>F())},null,40,Ep),[[Te,N.entry_fee]])])):fe("",!0)])]))),256)),f.value.entry_fee_required?(C(),S("p",Pp,l[52]||(l[52]=[e("b",null,"NOTE:",-1),W(" A vehicle entry fee is not required for the holder of a valid Park Pass.")]))):fe("",!0)])])])])]),e("div",Rp,[e("div",Op,[e("div",Yp,[e("div",Up,[e("div",Ap,[e("div",Vp,[e("div",qp,[e("div",Fp,[l[54]||(l[54]=e("label",{for:"Total Price"},[W("Total Price "),e("span",{class:"text-muted"},"(GST inclusive.)")],-1)),e("div",jp,[l[53]||(l[53]=e("span",{class:"input-group-addon"},[W("AUD "),e("i",{class:"fa fa-usd"})],-1)),e("input",{type:"text",class:"form-control",placeholder:r.$filters.formatMoney(0,2),value:r.$filters.formatMoney(t.value.price,2),readonly:"true"},null,8,Ip)])])])]),e("div",Hp,[e("div",Lp,[e("div",Np,[g(e("input",{type:"checkbox",name:"overrideCharge",class:"form control","onUpdate:modelValue":l[13]||(l[13]=N=>d.value=N)},null,512),[[Te,d.value]]),l[56]||(l[56]=e("label",{for:"OverrideCharge"},"Override price charged ",-1)),d.value?(C(),S("div",Bp,[l[55]||(l[55]=e("span",{class:"input-group-addon"},[W("AUD "),e("i",{class:"fa fa-usd"})],-1)),g(e("input",{type:"text",class:"form-control",name:"overridePrice",placeholder:r.$filters.formatMoney(0,2),"onUpdate:modelValue":l[14]||(l[14]=N=>t.value.override_price=N)},null,8,Gp),[[X,t.value.override_price]])])):fe("",!0)])])]),e("div",Jp,[e("div",zp,[d.value?(C(),S("div",Xp,[ee(qe,{type:"discount",name:"overrideReason",modelValue:t.value.override_reason,"onUpdate:modelValue":l[15]||(l[15]=N=>t.value.override_reason=N),required:d.value},null,8,["modelValue","required"])])):fe("",!0),d.value?(C(),S("div",Wp,[l[57]||(l[57]=e("label",{class:"control-label"},"Override reason detail:",-1)),g(e("textarea",{id:"reason_details",class:"form-control","onUpdate:modelValue":l[16]||(l[16]=N=>t.value.override_reason_info=N)},null,512),[[X,t.value.override_reason_info]])])):fe("",!0)])]),e("div",Kp,[e("div",Qp,[e("div",Zp,[g(e("input",{type:"checkbox",name:"sendInvoice",class:"form control",id:"send_invoice","onUpdate:modelValue":l[17]||(l[17]=N=>t.value.send_invoice=N)},null,512),[[Te,t.value.send_invoice]]),l[58]||(l[58]=e("label",{for:"sendInvoice"},[e("u",null,"Don't"),W(" send invoice upon booking")],-1))])])])]),l[59]||(l[59]=e("div",{class:"col-lg-6"},[e("div",{class:"row"},[e("div",{class:"col-lg-12"},[e("p",{class:"text-muted"}," Payments will need to be recorded against the booking once the booking is completed and the payment is received. ")])])],-1)),e("div",ev,[e("div",tv,[e("div",sv,[e("button",{type:"button",class:"btn btn-primary btn-lg pull-right",onClick:l[18]||(l[18]=N=>z())}," Book")])])])])])])])],512),[[ae,!T.value]]),ee(He,{isLoading:T.value},{default:ue(()=>[W(H(M.value.join(" , "))+"...",1)]),_:1},8,["isLoading"]),ee(Ae,{large:!0,onCancel:l[20]||(l[20]=N=>me()),force:!0,isModalOpen:i.value},{default:ue(()=>[l[60]||(l[60]=e("h1",{slot:"title"},"Tax Invoice",-1)),l[61]||(l[61]=e("div",{class:"row",height:"500px"},[e("div",{class:"col-lg-12"},[e("iframe",{id:"invoice_frame",width:"100%",height:"700px",class:"embed-responsive-item",frameborder:"0"})])],-1)),e("div",ov,[e("button",{id:"okBtn",type:"button",class:"btn btn-default",onClick:l[19]||(l[19]=N=>me())},"Finalize Booking")])]),_:1},8,["isModalOpen"])])}}},lv={id:"bookingCloseClasses"},nv={name:"bookingForm"},rv={class:"row"},iv={class:"col-lg-12"},dv={class:"well"},uv={class:"row"},cv={class:"col-md-12"},pv={class:"col-md-6"},vv={class:"text-primary pull-left"},mv={class:"col-md-12"},fv=["href"],_v={class:"row"},gv={class:"col-md-12"},hv={class:"form-group"},yv={class:"col-md-12"},bv={class:"col-md-4"},kv={class:"form-group"},$v={class:"col-md-8"},Cv={class:"dropdown guests"},wv={class:"dropdown-menu","aria-labelledby":"dropdownMenu1"},xv={class:"row"},Dv={class:"col-sm-4"},Tv={class:"item"},Sv={style:{color:"#888","font-weight":"300","font-size":"12px"}},Mv={class:"pull-right"},Ev={class:"btn-group btn-group-sm"},Pv=["onClick"],Rv=["onClick"],Ov={class:"row"},Yv={class:"col-lg-12"},Uv={key:0,id:"campsite-booking"},Av={class:"col-lg-12 text-center"},Vv={class:"row"},qv={class:"col-sm-12"},Fv={class:"column table-scroll"},jv={class:"hover table table-striped table-bordered dt-responsive nowrap",cellspacing:"0",width:"100%",name:"campsite"},Iv={class:"form-group"},Hv={class:"form-group"},Lv=["value","disabled"],Nv={class:"row"},Bv={class:"col-lg-12"},Gv={key:0,id:"campsite-class-booking"},Jv={class:"row"},zv={class:"col-lg-12 text-center"},Xv={class:"row"},Wv={class:"col-sm-12"},Kv={class:"column table-scroll"},Qv={class:"hover table table-striped table-bordered dt-responsive nowrap",cellspacing:"0",width:"100%",name:"campsite-type"},Zv={class:"numBook"},em=["disabled"],tm={class:"site"},sm={class:"site"},om={class:"numBook"},am=["value","disabled"],lm={class:"row"},nm={class:"col-lg-12"},rm={class:"well"},im={class:"row"},dm={class:"col-lg-6"},um={class:"row"},cm={class:"col-md-12"},pm={class:"form-group"},vm={id:"matched_emails"},mm=["value"],fm={class:"col-md-6"},_m={class:"row"},gm={class:"col-md-6"},hm={class:"form-group"},ym={class:"col-md-6"},bm={class:"form-group"},km={class:"row"},$m={class:"col-md-6"},Cm={class:"form-group"},wm={class:"col-md-6"},xm={class:"form-group"},Dm=["value"],Tm={class:"row"},Sm={class:"col-md-6"},Mm={class:"form-group"},Em={class:"col-lg-6"},Pm={class:"row"},Rm={class:"col-lg-12"},Om={key:0,class:"text-primary"},Ym={key:1,class:"text-primary"},Um={class:"row"},Am={class:"col-md-12"},Vm={class:"form-group"},qm={class:"dropdown guests"},Fm={class:"dropdown-menu","aria-labelledby":"dropdownMenu1"},jm={class:"row"},Im={class:"col-sm-8"},Hm={class:"item"},Lm={class:"pull-right"},Nm={class:"btn-group btn-group-sm"},Bm=["onClick"],Gm=["onClick"],Jm={class:"row"},zm={class:"col-md-6"},Xm={class:"form-group"},Wm={class:"required"},Km=["name","onUpdate:modelValue"],Qm={class:"col-md-6"},Zm={key:0,class:"form-group"},ef=["onUpdate:modelValue"],tf={key:0},sf={class:"row"},of={class:"col-lg-12"},af={class:"well"},lf={class:"row"},nf={class:"col-lg-6"},rf={class:"row"},df={class:"col-lg-12"},uf={class:"form-group"},cf={class:"input-group"},pf=["placeholder","value"],vf={class:"row"},mf={class:"col-lg-12"},ff={class:"form-group"},_f={key:0,class:"input-group"},gf=["placeholder"],hf={class:"row"},yf={class:"col-lg-12"},bf={key:0,class:"form-group"},kf={key:1,class:"form-group"},$f={class:"row"},Cf={class:"col-lg-12"},wf={class:"form-group"},xf=["checked"],Df={class:"col-lg-6"},Tf={class:"row"},Sf={class:"col-lg-12"},Mf={slot:"footer"},Ef={__name:"booking-close-classes",setup(o){const c=Ne(),v=lt(),n=Ge(),d=a(!1),i=a(!1),x=a(v.params.id),O=a([]),p=a(""),D=a(""),b=a(""),P=a(null),t=a({arrival:"",departure:"",guests:{adult:2,concession:0,child:0,infant:0},campground:"",campsites:[],campsite_classes:[],email:"",firstname:"",surname:"",postcode:"",country:"AU",phone:"",vehicle:"",price:"0",override_price:"0",override_reason:"",override_reason_info:"",send_invoice:!0,parkEntry:{vehicles:0},entryFees:{vehicles:0,motorbike:0,concession:0,entry_fee:0,regos:[]}}),M=a([]),Y=a({}),y=a(""),k=a([{id:"adult",name:"Adults (no concession)",amount:2,description:""},{id:"concession",name:"Concession",amount:0,description:"",helpText:"accepted concession cards"},{id:"child",name:"Children",amount:0,description:"Ages 6-16"},{id:"infant",name:"Infants",amount:0,description:"Ages 0-5"}]),U=a([{id:"vehicle",name:"Vehicle",amount:0,price:0,description:"Vehicle Registration",rego:"",entry_fee:!0},{id:"concession",name:"Concession",amount:0,price:0,description:"Concession Vehicle Registration",helpText:"accepted concession cards",rego:"",entry_fee:!0},{id:"motorbike",name:"Motorbike",amount:0,price:0,description:"Motorbike Registration",rego:"",entry_fee:!0}]),$=a([]),u=a([]),f=a({entry_fee_required:!1,entry_fee:0}),q=a([]),A=a({id:null,period_start:null,period_end:null,reason:1,details:"other",vehicle:"0.00",concession:"0.00",motorbike:"0.00",editable:!1}),w=a([]),m=a({}),E=a({}),B=a(-1),te=a("campsite"),I=a({CAMPSITE:"campsite",CLASS:"class"}),h=a([]),T=Q(function(){return M.value.length>0});Q(function(){var j=t.value.parkEntry.vehicles<=10?t.value.parkEntry.vehicles:10;return t.value.parkEntry.vehicles=j,j});const R=Q({get:function(){return t.value.campsite_classes?h.value.length==t.value.campsite_classes.length:!1},set:function(j){var r=[];j&&t.value.campsite_classes.forEach(function(l){r.push(l.id)}),h.value=r,F()}}),_=Q(function(){var j=[];return te.value==I.value.CLASS&&(j=h.value),j}),V=Q(function(){var j=[];return t.value.campsite_classes.forEach(function(r){j.push(r.status)}),j.find(function(r,l){if(r=="booked"||r=="closed & booked")return!0})});ge(()=>p,function(j){F()}),ge(()=>B,function(j){p.value=t.value.campsite_classes[j],F()}),ge(()=>D,function(j){t.value.arrival&&s.each(w.value,function(r,l){const K={start:ne.parseDate(l.range_start,"dd/MM/yyyy",new Date),end:ne.parseDate(l.range_end,"dd/MM/yyyy",new Date)},N=ne.parseDate(t.value.arrival,"yyyy-MM-dd",new Date);ne.isWithinInterval(N,K)&&(E.value.updateOptions({restrictions:{maxDate:ne.addDays(N,l.max_days)}}),E.value.clear())}),oe(),F()}),ge(()=>b,function(j){oe(),F()}),ge(()=>te,function(j){oe()});const oe=function(){te.value==I.value.CAMPSITE&&ve(),te.value==I.value.CLASS&&be()},Z=function(j){_t.isNotEmpty(j.target)},F=function(){t.value.price=0;var j=_.value;if(p.value&&t.value.arrival&&t.value.departure){var r=ce(t.value.arrival,"YYYY-MM-DD"),l=ce(t.value.departure,"YYYY-MM-DD");l.diff(r,"days"),fetch(G.campsites_current_price(),{method:"POST",body:{campsites:j,arrival:r.format("YYYY-MM-DD"),departure:l.format("YYYY-MM-DD")},headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(K=>{P.value=null,P.value=K.body,he()}).catch(K=>{console.log(K)})}},se=function(){M.value.push("fetching countries"),fetch(G.countries).then(j=>{O.value=j.body,M.value.splice("fetching countries",1)},j=>{console.log(j),M.value.splice("fetching countries",1)})},ve=function(){D.value&&b.value&&(M.value.push("fetching campsites"),fetch(G.available_campsites(t.value.campground,ce(t.value.arrival,"YYYY-MM-DD").format("YYYY/MM/DD"),ce(t.value.departure,"YYYY-MM-DD").format("YYYY/MM/DD"))).then(j=>{t.value.campsites=j.body,t.value.campsites.length>0&&(p.value=t.value.campsites[0].id),M.value.splice("fetching campsites",1)},j=>{console.log(j),M.value.splice("fetching campsites",1)}))},be=function(){D.value&&b.value&&(M.value.push("fetching campsite classes"),fetch(G.available_campsites(t.value.campground,ce(t.value.arrival,"YYYY-MM-DD").format("YYYY/MM/DD"),ce(t.value.departure,"YYYY-MM-DD").format("YYYY/MM/DD"))).then(j=>{t.value.campsite_classes=j.body,t.value.campsite_classes.length>0&&(p.value=t.value.campsite_classes[0].id,B.value=0),M.value.splice("fetching campsite classes",1)},j=>{console.log(j),M.value.splice("fetching campsite classes",1)}))},Pe=function(){M.value.push("fetching campground");var j=v.params.cg;fetch(G.campground(j)).then(r=>{Y.value=r.body,t.value.campground=Y.value.id,te.value=Y.value.site_type==0?I.value.CAMPSITE:I.value.CLASS,Ve(),ve(),Je(),Ze(),M.value.splice("fetching campground",1)}).catch(r=>{console.log(r),M.value.splice("fetching campground",1)})},Ve=function(){M.value.push("fetching stay history"),fetch(G.campgroundStayHistory(Y.value.id)).then(j=>{j.body.length>0&&(w.value=j.body),M.value.splice("fetching stay history",1)}).catch(j=>{console.log(j),M.value.splice("fetching stay history",1)})},Je=function(){M.value.push("fetching park"),fetch(G.park(Y.value.park)).then(j=>{f.value=j.body,M.value.splice("fetching park",1)}).catch(j=>{console.log(j),M.value.splice("fetching park",1)})},Ze=function(){const j=s(x.value.arrival).closest(".date"),r=s(x.value.departure).closest(".date");m.value=xe(j,{restrictions:{minDate:new Be().startOf("date"),maxDate:ne.addDays(new Date,parseInt(Y.value.max_advance_booking))}}),E.value=xe(r,{useCurrent:!1}),j.on("change.td",function(l){const K=m.value.dates.lastPicked;t.value.arrival=K?ne.formatDate(K,"yyyy-MM-dd"):null,D.value=t.value.arrival,b.value="",t.value.departure="",K&&(E.value.updateOptions({restrictions:{minDate:ne.addDays(K,1),maxDate:ne.addDays(minDate,180)}}),E.value.clear())}),r.on("change.td",function(l){const K=E.value.dates.lastPicked;t.value.departure=K?ne.formatDate(K,"yyyy-MM-dd"):null,b.value=K?t.value.departure:null}),fetch(G.campgroundCampsites(Y.value.id)).then(l=>{var K=l.body;fetch(G.campsite_current_price(K[0].id,ce().format("YYYY-MM-DD"),ce().add(1,"days").format("YYYY-MM-DD"))).then(N=>{P.value=null,P.value=N.body,M.value.splice("updating prices",1)}).catch(N=>{console.log(N),M.value.splice("updating prices",1)})}).catch(l=>{console.log(l)})},pe=function(j){switch(j.amount+=1,j.id){case"adult":t.value.guests.adult=j.amount;break;case"concession":t.value.guests.concession=j.amount;break;case"child":t.value.guests.child=j.amount;break;case"infant":t.value.guests.infant=j.amount;break}Fe()},ye=function(j){switch(j.amount=j.amount>0?j.amount-1:0,j.id){case"adult":t.value.guests.adult=j.amount;break;case"concession":t.value.guests.concession=j.amount;break;case"child":t.value.guests.child=j.amount;break;case"infant":t.value.guests.infant=j.amount;break}Fe()},Fe=function(){var j="";s.each(k,function(r,l){r!=k.length-1?l.amount>0&&(j+=l.amount+" "+l.name+",  "):l.amount>0&&(j+=l.amount+" "+l.name+" ")}),y.value=j.replace(/,\s*$/,""),he()},he=function(){t.value.price=0,f.value.entry_fee_required?J(function(){s.each(P,function(j,r){for(var l in t.value.guests)t.value.guests.hasOwnProperty(l)&&(t.value.price+=t.value.guests[l]*r.rate[l])}),Ue(),t.value.price=t.value.price+t.value.entryFees.entry_fee}):s.each(P,function(j,r){for(var l in t.value.guests)t.value.guests.hasOwnProperty(l)&&(t.value.price+=t.value.guests[l]*r.rate[l])})},Ue=function(){t.value.entryFees.entry_fee=0,p.value&&t.value.arrival&&t.value.departure&&s.each(q.value,function(j,r){if(r=JSON.parse(JSON.stringify(r)),A.value&&r.entry_fee)switch(r.id){case"vehicle":t.value.entryFees.entry_fee+=parseInt(A.value.vehicle),t.value.entryFees.vehicles++;break;case"motorbike":t.value.entryFees.entry_fee+=parseInt(A.value.motorbike),t.value.entryFees.motorbike++;break;case"concession":t.value.entryFees.entry_fee+=parseInt(A.value.concession),t.value.entryFees.concession++;break}})},ze=xt(function(j){fetch(G.usersLookup(t.value.email)).then(r=>{$.value=r.body,u.value=[],s.each($,function(l,K){u.value.push(K.email)}),L()})},100),J=function(j){t.value.arrival?fetch(G.park_current_price(f.value.id,t.value.arrival)).then(r=>{var l=r.body;l.constructor!=Array?A.value=r.body:(A.value.vehicle="0.00",A.value.motorbike="0.00",A.value.concession="0.00"),j()}):(A.value.vehicle="0.00",A.value.motorbike="0.00",A.value.concession="0.00",j())},L=function(j){s.each($,function(r,l){if(l.email==t.value.email)return t.value.firstname=l.first_name,t.value.surname=l.last_name,t.value.phone=l.mobile_number,l.profile_addresses[0]&&(t.value.postcode=l.profile_addresses[0].postcode,t.value.country=l.profile_addresses[0].country),!1})},z=function(){if(we()){M.value.push("processing booking"),j.value.entryFees={vehicle:0,motorbike:0,concession:0,entry_fee:0,regos:[]},s.each(q.value,function(r,l){switch(l=JSON.parse(JSON.stringify(l)),(l.rego!=null||l.rego!="null")&&j.value.entryFees.regos.push({type:l.id,rego:l.rego,entry_fee:l.entry_fee}),l.id){case"vehicle":j.value.entryFees.entry_fee+=parseInt(A.value.vehicle),j.value.entryFees.vehicle++;break;case"motorbike":j.value.entryFees.entry_fee+=parseInt(A.value.motorbike),j.value.entryFees.motorbike++;break;case"concession":j.value.entryFees.entry_fee+=parseInt(A.value.concession),j.value.entryFees.concession++;break}});var j={arrival:j.value.arrival,departure:j.value.departure,guests:j.value.guests,campsites:_.value,costs:{campground:P,parkEntry:A.value,total:j.value.price},override_price:j.value.override_price,override_reason:j.value.override_reason,override_reason_info:j.value.override_reason_info,do_not_send_invoice:j.value.send_invoice,customer:{email:j.value.email,first_name:j.value.firstname,last_name:j.value.surname,phone:j.value.phone,country:j.value.country,postcode:j.value.postcode},regos:j.value.entryFees.regos};n.dispatch("updateAlert",{visible:!1,type:"danger",message:""}),fetch(G.bookings,{method:"POST",body:j,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(r=>{M.value.splice("processing booking",1);var l=s("#invoice_frame");l[0].src="/ledger/payments/invoice/"+r.body.invoices[0],i.value=!1,c.push({name:"booking-dashboard"})}).catch(r=>{let l=re.apiVueResourceError(r);n.dispatch("updateAlert",{visible:!0,type:"danger",message:l}),M.value.splice("processing booking",1)})}},me=function(){i.value=!1,c.push({name:"booking-dashboard"})},we=function(){return s(x.value).valid()},je=function(j){var r=q.value.filter(function(l){return l.rego==j.value});return r.length<=1},We=function(){return!(d.value&&t.value.override_price!=null&&t.value.override_reason=="")},Re=function(){for(var j={rules:{arrival:"required",departure:"required",guests:"required",campsite:"required",email:{required:!0,email:!0},firstname:"required",surname:"required",phone:"required",postcode:"required",country:"required",price_level:"required",open_reason:"required",overrideReason:{required:{depends:function(K){return We()}}}},messages:{firstname:"Fill in all details"},showErrors:function(K,N){s.each(this.validElements(),function(st,gt){var ct=s(gt);ct.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var Ce=0;Ce<N.length;Ce++){var Me=N[Ce];s(Me.element).tooltip({trigger:"focus"}).attr("data-original-title",Me.message).parents(".form-group").addClass("has-error")}}},r=0;r<t.value.parkEntry.vehicles;r++)j.rules["vehicleRego_"+r]={required:!0,noDuplicateRego:!0},j.messages["vehicleRego_"+r]={required:"Fill in vehicle details",noDuplicateRego:"Duplicate regos not permitted.If unknown add number, e.g. Hire1, Hire2"};var l=s(x.value);l.data("validator",null),s.validator.addMethod("noDuplicateRego",function(K,N){return je(N)}),l.validate(j)},tt=function(j){var r=t.value.parkEntry.vehicles;if(j.amount<10&&r<10){j.amount=j.amount<10?j.amount+=1:j.amount,t.value.parkEntry.vehicles++;var l=JSON.parse(JSON.stringify(j));entry_fee_required.value||(l.entry_fee=!1),q.value.push(l)}t.value.price=t.value.price-t.value.entryFees.entry_fee,Ue(),t.value.price=t.value.price+t.value.entryFees.entry_fee,Re()},ut=function(j){var r=t.value.parkEntry.vehicles;if(j.amount>0&&r>0)for(var l=!1,K=j.amount-1;K>=0;K--){for(var N=q.value.length-1;N>=0;N--)if(j.description==q.value[N].description){j.amount=j.amount>0?j.amount-=1:j.amount,q.value.splice(N,1),t.value.parkEntry.vehicles--,l=!0;break}if(l)break}t.value.price=t.value.price-t.value.entryFees.entry_fee,Ue(),t.value.price=t.value.price+t.value.entryFees.entry_fee,Re()};return $e(function(){x.value=document.forms.bookingForm,Pe(),se(),Fe(),Re()}),(j,r)=>(C(),S("div",lv,[g(e("form",nv,[e("div",rv,[e("div",iv,[e("div",dv,[e("div",uv,[e("div",cv,[e("div",pv,[e("h3",vv,"Book closed sites for "+H(Y.value.name),1)])]),e("div",mv,[e("p",null,[r[24]||(r[24]=W("Internal bookings can be made for campsites closed to public bookings")),e("a",{target:"_blank",href:"/availability_admin/?site_id="+Y.value.id}," Check closures",8,fv),r[25]||(r[25]=W(" before adding a closed site to a booking."))])]),e("div",_v,[e("div",gv,[e("div",hv,[e("div",yv,[r[30]||(r[30]=Qe('<label class="control-label pull-left required" for="Dates">Dates: </label><div class="col-md-3"><div class="input-group date" id="dateArrival"><input type="text" class="form-control" name="arrival" placeholder="Arrival"><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div><div class="col-md-3"><div class="input-group date" id="datedeparture"><input type="text" class="form-control" name="departure" placeholder="Departure"><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div>',3)),e("div",bv,[e("div",kv,[r[29]||(r[29]=e("label",{class:"control-label pull-left required",for:"Campground"},"Guests: ",-1)),e("div",$v,[e("div",Cv,[g(e("input",{type:"text",class:"form-control dropdown-toggle",name:"guests",placeholder:"Guests","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true","onUpdate:modelValue":r[0]||(r[0]=l=>y.value=l)},null,512),[[X,y.value]]),e("ul",wv,[(C(!0),S(ie,null,de(k.value,l=>(C(),S("li",null,[e("div",xv,[e("div",Dv,[e("span",Tv,[W(H(l.amount)+" "+H(l.name)+" ",1),e("span",Sv,H(l.description),1)]),r[26]||(r[26]=e("br",null,null,-1)),g(e("a",{href:"#",class:"text-info"},H(l.helpText),513),[[ae,l.helpText]])]),e("div",Mv,[e("div",Ev,[e("button",{type:"button",class:"btn btn-guest",onClick:_e(K=>pe(l),["prevent","stop"])},r[27]||(r[27]=[e("span",{class:"glyphicon glyphicon-plus"},null,-1)]),8,Pv),e("button",{type:"button",class:"btn btn-guest",onClick:_e(K=>ye(l),["prevent","stop"])},r[28]||(r[28]=[e("span",{class:"glyphicon glyphicon-minus"},null,-1)]),8,Rv)])])])]))),256))])])])])])])])])]),e("div",Ov,[e("div",Yv,[Y.value.site_type==0?(C(),S("div",Uv,[g(e("div",Av,r[31]||(r[31]=[e("h2",null,"No Campsites Available For The Provided Dates",-1)]),512),[[ae,t.value.campsites.length<1]])])):fe("",!0)])]),e("div",Vv,[e("div",qv,[g(e("div",null,[e("div",Fv,[e("table",jv,[e("thead",null,[e("tr",null,[r[33]||(r[33]=e("th",{class:"form-group"},"Campsite",-1)),r[34]||(r[34]=e("th",{class:"form-group"},"Status",-1)),e("th",null,[r[32]||(r[32]=W("Sites to book ")),g(e("input",{class:"checkbox",type:"checkbox",id:"selectAll","onUpdate:modelValue":r[1]||(r[1]=l=>R.value=l)},null,512),[[Te,R.value]])])])]),e("tbody",null,[(C(!0),S(ie,null,de(t.value.campsites,l=>(C(),S("tr",null,[e("td",Iv,H(l.name)+" - "+H(l.type),1),e("td",Hv,H(l.status),1),e("td",null,[g(e("input",{class:"checkbox",type:"checkbox",value:l.id,disabled:l.status=="booked","onUpdate:modelValue":r[2]||(r[2]=K=>h.value=K),onChange:r[3]||(r[3]=K=>F()),number:""},null,40,Lv),[[Te,h.value]])])]))),256))])])])],512),[[ae,t.value.campsites.length>0]])])]),e("div",Nv,[e("div",Bv,[Y.value.site_type==1||Y.value.site_type==2?(C(),S("div",Gv,[e("div",Jv,[g(e("div",zv,r[35]||(r[35]=[e("h2",null,"No Campsites Available For The Provided Dates",-1)]),512),[[ae,t.value.campsite_classes.length<1]])])])):fe("",!0)])]),e("div",Xv,[e("div",Wv,[g(e("div",null,[e("div",Kv,[e("table",Qv,[e("thead",null,[e("tr",null,[r[37]||(r[37]=e("th",{class:"site"},"Campsite",-1)),r[38]||(r[38]=e("th",{class:"form-group"},"Status",-1)),e("th",Zv,[r[36]||(r[36]=W("Site to book ")),g(e("input",{class:"checkbox",type:"checkbox",id:"selectAll","onUpdate:modelValue":r[4]||(r[4]=l=>R.value=l),disabled:V.value},null,8,em),[[Te,R.value]])])])]),e("tbody",null,[(C(!0),S(ie,null,de(t.value.campsite_classes,l=>(C(),S("tr",null,[e("td",tm,H(l.name)+" - "+H(l.type),1),e("td",sm,H(l.status),1),e("td",om,[g(e("input",{class:"checkbox",type:"checkbox",value:l.id,disabled:l.status=="booked"||l.status=="closed & booked","onUpdate:modelValue":r[5]||(r[5]=K=>h.value=K),onChange:r[6]||(r[6]=K=>F()),number:""},null,40,am),[[Te,h.value]])])]))),256))])])])],512),[[ae,t.value.campsite_classes.length>0]])])])])])])]),e("div",lm,[e("div",nm,[e("div",rm,[e("div",im,[e("div",dm,[r[46]||(r[46]=e("div",{class:"row"},[e("div",{class:"col-lg-12"},[e("h3",{class:"text-primary"},"Personal Details")])],-1)),e("div",um,[e("div",cm,[e("div",pm,[r[39]||(r[39]=e("label",{for:"Email",class:"required"},"Email",-1)),g(e("input",{type:"text",name:"email",class:"form-control","onUpdate:modelValue":r[7]||(r[7]=l=>t.value.email=l),list:"matched_emails",onKeyup:r[8]||(r[8]=l=>De(ze)())},null,544),[[X,t.value.email]]),e("datalist",vm,[u.value?(C(!0),S(ie,{key:0},de(u.value,l=>(C(),S("option",{value:l},null,8,mm))),256)):fe("",!0)])])]),g(e("div",fm,r[40]||(r[40]=[e("div",{class:"form-group"},[e("label",{for:"Confirm Email",class:"required"},"Confirm Email"),e("input",{type:"text",name:"confirm_email",class:"form-control"})],-1)]),512),[[ae,!1]])]),e("div",_m,[e("div",gm,[e("div",hm,[r[41]||(r[41]=e("label",{for:"First Name",class:"required"},"First Name",-1)),g(e("input",{type:"text",name:"firstname",class:"form-control","onUpdate:modelValue":r[9]||(r[9]=l=>t.value.firstname=l)},null,512),[[X,t.value.firstname]])])]),e("div",ym,[e("div",bm,[r[42]||(r[42]=e("label",{for:"Surname",class:"required"},"Surname",-1)),g(e("input",{type:"text",name:"surname",class:"form-control","onUpdate:modelValue":r[10]||(r[10]=l=>t.value.surname=l)},null,512),[[X,t.value.surname]])])])]),e("div",km,[e("div",$m,[e("div",Cm,[r[43]||(r[43]=e("label",{for:"Postcode",class:"required"},"Postcode",-1)),g(e("input",{type:"text",name:"postcode",class:"form-control","onUpdate:modelValue":r[11]||(r[11]=l=>t.value.postcode=l)},null,512),[[X,t.value.postcode]])])]),e("div",wm,[e("div",xm,[r[44]||(r[44]=e("label",{for:"Country",class:"required"},"Country",-1)),g(e("select",{class:"form-control",name:"country","onUpdate:modelValue":r[12]||(r[12]=l=>t.value.country=l)},[(C(!0),S(ie,null,de(O.value,l=>(C(),S("option",{value:l.iso_3166_1_a2},H(l.printable_name),9,Dm))),256))],512),[[ke,t.value.country]])])])]),e("div",Tm,[e("div",Sm,[e("div",Mm,[r[45]||(r[45]=e("label",{for:"Phone",class:"required"},[W("Phone "),e("span",{class:"text-muted"},"(mobile prefered)")],-1)),g(e("input",{type:"text",name:"phone",class:"form-control","onUpdate:modelValue":r[13]||(r[13]=l=>t.value.phone=l)},null,512),[[X,t.value.phone]])])])])]),e("div",Em,[e("div",Pm,[e("div",Rm,[f.value.entry_fee_required?(C(),S("h3",Om,[r[47]||(r[47]=W("Park Entry Fees ")),e("small",null,"($"+H(A.value.vehicle|j.formatMoney(2))+"/per vehicle)",1)])):(C(),S("h3",Ym,"Vehicle Details"))])]),e("div",Um,[e("div",Am,[e("div",Vm,[r[52]||(r[52]=e("label",{for:"vehicles",class:"required"},"Number of Vehicles",-1)),e("div",qm,[g(e("input",{type:"number",min:"0",max:"10",name:"vehicles",class:"form-control dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",readonly:"true","onUpdate:modelValue":r[14]||(r[14]=l=>t.value.parkEntry.vehicles=l)},null,512),[[X,t.value.parkEntry.vehicles]]),e("ul",Fm,[(C(!0),S(ie,null,de(U.value,l=>(C(),S("li",null,[e("div",jm,[e("div",Im,[e("span",Hm,[W(H(l.amount)+" "+H(l.name)+" ",1),r[48]||(r[48]=e("span",{style:{color:"#888","font-weight":"300","font-size":"12px"}},null,-1))]),r[49]||(r[49]=e("br",null,null,-1)),g(e("a",{href:"#",class:"text-info"},H(l.helpText),513),[[ae,l.helpText]])]),e("div",Lm,[e("div",Nm,[e("button",{type:"button",class:"btn btn-guest",onClick:_e(K=>tt(l),["prevent","stop"])},r[50]||(r[50]=[e("span",{class:"glyphicon glyphicon-plus"},null,-1)]),8,Bm),e("button",{type:"button",class:"btn btn-guest",onClick:_e(K=>ut(l),["prevent","stop"])},r[51]||(r[51]=[e("span",{class:"glyphicon glyphicon-minus"},null,-1)]),8,Gm)])])])]))),256))])])])])]),(C(!0),S(ie,null,de(q.value,(l,K)=>(C(),S("div",Jm,[e("div",zm,[e("div",Xm,[e("label",Wm,H(l.description),1),g(e("input",{type:"text",class:"form-control",name:"vehicleRego_"+K,required:"required","onUpdate:modelValue":N=>l.rego=N,onChange:Z},null,40,Km),[[X,l.rego]])])]),e("div",Qm,[f.value.entry_fee_required?(C(),S("div",Zm,[r[53]||(r[53]=e("label",null,"Entry fee",-1)),g(e("input",{type:"checkbox",class:"form-control","onUpdate:modelValue":N=>l.entry_fee=N,onChange:r[15]||(r[15]=N=>F())},null,40,ef),[[Te,l.entry_fee]])])):fe("",!0)])]))),256)),f.value.entry_fee_required?(C(),S("p",tf,r[54]||(r[54]=[e("b",null,"NOTE:",-1),W(" A vehicle entry fee is not required for the holder of a valid Park Pass.")]))):fe("",!0)])])])])]),e("div",sf,[e("div",of,[e("div",af,[e("div",lf,[e("div",nf,[e("div",rf,[e("div",df,[e("div",uf,[r[56]||(r[56]=e("label",{for:"Total Price"},[W("Total Price "),e("span",{class:"text-muted"},"(GST inclusive.)")],-1)),e("div",cf,[r[55]||(r[55]=e("span",{class:"input-group-addon"},[W("AUD "),e("i",{class:"fa fa-usd"})],-1)),e("input",{type:"text",class:"form-control",placeholder:0|j.formatMoney(2),value:t.value.price|j.formatMoney(2),readonly:"true"},null,8,pf)])])])]),e("div",vf,[e("div",mf,[e("div",ff,[g(e("input",{type:"checkbox",name:"overrideCharge",class:"form control","onUpdate:modelValue":r[16]||(r[16]=l=>d.value=l)},null,512),[[Te,d.value]]),r[58]||(r[58]=e("label",{for:"OverrideCharge"},"Override price charged ",-1)),d.value?(C(),S("div",_f,[r[57]||(r[57]=e("span",{class:"input-group-addon"},[W("AUD "),e("i",{class:"fa fa-usd"})],-1)),g(e("input",{type:"text",class:"form-control",name:"overridePrice",placeholder:0|j.formatMoney(2),"onUpdate:modelValue":r[17]||(r[17]=l=>t.value.override_price=l)},null,8,gf),[[X,t.value.override_price]])])):fe("",!0)])])]),e("div",hf,[e("div",yf,[d.value?(C(),S("div",bf,[ee(qe,{type:"discount",name:"overrideReason",modelValue:t.value.override_reason,"onUpdate:modelValue":r[18]||(r[18]=l=>t.value.override_reason=l),required:d.value},null,8,["modelValue","required"])])):fe("",!0),d.value?(C(),S("div",kf,[r[59]||(r[59]=e("label",{class:"control-label"},"Override reason detail:",-1)),g(e("textarea",{id:"reason_details",class:"form-control","onUpdate:modelValue":r[19]||(r[19]=l=>t.value.override_reason_info=l)},null,512),[[X,t.value.override_reason_info]])])):fe("",!0)])]),e("div",$f,[e("div",Cf,[e("div",wf,[g(e("input",{type:"checkbox",name:"sendInvoice",class:"form control",id:"send_invoice",checked:"","onUpdate:modelValue":r[20]||(r[20]=l=>t.value.send_invoice=l)},null,8,xf),[[Te,t.value.send_invoice]]),r[60]||(r[60]=e("label",{for:"sendInvoice"},"Don't send invoice upon booking",-1))])])])]),r[61]||(r[61]=e("div",{class:"col-lg-6"},[e("div",{class:"row"},[e("div",{class:"col-lg-12"},[e("p",{class:"text-muted"}," Payments will need to be recorded against the booking once the booking is completed and the payment is received. ")])])],-1)),e("div",Df,[e("div",Tf,[e("div",Sf,[e("button",{type:"button",class:"btn btn-primary btn-lg pull-right",onClick:r[21]||(r[21]=l=>z())}," Book")])])])])])])])],512),[[ae,!T.value]]),ee(He,{isLoading:T.value},{default:ue(()=>[W(H(M.value.join(" , "))+"...",1)]),_:1},8,["isLoading"]),ee(Ae,{large:!0,onCancel:r[23]||(r[23]=l=>me()),force:!0,isModalOpen:i.value},{default:ue(()=>[r[62]||(r[62]=e("h1",{slot:"title"},"Tax Invoice",-1)),r[63]||(r[63]=e("div",{class:"row",height:"500px"},[e("div",{class:"col-lg-12"},[e("iframe",{id:"invoice_frame",width:"100%",height:"700px",class:"embed-responsive-item",frameborder:"0"})])],-1)),e("div",Mf,[e("button",{id:"okBtn",type:"button",class:"btn btn-default",onClick:r[22]||(r[22]=l=>me())},"Finalize Booking")])]),_:1},8,["isModalOpen"])]))}},Pf={class:"row"},Rf={__name:"index",setup(o){const c=Ge(),v=Q(()=>c.getters.app_loader_state),n=Q(()=>c.getters.app_loader_text);return(d,i)=>{const x=nt("router-view");return C(),S("div",Pf,[v.value?(C(),Ye(He,{key:0,isLoading:v.value},{default:ue(()=>[W(H(n.value)+"...",1)]),_:1},8,["isLoading"])):(C(),Ye(x,{key:1}))])}}},Of={fetchBooking(o){return new Promise((c,v)=>{fetch(G.booking(o)).then(n=>{c(n)}).catch(n=>{v(n)})})}},Yf={id:"changeBooking"},Uf={name:"bookingForm"},Af={class:"row"},Vf={class:"col-lg-12"},qf={class:"well"},Ff={class:"row"},jf={class:"col-md-12"},If={class:"text-primary"},Hf={class:"col-md-8 col-md-offset-1"},Lf={class:"row form-horizontal"},Nf={class:"col-md-12"},Bf={class:"form-group"},Gf={class:"col-md-8"},Jf=["value"],zf={key:0,class:"form-group"},Xf={key:0,class:"col-md-8"},Wf={class:"col-md-8"},Kf=["value"],Qf={key:1,class:"col-md-8"},Zf={class:"form-group"},e_={class:"col-md-4"},t_={class:"input-group date",id:"dateArrival"},s_={class:"col-md-4"},o_={class:"input-group date",id:"datedeparture"},a_={class:"form-group"},l_={class:"col-md-8"},n_={class:"dropdown guests"},r_={class:"dropdown-menu","aria-labelledby":"dropdownMenu1"},i_={class:"row"},d_={class:"col-sm-8"},u_={class:"item"},c_={style:{color:"#888","font-weight":"300","font-size":"12px"}},p_={class:"pull-right"},v_={class:"btn-group btn-group-sm"},m_=["onClick"],f_=["onClick"],__={class:"col-lg-8 col-md-offset-1"},g_={class:"row form-horizontal"},h_={class:"col-md-12"},y_={class:"form-group"},b_={class:"dropdown guests col-md-8"},k_={class:"dropdown-menu","aria-labelledby":"dropdownMenu1"},$_={class:"row"},C_={class:"col-sm-8"},w_={class:"item"},x_={class:"pull-right"},D_={class:"btn-group btn-group-sm"},T_=["onClick"],S_=["onClick"],M_={class:"row"},E_={class:"col-md-6 col-md-offset-4"},P_={class:"form-group"},R_={class:"required"},O_=["onUpdate:modelValue"],Y_={key:0,class:"col-md-2"},U_={class:"form-check"},A_={class:"form-check-label"},V_=["onUpdate:modelValue"],q_={class:"col-lg-8 col-md-offset-1"},F_={key:0,class:"row form-horizontal"},j_={class:"col-md-12"},I_={class:"form-group"},H_={class:"col-md-8"},L_={class:"input-group"},N_=["placeholder","value"],B_={class:"form-group"},G_={class:"col-md-8"},J_={class:"input-group"},z_=["placeholder","value"],X_={class:"form-group"},W_={class:"col-md-8"},K_={class:"input-group"},Q_=["placeholder","value"],Z_={class:"row",style:{"margin-top":"20px"}},eg={class:"col-md-12"},tg=["disabled"],sg={__name:"changebooking2",setup(o){const c=Ge(),v=Ne(),n=a(null),d=a(""),i=a(""),x=a(""),O=a(null),p=a({parkEntry:{vehicles:0}}),D=a([]),b=a([]),P=a(""),t=a(null),M=[{id:"adults",name:"Adults (no concession)",amount:0,description:""},{id:"concession",name:"Concession",amount:0,description:"",helpText:"accepted concession cards"},{id:"children",name:"Children",amount:0,description:"Ages 6-16"},{id:"infants",name:"Infants",amount:0,description:"Ages 0-5"}],Y=[{id:"vehicle",name:"Vehicle",amount:0,price:0,description:"Vehicle Registration",rego:"",entry_fee:!1},{id:"concession",name:"Concession",amount:0,price:0,description:"Concession Vehicle Registration",helpText:"accepted concession cards",rego:"",entry_fee:!1},{id:"motorbike",name:"Motorbike",amount:0,price:0,description:"Motorbike Registration",rego:"",entry_fee:!1}],y=a({entry_fee_required:!1,entry_fee:0}),k=a([]),U=a({id:null,period_start:null,period_end:null,reason:1,details:"other",vehicle:"0.00",concession:"0.00",motorbike:"0.00",editable:!1}),$=a([]),u=a({}),f=a({});a([]);const q=a([]),A=a("campsite"),w=a(!1),m=a(!1),E=a(0),B=Q(()=>b.value.length>0);Q(()=>{var J=p.value.parkEntry.vehicles<=10?p.value.parkEntry.vehicles:10;return p.value.parkEntry.vehicles=J,J});const te=Q(()=>I.value.filter(J=>J.campground_type===0)),I=Q(()=>c.getters.campgrounds);ge(()=>d,function(){_()}),ge(()=>i,function(){p.value.arrival&&s.each($.value,function(J,L){const z={start:ne.parseDate(L.range_start,"dd/MM/yyyy",new Date),end:ne.parseDate(L.range_end,"dd/MM/yyyy",new Date)},me=ne.parseDate(p.value.arrival,"yyyy-MM-dd",new Date);ne.isWithinInterval(me,z)&&(f.value.updateOptions({restrictions:{maxDate:ne.addDays(me,L.max_days)}}),f.value.clear())}),w.value,oe(),R(),F(),_()}),ge(()=>x,function(){w.value,oe(),R(),_()}),ge(()=>A,function(){});const h=function(J){_t.isNotEmpty(J.target)},T=function(){t.value=p.value.campground?I.value.find(J=>parseInt(J.id)===parseInt(p.value.campground)):null,oe()},R=function(){setTimeout(function(){s("#multi-campsites").select2({theme:"bootstrap",allowClear:!0,placeholder:"Select Campsites",tags:!1}).on("select2:select",function(J){q.value=s(J.currentTarget).val()}).on("select2:unselect",function(J){q.value=s(J.currentTarget).val()})},100)},_=function(){var J=q.value;if(p.value.price=0,d.value&&p.value.arrival&&p.value.departure){var L=ce(i.value,"DD/MM/YYYY"),z=ce(x.value,"DD/MM/YYYY");z.diff(L,"days"),b.value.push("updating prices"),fetch(G.campsites_current_price(),{method:"POST",body:{campsites:J,arrival:L.format("YYYY-MM-DD"),departure:z.format("YYYY-MM-DD")},headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(me=>{O.value=null,O.value=me.body,V(),b.value.splice("updating prices",1)},me=>{console.log(me),b.value.splice("updating prices",1)})}},V=function(){p.value.price=0,y.value.entry_fee_required?Ve(function(){s.each(O.value,function(J,L){for(var z in p.value.guests)switch(z){case"adults":p.value.price+=p.value.guests[z]*parseFloat(L.rate.adult);break;case"concession":p.value.price+=p.value.guests[z]*parseFloat(L.rate.concession);break;case"children":p.value.price+=p.value.guests[z]*parseFloat(L.rate.child);break;case"infants":p.value.price+=p.value.guests[z]*parseFloat(L.rate.infant);break}}),Pe(),p.value.price=p.value.price+p.value.entryFees.entry_fee,E.value=p.value.price}):(s.each(O.value,function(J,L){for(var z in p.value.guests)switch(z){case"adults":p.value.price+=p.value.guests[z]*parseFloat(L.rate.adult);break;case"concession":p.value.price+=p.value.guests[z]*parseFloat(L.rate.concession);break;case"children":p.value.price+=p.value.guests[z]*parseFloat(L.rate.child);break;case"infants":p.value.price+=p.value.guests[z]*parseFloat(L.rate.infant);break}}),p.value.price=p.value.price+p.value.entryFees.entry_fee,E.value=p.value.price)},oe=function(){m.value||i.value&&x.value&&(m.value=!0,b.value.push("fetching campsites"),fetch(G.available_campsites_booking(p.value.campground,p.value.arrival,p.value.departure,p.value.id)).then(J=>{if(m.value=!1,D.value=J.body,D.value.length>0){let L=D.value.find(z=>parseInt(z.id)===parseInt(d.value));(L==null||L==null)&&(d.value=D.value[0].id)}b.value.splice("fetching campsites",1)}).catch(J=>{console.log(J),b.value.splice("fetching campsites",1),m.value=!1}))},Z=function(){b.value.push("fetching park"),fetch(G.park(t.value.park)).then(J=>{y.value=J.body,b.value.splice("fetching park details",1)}).catch(J=>{console.log(J),b.value.splice("fetching park details",1)})},F=function(){const J=new Be().startOf("date"),L=s(n.value.arrival).closest(".date"),z=s(n.value.departure).closest(".date");u.value=xe(L,{restrictions:{minDate:J}}),f.value=xe(z,{minDate:ne.addDays(J,1),useCurrent:!1}),L.on("change.td",function(me){const we=u.value.dates.lastPicked;if(we){p.value.arrival=we?ne.formatDate(we,"yyyy-MM-dd"):null,i.value=p.value.arrival;var je=new Date(we),We=ne.addDays(je,1);departureDate.value=f.value.dates.lastPicked,departureDate&&je>we&&(f.value.updateOptions({restrictions:{minDate:ne.addDays(we,1),maxDate:ne.addDays(We,180)}}),f.value.clear())}}),z.on("change.td",function(me){date.value=f.value.dates.lastPicked,p.value.departure=date?ne.formatDate(date,"yyyy-MM-dd"):null,x.value=date?p.value.departure:null}),console.log("addEventListeners"),f.value.trigger("change"),u.value.trigger("change")},se=function(J){switch(J.amount+=1,J.id){case"adults":p.value.guests.adults=J.amount;break;case"concession":p.value.guests.concession=J.amount;break;case"children":p.value.guests.children=J.amount;break;case"infants":p.value.guests.infants=J.amount;break}be()},ve=function(J){switch(J.amount=J.amount>0?J.amount-1:0,J.id){case"adults":p.value.guests.adults=J.amount;break;case"concession":p.value.guests.concession=J.amount;break;case"children":p.value.guests.children=J.amount;break;case"infants":p.value.guests.infants=J.amount;break}be()},be=function(){var J="";s.each(M,function(L,z){L!=M.length-1?z.amount>0&&(J+=z.amount+" "+z.name+",  "):z.amount>0&&(J+=z.amount+" "+z.name+" ")}),P.value=J.replace(/,\s*$/,""),w.value&&V()},Pe=function(){p.value.entryFees.entry_fee=0,d.value&&p.value.arrival&&p.value.departure&&s.each(k.value,function(J,L){if(L=JSON.parse(JSON.stringify(L)),U.value&&L.entry_fee)switch(L.id){case"vehicle":p.value.entryFees.entry_fee+=parseInt(U.value.vehicle);break;case"motorbike":p.value.entryFees.entry_fee+=parseInt(U.value.motorbike);break;case"concession":p.value.entryFees.entry_fee+=parseInt(U.value.concession);break}})},Ve=function(J){if(p.value.arrival){var L=ce(p.value.arrival,"DD/MM/YYYY").format("YYYY-MM-DD");fetch(G.park_current_price(y.value.id,L)).then(z=>{var me=z.body;me.constructor!=Array?U.value=z.body:(U.value.vehicle="0.00",U.value.motorbike="0.00",U.value.concession="0.00"),J()})}else U.value.vehicle="0.00",U.value.motorbike="0.00",U.value.concession="0.00",J()},Je=function(){let J={};pe()&&(b.value.push("updating booking"),J.entryFees={vehicle:0,motorbike:0,concession:0,regos:[]},s.each(k.value,function(L,z){switch(z=JSON.parse(JSON.stringify(z)),(z.rego!=null||z.rego!="null")&&J.entryFees.regos.push({type:z.id,rego:z.rego,entry_fee:z.entry_fee}),z.id){case"vehicle":J.entryFees.vehicle++;break;case"motorbike":J.entryFees.motorbike++;break;case"concession":J.entryFees.concession++;break}}),J.arrival=J.value.arrival,J.departure=J.value.departure,J.guests=J.value.guests,D.value=q.value,J.campground=J.value.campground,c.dispatch("updateAlert",{visible:!1,type:"danger",message:""}),fetch(G.booking(J.value.id),{body:J,method:"PUT",headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(L=>{b.value.splice("updating booking",1),Ze()},L=>{let z=re.apiVueResourceError(L);c.dispatch("updateAlert",{visible:!0,type:"danger",message:z}),b.value.splice("updating booking",1)}))},Ze=function(){v.push({name:"booking-dashboard"})},pe=function(){return ye()&&s(n.value).valid()},ye=function(){var J=!0;let L=0;return s(".vehicleLookup").each((z,me)=>{s(me).val()!=""&&L++}),p.value.parkEntry.vehicles>0&&p.value.parkEntry.vehicles>L&&(J=!1),J},Fe=function(J){var L=p.value.parkEntry.vehicles;J.amount<10&&L<10&&(J.amount=J.amount<10?J.amount+=1:J.amount,p.value.parkEntry.vehicles++,k.value.push(JSON.parse(JSON.stringify(J)))),p.value.price=p.value.price-p.value.entryFees.entry_fee,Pe(),p.value.price=p.value.price+p.value.entryFees.entry_fee,E.value=p.value.price},he=function(J){var L=p.value.parkEntry.vehicles;if(J.amount>0&&L>0)for(var z=!1,me=J.amount-1;me>=0;me--){for(var we=k.value.length-1;we>=0;we--)if(J.description==k.value[we].description){J.amount=J.amount>0?J.amount-=1:J.amount,k.value.splice(we,1),p.value.parkEntry.vehicles--,z=!0;break}if(z)break}p.value.price=p.value.price-p.value.entryFees.entry_fee,Pe(),p.value.price=p.value.price+p.value.entryFees.entry_fee,E.value=p.value.price},Ue=function(J){p.value=JSON.parse(JSON.stringify(J.body)),p.value.arrival=ce(p.value.arrival).format("DD/MM/YYYY"),p.value.departure=ce(p.value.departure).format("DD/MM/YYYY"),q.value=p.value.campsites,i.value=p.value.arrival,x.value=p.value.departure,t.value=p.value.campground?I.value.find(z=>parseInt(z.id)===parseInt(p.value.campground)):null,Z(),oe();let L=p.value.guests;Object.keys(L).forEach(z=>{M.map(me=>(me.id==z&&(me.amount=L[z]),me))}),be(),p.value.parkEntry={vehicles:0},p.value.entryFees={vehicle:0,motorbike:0,concession:0,entry_fee:0,regos:[]},s.each(p.value.regos,(z,me)=>{Y.map(we=>(we.id==me.type&&(we.rego=me.rego,we.entry_fee=me.entry_fee,Fe(we)),we.rego="",we.entry_fee=!1,we))}),ft(()=>{F()}),setTimeout(function(){V(),w.value=!0},2e3)};return $e(function(){n.value=document.bookingForm.value,R()}),(()=>{c.commit("SET_LOADER_STATE",!0),c.commit("SET_LOADER_TEXT","Loading Booking");let J=[c.dispatch("fetchCampgrounds"),Of.fetchBooking(to.params.booking_id)];Promise.all(J).then(L=>{c.commit("SET_LOADER_STATE",!1),next(z=>{Ue(L[1])})}).catch(L=>{console.log(L)})})(),(J,L)=>(C(),S("div",Yf,[g(e("form",Uf,[e("div",Af,[e("div",Vf,[e("div",qf,[e("div",Ff,[e("div",jf,[e("h3",If,H(p.value.full_name),1)]),e("div",Hf,[e("div",Lf,[e("div",Nf,[e("div",Bf,[L[7]||(L[7]=e("div",{class:"col-md-4"},[e("label",{class:"control-label pull-left required",for:"Dates"},"Campground: ")],-1)),e("div",Gf,[g(e("select",{onChange:T,class:"form-control",name:"campground","onUpdate:modelValue":L[0]||(L[0]=z=>p.value.campground=z)},[(C(!0),S(ie,null,de(te.value,z=>(C(),S("option",{value:z.id},H(z.name),9,Jf))),256))],544),[[ke,p.value.campground]])])]),p.value.campground!=null||p.value.campground!=""?(C(),S("div",zf,[L[8]||(L[8]=e("div",{class:"col-md-4"},[e("label",{class:"control-label pull-left required",for:"Dates"},"Camp Site: ")],-1)),D.value.length>0?(C(),S("div",Xf)):fe("",!0),e("div",Wf,[g(e("select",{class:"form-control",style:{width:"100%"},id:"multi-campsites",name:"campground",placeholder:"",multiple:"","onUpdate:modelValue":L[1]||(L[1]=z=>q.value=z)},[(C(!0),S(ie,null,de(D.value,z=>(C(),S("option",{value:z.id},H(z.name)+" - "+H(z.status),9,Kf))),256))],512),[[ke,q.value]])])])):(C(),S("div",Qf,L[9]||(L[9]=[e("h4",null,"Sorry, no available campsites were found.",-1)]))),e("div",Zf,[L[12]||(L[12]=e("div",{class:"col-md-4"},[e("label",{class:"control-label pull-left required",for:"Dates"},"Dates: ")],-1)),e("div",e_,[e("div",t_,[g(e("input",{type:"text",class:"form-control",name:"arrival",placeholder:"Arrival","onUpdate:modelValue":L[2]||(L[2]=z=>i.value=z)},null,512),[[X,i.value]]),L[10]||(L[10]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])]),e("div",s_,[e("div",o_,[g(e("input",{type:"text",class:"form-control",name:"departure",placeholder:"Departure","onUpdate:modelValue":L[3]||(L[3]=z=>x.value=z)},null,512),[[X,x.value]]),L[11]||(L[11]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])]),e("div",a_,[L[16]||(L[16]=e("div",{class:"col-md-4"},[e("label",{class:"control-label pull-left required",for:"Campground"},"Guests: ")],-1)),e("div",l_,[e("div",n_,[g(e("input",{type:"text",readonly:"",class:"form-control dropdown-toggle",name:"guests",placeholder:"Guests","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true","onUpdate:modelValue":L[4]||(L[4]=z=>P.value=z)},null,512),[[X,P.value]]),e("ul",r_,[(C(),S(ie,null,de(M,z=>e("li",null,[e("div",i_,[e("div",d_,[e("span",u_,[W(H(z.amount)+" "+H(z.name)+" ",1),e("span",c_,H(z.description),1)]),L[13]||(L[13]=e("br",null,null,-1)),g(e("a",{href:"#",class:"text-info"},H(z.helpText),513),[[ae,z.helpText]])]),e("div",p_,[e("div",v_,[e("button",{type:"button",class:"btn btn-guest",onClick:_e(me=>se(z),["prevent","stop"])},L[14]||(L[14]=[e("span",{class:"glyphicon glyphicon-plus"},null,-1)]),8,m_),e("button",{type:"button",class:"btn btn-guest",onClick:_e(me=>ve(z),["prevent","stop"])},L[15]||(L[15]=[e("span",{class:"glyphicon glyphicon-minus"},null,-1)]),8,f_)])])])])),64))])])])])])])]),e("div",__,[e("div",g_,[e("div",h_,[e("div",y_,[L[21]||(L[21]=e("label",{for:"vehicles",class:"required col-md-4"},"Number of Vehicles",-1)),e("div",b_,[g(e("input",{type:"number",min:"0",max:"10",name:"vehicles",class:"form-control dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",readonly:"true","onUpdate:modelValue":L[5]||(L[5]=z=>p.value.parkEntry.vehicles=z)},null,512),[[X,p.value.parkEntry.vehicles]]),e("ul",k_,[(C(),S(ie,null,de(Y,z=>e("li",null,[e("div",$_,[e("div",C_,[e("span",w_,[W(H(z.amount)+" "+H(z.name)+" ",1),L[17]||(L[17]=e("span",{style:{color:"#888","font-weight":"300","font-size":"12px"}},null,-1))]),L[18]||(L[18]=e("br",null,null,-1)),g(e("a",{href:"#",class:"text-info"},H(z.helpText),513),[[ae,z.helpText]])]),e("div",x_,[e("div",D_,[e("button",{type:"button",class:"btn btn-guest",onClick:_e(me=>Fe(z),["prevent","stop"])},L[19]||(L[19]=[e("span",{class:"glyphicon glyphicon-plus"},null,-1)]),8,T_),e("button",{type:"button",class:"btn btn-guest",onClick:_e(me=>he(z),["prevent","stop"])},L[20]||(L[20]=[e("span",{class:"glyphicon glyphicon-minus"},null,-1)]),8,S_)])])])])),64))])])])])]),(C(!0),S(ie,null,de(k.value,z=>(C(),S("div",M_,[e("div",E_,[e("div",P_,[e("label",R_,H(z.description),1),g(e("input",{type:"text",class:"form-control vehicleLookup",required:"required","onUpdate:modelValue":me=>z.rego=me,onChange:h},null,40,O_),[[X,z.rego]])])]),y.value.entry_fee_required?(C(),S("div",Y_,[L[22]||(L[22]=e("label",null,"Entry Fee",-1)),e("div",U_,[e("label",A_,[g(e("input",{class:"form-check-input",type:"checkbox",required:"required","onUpdate:modelValue":me=>z.entry_fee=me,onChange:_},null,40,V_),[[Te,z.entry_fee]])])])])):fe("",!0)]))),256))]),e("div",q_,[w.value?(C(),S("div",F_,[e("div",j_,[e("div",I_,[L[24]||(L[24]=e("label",{class:"col-md-4",for:"Total Price"},[W("Total Price "),e("span",{class:"text-muted"},"(GST inclusive.)")],-1)),e("div",H_,[e("div",L_,[L[23]||(L[23]=e("span",{class:"input-group-addon"},[W("AUD "),e("i",{class:"fa fa-usd"})],-1)),e("input",{type:"text",class:"form-control",placeholder:J.$filters.formatMoney(0,2),value:J.$filters.formatMoney(E.value,2),readonly:"true"},null,8,N_)])])]),e("div",B_,[L[26]||(L[26]=e("label",{class:"col-md-4",for:"Old Total Price"},[W("Old Total Price "),e("span",{class:"text-muted"},"(GST inclusive.)")],-1)),e("div",G_,[e("div",J_,[L[25]||(L[25]=e("span",{class:"input-group-addon"},[W("AUD "),e("i",{class:"fa fa-usd"})],-1)),e("input",{type:"text",class:"form-control",placeholder:J.$filters.formatMoney(0,2),value:J.$filters.formatMoney(p.value.cost_total,2),readonly:"true"},null,8,z_)])])]),e("div",X_,[L[28]||(L[28]=e("label",{class:"col-md-4",for:"Amount Paid"},"Amount Paid",-1)),e("div",W_,[e("div",K_,[L[27]||(L[27]=e("span",{class:"input-group-addon"},[W("AUD "),e("i",{class:"fa fa-usd"})],-1)),e("input",{type:"text",class:"form-control",placeholder:J.$filters.formatMoney(0,2),value:J.$filters.formatMoney(p.value.amount_paid,2),readonly:"true"},null,8,Q_)])])])])])):fe("",!0)])]),L[29]||(L[29]=e("div",{class:"row"},null,-1)),e("div",Z_,[e("div",eg,[e("button",{type:"button",disabled:D.value.length==0,class:"btn btn-primary btn-lg pull-right",style:{"margin-top":"15px"},onClick:L[6]||(L[6]=z=>Je())},"Save Changes",8,tg)])])])])])],512),[[ae,!B.value]]),ee(He,{isLoading:B.value},{default:ue(()=>[W(H(b.value.join(" , "))+"...",1)]),_:1},8,["isLoading"])]))}},og={},ag={class:"wrapper"};function lg(o,c){const v=nt("router-link");return C(),S("div",ag,[e("div",null,[c[1]||(c[1]=e("h1",null,"Oops 404 not found",-1)),c[2]||(c[2]=e("p",null,[W(" The page you are looking for could not be found."),e("br"),W(" Check the address bar to ensure your URL is spelled correctly. If all else fails, you can visit our dashboard page at the link below. ")],-1)),ee(v,{to:{name:"cg_main"}},{default:ue(()=>c[0]||(c[0]=[W("Visit Dashboard Page")])),_:1})])])}const ng=et(og,[["render",lg]]),rg={id:"report-form"},ig={class:"well well-sm"},dg={class:"row"},ug={class:"col-lg-12"},cg={class:"col-lg-12"},pg={class:"row"},vg={class:"col-md-6"},mg={class:"form-group"},fg=["value"],_g={class:"col-md-6"},gg={class:"form-group"},hg=["value"],yg={class:"well"},bg={class:"row"},kg={class:"col-md-12"},$g={class:"row"},Cg={class:"row"},wg={class:"col-sm-6"},xg={class:"col-sm-6 clearfix"},Dg={class:"well well-sm"},Tg={class:"row"},Sg={class:"col-lg-12"},Mg={class:"row"},Eg={class:"col-lg-12"},Pg={class:"col-sm-6"},Rg={class:"well well-sm"},Og={class:"row"},Yg={class:"col-lg-12"},Ug={class:"row"},Ag={class:"col-sm-12"},Vg={class:"row"},qg={class:"col-sm-6"},Fg={class:"form-group"},jg={class:"form-group"},Ig={class:"col-sm-6"},Hg={class:"form-group"},Lg={class:"form-group"},Ng={class:"well well-sm"},Bg={class:"row"},Gg={class:"col-lg-12"},Jg={class:"row"},zg={class:"col-lg-12"},Xg={class:"col-sm-6"},Wg={class:"form-group"},Kg={class:"form-group"},Qg={class:"col-sm-6"},Zg={class:"checkbox"},eh={__name:"reports",setup(o){const c=a(null),v=a(null),n=a(null),d=a(null),i=a(null),x=a(null),O=a(null),p=a(null),D=a(null),b=a(null),P=a(null),t=a(null),M=a(null),Y=a(null),y=a([]),k=a(""),U=a(""),$=a({code:"",name:"",districts:[]}),u=a(!1);ge(()=>k,function(I){U.value="",I?$.value=y.value.find(h=>h.code==I):$.value={code:"",name:"",districts:[]}});const f=function(){if(n.value.valid()){const I=d.value.dates.lastPicked;let h=I?ne.formatDate(I,"dd/MM/yyyy"):"",T=u.value?"true":"false";fetch("/api/oracle_job?date="+h+"&override="+T).then(R=>{mt({type:"success",title:"Job Success",text:"The oracle job was completed successfully"})}).catch(R=>{mt({type:"error",title:"Oracle Job Error",text:re.apiVueResourceError(R)})})}},q=function(){if(i.value.valid()){const h=O.value.dates.lastPicked;var I="/api/reports/booking_settlements?date="+(h?ne.formatDate(h,"dd/MM/yyyy"):"");window.location.assign(I)}},A=function(){if(x.value.valid()){const h=p.value.dates.lastPicked;var I="/api/reports/bookings?date="+(h?ne.formatDate(h,"dd/MM/yyyy"):"");window.location.assign(I)}},w=function(){var I=m();I&&(I.flat=!1,te(I))},m=function(){if(c.value.valid()){var I={system:"S019",start:k.value?ne.formatDate(new Be(P.value.dates.lastPicked).startOf("date"),"yyyy-MM-dd H:mm:ss"):ne.formatDate(new Be(D.value.dates.lastPicked).startOf("date"),"yyyy-MM-dd H:mm:ss"),end:k.value?ne.formatDate(new Be(t.value.dates.lastPicked).startOf("date"),"yyyy-MM-dd H:mm:ss"):ne.formatDate(new Be(b.value.dates.lastPicked).startOf("date"),"yyyy-MM-dd H:mm:ss"),banked_start:ne.formatDate(new Be(P.value.dates.lastPicked).startOf("date"),"yyyy-MM-dd H:mm:ss"),banked_end:ne.formatDate(new Be(t.value.dates.lastPicked).startOf("date"),"yyyy-MM-dd H:mm:ss")};return k.value&&(I.region=k.value,U.value&&(I.district=U.value)),I}return!1},E=function(){var I=m();I&&(I.items=!0,te(I))},B=function(){if(v.value.valid()){var I={start:ne.formatDate(M.value.dates.lastPicked,"dd/MM/yyyy"),end:ne.formatDate(Y.value.dates.lastPicked,"dd/MM/yyyy")},h=G.booking_refunds+"?"+s.param(I);window.location.assign(h)}else console.log("invalid form")},te=function(I){var h="/ledger/payments/api/report?"+s.param(I);window.location.assign(h)};return(I,h)=>(C(),S("div",rg,[e("form",{method:"get",ref_key:"paymentsForm",ref:c,action:"/ledger/payments/api/report"},[e("div",ig,[e("div",dg,[e("div",ug,[e("div",cg,[h[13]||(h[13]=e("h3",{style:{"margin-bottom":"20px"}},"Select Region",-1)),e("div",pg,[e("div",vg,[e("div",mg,[h[10]||(h[10]=e("label",{for:""},"Region",-1)),g(e("select",{class:"form-control",name:"region","onUpdate:modelValue":h[0]||(h[0]=T=>k.value=T)},[h[9]||(h[9]=e("option",{value:""},"Kensington",-1)),(C(!0),S(ie,null,de(y.value,T=>(C(),S("option",{value:T.code},H(T.name),9,fg))),256))],512),[[ke,k.value]])])]),g(e("div",_g,[e("div",gg,[h[12]||(h[12]=e("label",{for:""},"District",-1)),g(e("select",{class:"form-control",name:"region","onUpdate:modelValue":h[1]||(h[1]=T=>U.value=T)},[h[11]||(h[11]=e("option",{value:""},"All",-1)),(C(!0),S(ie,null,de($.value.districts,T=>(C(),S("option",{value:T.code},H(T.name),9,hg))),256))],512),[[ke,U.value]])])],512),[[ae,k.value]])])])])])]),e("div",yg,[e("div",bg,[e("div",kg,[h[15]||(h[15]=e("h3",{style:{"margin-bottom":"20px"}},"Payments Reports",-1)),g(e("div",$g,h[14]||(h[14]=[Qe('<div class="col-md-6"><div class="form-group"><label for="">Start Date</label><div class="input-group date" id="accountsDateStartPicker"><input type="text" class="form-control" name="start" placeholder="DD/MM/YYYY" required><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div><div class="col-md-6"><div class="form-group"><label for="">End Date</label><div class="input-group date" id="accountsDateEndPicker"><input type="text" class="form-control" name="end" placeholder="DD/MM/YYYY" required><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div>',2)]),512),[[ae,!k.value]]),h[16]||(h[16]=Qe('<div class="row" style="margin-top:20px;"><div class="col-md-6"><div class="form-group"><label for="">Bank Start Date</label><div class="input-group date" id="flatDateStartPicker"><input type="text" class="form-control" name="banked_start" placeholder="DD/MM/YYYY" required><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div><div class="col-md-6"><div class="form-group"><label for="">Bank End Date</label><div class="input-group date" id="flatDateEndPicker"><input type="text" class="form-control" name="banked_end" placeholder="DD/MM/YYYY" required><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div></div>',1)),e("div",Cg,[e("div",wg,[e("button",{onClick:h[2]||(h[2]=_e(T=>E(),["prevent"])),class:"btn btn-primary pull-left"},"Generate Report By Accounts")]),e("div",xg,[e("button",{onClick:h[3]||(h[3]=_e(T=>w(),["prevent"])),class:"btn btn-primary pull-left"},"Generate Report Flat")])])])])])],512),e("form",{id:"refund_form",ref_key:"refund_form",ref:v},[e("div",Dg,[e("div",Tg,[e("div",Sg,[h[17]||(h[17]=Qe('<div class="col-lg-12"><h3 style="margin-bottom:20px;">Refunds Reports</h3></div><div class="col-md-6"><div class="form-group"><label for="">Start Date</label><div class="input-group date" id="refundsStartPicker"><input type="text" class="form-control" name="refund_start_date" placeholder="DD/MM/YYYY"><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div><div class="col-md-6"><div class="form-group"><label for="">End Date</label><div class="input-group date" id="refundsEndPicker"><input type="text" class="form-control" name="refund_end_date" placeholder="DD/MM/YYYY"><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div>',3)),e("div",Mg,[e("div",Eg,[e("div",Pg,[e("button",{onClick:h[4]||(h[4]=_e(T=>B(),["prevent"])),class:"btn btn-primary pull-left"},"Generate Refund Reports")])])])])])])],512),e("div",Rg,[e("div",Og,[e("div",Yg,[e("div",Ug,[e("div",Ag,[e("div",Vg,[e("div",qg,[e("form",{ref_key:"booking_settlements_form",ref:i},[h[20]||(h[20]=e("h3",{style:{"margin-bottom":"20px"}},"Settlement Report",-1)),e("div",Fg,[h[19]||(h[19]=e("label",{for:""},"Date",-1)),e("div",{class:"input-group date",ref_key:"bookingSettlementsDatePicker",ref:O,id:"bookingSettlementsDatePickerElement"},h[18]||(h[18]=[e("input",{type:"text",class:"form-control",name:"booking_settlement_date",placeholder:"DD/MM/YYYY",required:""},null,-1),e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1)]),512)]),e("div",jg,[e("button",{onClick:h[5]||(h[5]=_e(T=>q(),["prevent"])),class:"btn btn-primary pull-left"},"Generate Settlement Report")])],512)]),e("div",Ig,[e("form",{ref_key:"bookings_form",ref:x},[h[23]||(h[23]=e("h3",{style:{"margin-bottom":"20px"}},"Bookings Report",-1)),e("div",Hg,[h[22]||(h[22]=e("label",{for:""},"Date",-1)),e("div",{class:"input-group date",ref_key:"bookingsDatePicker",ref:p,id:"bookingsDatePickerElement"},h[21]||(h[21]=[e("input",{type:"text",class:"form-control",name:"bookings_date",placeholder:"DD/MM/YYYY",required:""},null,-1),e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1)]),512)]),e("div",Lg,[e("button",{onClick:h[6]||(h[6]=_e(T=>A(),["prevent"])),class:"btn btn-primary pull-left"},"Generate Bookings Report")])],512)])])])])])])]),e("form",{ref_key:"oracle_form",ref:n},[e("div",Ng,[e("div",Bg,[e("div",Gg,[h[27]||(h[27]=e("div",{class:"col-lg-12"},[e("h3",{style:{"margin-bottom":"20px"}},"Oracle Job")],-1)),e("div",Jg,[e("div",zg,[e("div",Xg,[e("div",Wg,[h[25]||(h[25]=e("label",{for:""},"Date",-1)),e("div",{class:"input-group date",ref_key:"oracleDatePicker",ref:d,id:"oracleDatePickerElement"},h[24]||(h[24]=[e("input",{type:"text",class:"form-control",name:"oracle_date",placeholder:"DD/MM/YYYY",required:""},null,-1),e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1)]),512)]),e("div",Kg,[e("button",{onClick:h[7]||(h[7]=_e(T=>f(),["prevent"])),class:"btn btn-primary pull-left"},"Run Job")])]),e("div",Qg,[e("div",Zg,[e("label",null,[g(e("input",{"onUpdate:modelValue":h[8]||(h[8]=T=>u.value=T),type:"checkbox",value:""},null,512),[[Te,u.value]]),h[26]||(h[26]=W("Override closed period check"))])])])])])])])])],512)]))}},th={id:"campsite-type-dash"},sh={class:"card p-3",id:"applications"},oh={id:"applications-collapse",class:"",role:"tabpanel","aria-labelledby":"applications-heading"},ah={class:"panel-body"},lh={id:"groundsList"},nh={class:"form",id:"campgrounds-filter-form"},rh={class:"row"},ih={class:"col-md-8"},dh={class:"col-md-6"},uh={class:"form-group"},ch={__name:"campsite-types-dash",setup(o){const c=Ne(),v=a("All"),n=a(null),d=a(null),i=a({icon:"<i class='fa fa-exclamation-triangle fa-2x text-danger' aria-hidden='true'></i>",message:"Are you sure you want to Delete this campsite type",buttons:[{text:"Delete",event:"delete",bsColor:"btn-danger",handler:function(){p(d.value),d.value=null},autoclose:!0}],id:"deleteCampsiteType"}),x=["Name","Status","Action"],O=a({language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"},responsive:!0,processing:!0,columnDefs:[{defaultContent:"-",targets:"_all"},{responsivePriority:1,targets:0},{responsivePriority:2,targets:1},{responsivePriority:3,targets:2}],ajax:{url:G.campsite_classes,dataSrc:""},columns:[{data:"name",mRender:function(b,P,t){const Y=b.length>120?"class='name_popover'":"",y=b.length>120?b.substring(0,119)+"...":b;return("<td> <div "+Y+'tabindex="0" data-toggle="popover" data-placement="top" data-content="__NAME__" >'+y+"</div></td>").replace("__NAME__",b)}},{data:"deleted",mRender:function(b,P,t){const M=b?"Deleted":"Active";return"<td >__Status__</td>".replace("__Status__",M)}},{mRender:function(b,P,t){if(t.id,!t.deleted){var M=`<td ><a href='#' class="detailRoute" data-campsite-type='__ID__'> Edit</a> </br> `;return M+=`<a href='#' class="deleteCT" data-campsite-type='__ID__'> Delete</a> </td>`,M.replace(/__ID__/g,t.id)}return""}}]});ge(()=>v,b=>{b&&n.value.vmDataTable.ajax.reload()});const p=function(b){var P=G.campsite_class(b);s.ajax({method:"DELETE",url:P,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).done(function(t){n.value.vmDataTable.ajax.reload()})},D=function(){n.value.vmDataTable.on("click",".detailRoute",function(b){b.preventDefault();var P=s(this).data("campsite-type");c.push({name:"campsite-type-detail",params:{campsite_type_id:P}})}),n.value.vmDataTable.on("click",".deleteCT",function(b){b.preventDefault();var P=s(this).data("campsite-type");d.value=P,Ie.emit("showAlert","deleteCampsiteType")})};return $e(()=>{re.namePopover(s,n.value.vmDataTable),D()}),(b,P)=>{const t=nt("router-link");return C(),S("div",th,[e("div",sh,[ee(Dt,{title:"Campsite Types"},{default:ue(()=>[ee(t,{to:{name:"add-campsite-type"},style:{"margin-top":"20px"},class:"btn btn-primary table_btn"},{default:ue(()=>P[1]||(P[1]=[W("Add Campsite Type")])),_:1})]),_:1}),e("div",oh,[e("div",ah,[e("div",lh,[e("form",nh,[e("div",rh,[e("div",ih,[e("div",dh,[e("div",uh,[P[3]||(P[3]=e("label",{for:"campgrounds-filter-status"},"Status: ",-1)),g(e("select",{"onUpdate:modelValue":P[0]||(P[0]=M=>v.value=M),class:"form-control"},P[2]||(P[2]=[e("option",{value:"All"},"All",-1),e("option",{value:"Active"},"Active",-1),e("option",{value:"Deleted"},"Deleted",-1)]),512),[[ke,v.value]])])])])])]),ee(Xe,{dtOptions:O.value,dtHeaders:x,ref_key:"campsite_type_table",ref:n,id:"campsite-type-table"},null,8,["dtOptions"])])])])]),ee(rt,{id:"deleteCampsiteType",options:i.value},null,8,["options"])])}}},ph={class:"row",style:{"margin-top":"40px"}},vh={class:"col-md-12"},mh={class:"form-group"},fh={__name:"editor",props:{modelValue:{},modelModifiers:{}},emits:Nt(["input"],["update:modelValue"]),setup(o,{expose:c,emit:v}){const n=Bt(o,"modelValue"),d=v;let i=null;const x="editor"+crypto.randomUUID();return c({disabled:function(D){i.enable(!D)},updateContent:function(D){i.setText(""),i.clipboard.dangerouslyPasteHTML(0,D,"api"),d("input",D)},editor_id:x}),$e(function(){i=new $t("#"+x,{modules:{toolbar:!0},theme:"snow"}),i.on("text-change",function(b,P,t){var M=s("#"+x+" >.ql-editor").html();n.value=M});var D=setInterval(function(){typeof n.value<"u"&&(i.clipboard.dangerouslyPasteHTML(0,n.value,"api"),clearInterval(D))},100)}),(D,b)=>(C(),S("div",ph,[e("div",vh,[e("div",mh,[Ke(D.$slots,"label",{},()=>[b[0]||(b[0]=e("label",{class:"control-label"},"Description",-1))],!0),e("div",{id:x,class:"form-control editor"})])])]))}},_h=et(fh,[["__scopeId","data-v-1bd8f839"]]),gh={id:"select-panel"},hh={class:"row",style:{"margin-top":"40px"}},yh={class:"col-sm-6 options"},bh={class:"panel panel-primary"},kh={class:"list-group"},$h=["onClick"],Ch={class:"col-sm-6 options"},wh={class:"panel panel-primary"},xh={class:"list-group"},Dh=["onClick"],Th={__name:"select-panel",props:{options:{type:Array,required:!0,default:()=>[]},disabled:{type:Boolean,default:!1},selected:{type:Array,required:!0,default:()=>[]}},emits:["onChange"],setup(o,{expose:c,emit:v}){const n=o,d=a(!1),i=a(n.options),x=a(n.selected),O=Q(()=>!(i.value.length>0)),p=Q(()=>x.value.length>0),D=v,b=function(Y,y){x.value.push(Y),i.value.splice(y,1),x.value.sort(function(k,U){return parseInt(k.id)-parseInt(U.id)}),D("onChange",x.value)},P=function(Y,y){i.value.push(Y),x.value.splice(y,1),i.value.sort(function(k,U){return parseInt(k.id)-parseInt(U.id)}),D("onChange",x.value)},t=function(Y){d.value=!Y},M=function(Y){s.each(Y,function(y,k){s.each(i.value,function(U,$){$!=null&&k.id==$.id&&(i.value.splice(U,1),x.value.push(k))})})};return ge(()=>n.options,Y=>{i.value=Y}),ge(()=>n.selected,Y=>{x.value=Y}),c({enabled:t,loadSelectedFeatures:M,selectedRef:x,optionsRef:i}),(Y,y)=>(C(),S("div",gh,[e("div",hh,[e("div",yh,[e("div",bh,[y[2]||(y[2]=e("div",{class:"panel-heading"},[e("h3",{class:"panel-title"},"Features")],-1)),e("div",{class:Le(["panel-body",{"empty-options":O.value}])},[g(e("p",null," All options selected ",512),[[ae,O.value]]),e("ul",kh,[(C(!0),S(ie,null,de(i.value,(k,U)=>g((C(),S("a",{href:"",onClick:_e($=>b(k,U),["prevent"]),class:"list-group-item list-group-item-primary"},H(k.name),9,$h)),[[ae,!d.value]])),256)),(C(!0),S(ie,null,de(i.value,(k,U)=>g((C(),S("a",{href:"",onClick:y[0]||(y[0]=_e(()=>{},["prevent","stop"])),class:"list-group-item disabled"},H(k.name),513)),[[ae,d.value]])),256))])],2)])]),e("div",Ch,[e("div",wh,[y[3]||(y[3]=e("div",{class:"panel-heading"},[e("h3",{class:"panel-title"},"Selected Features")],-1)),e("div",{class:Le(["panel-body",{"empty-options":!p.value}])},[g(e("p",null," No options selected ",512),[[ae,!p.value]]),e("ul",xh,[(C(!0),S(ie,null,de(x.value,(k,U)=>g((C(),S("a",{href:"",onClick:_e($=>P(k,U),["prevent"]),class:"list-group-item"},H(k.name),9,Dh)),[[ae,!d.value]])),256)),(C(!0),S(ie,null,de(x.value,(k,U)=>g((C(),S("a",{href:"",onClick:y[1]||(y[1]=_e(()=>{},["prevent","stop"])),class:"list-group-item disabled"},H(k.name),513)),[[ae,d.value]])),256))])],2)])])])]))}},Sh={id:"campsite-type"},Mh={class:"card p-3",id:"applications"},Eh={id:"applications-collapse",class:"",role:"tabpanel","aria-labelledby":"applications-heading"},Ph={class:"panel-body"},Rh={class:"col-lg-12"},Oh={class:"row"},Yh={class:"panel panel-primary"},Uh={class:"panel-heading"},Ah={class:"panel-title"},Vh={class:"panel-body"},qh={class:"row"},Fh={class:"col-md-6"},jh={class:"form-group"},Ih={class:"col-md-6"},Hh={class:"form-group"},Lh={class:"row"},Nh={class:"col-md-6"},Bh={class:"form-group"},Gh={class:"col-md-6"},Jh={class:"form-group"},zh={class:"row"},Xh={class:"col-md-6"},Wh={class:"form-group"},Kh={class:"checkbox"},Qh={class:"checkbox-inline"},Zh={class:"checkbox"},e1={class:"checkbox-inline"},t1={class:"checkbox"},s1={class:"checkbox-inline"},o1={class:"row"},a1={class:"col-sm-12"},l1={class:"form-group pull-right"},n1={key:0,class:"col-lg-12"},bt={__name:"campsite-type",setup(o){const c=Ne(),v=lt(),n=a(!1),d=a(null),i=a({}),x=a([]),O=a([]),p=a(!0),D=a(null),b=a(null),P=a({responsive:!0,processing:!0,deferRender:!0,order:[[0,"desc"]],ajax:{url:v.params.campsite_type_id?G.campsiteclass_price_history(v.params.campsite_type_id):void 0,dataSrc:""},columns:[{data:"date_start",mRender:function(w,m,E){return ce(w).format("MMMM Do, YYYY")}},{data:"date_end",mRender:function(w,m,E){return w?ce(w).add(1,"day").format("MMMM Do, YYYY"):""}},{data:"adult"},{data:"concession"},{data:"child"},{data:"details",mRender:function(w,m,E){return w||""}},{data:"editable",mRender:function(w,m,E){if(w){E.id;var B=`<td ><a href='#' class='editPrice' data-date_start="__START__"  data-date_end="__END__"  data-rate="__RATE__" data-reason="__REASON__" data-details="__DETAILS__">Edit</a><br/>`;return E.deletable&&(B+=`<a href='#' class='deletePrice' data-date_start="__START__"  data-date_end="__END__"  data-rate="__RATE__" data-reason="__REASON__" data-details="__DETAILS__">Delete</a></td>`),B=B.replace(/__START__/g,E.date_start),B=B.replace(/__END__/g,E.date_end),B=B.replace(/__RATE__/g,E.rate_id),B=B.replace(/__REASON__/g,E.reason),B=B.replace(/__DETAILS__/g,E.details),B}else return""}}],language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"}}),t=Q(()=>parseInt(b.value)),M=Q(()=>i.value.can_add_rate?i.value.can_add_rate:!1),Y=Q(()=>G.deleteCampsiteClassPrice(t.value)),y=function(){U(),v.params.campsite_type_id&&(p.value=!1,f())},k=function(){c.go(window.history.back())},U=function(){var w=G.features;s.ajax({url:w,dataType:"json",headers:{"X-CSRFToken":re.getCookie("csrftoken")},success:function(m,E,B){x.value=m}})},$=function(){q(G.campsite_classes,"POST")},u=function(){q(G.campsite_class(i.value.id),"PUT")},f=function(){s.ajax({url:G.campsite_class(v.params.campsite_type_id),method:"GET",xhrFields:{withCredentials:!0},dataType:"json",headers:{"X-CSRFToken":re.getCookie("csrftoken")},success:function(w,m,E){i.value=w,D.value.loadSelectedFeatures(w.features),i.value.features=D.value.selectedRef.map(B=>B.url),n.value=!1},error:function(w){n.value=!1,w.status==404&&c.push({name:"404"})}})},q=function(w,m){n.value=!0;const E=i.value;s.ajax({beforeSend:function(B){B.setRequestHeader("Content-Type","application/json"),B.setRequestHeader("Accept","application/json")},xhrFields:{withCredentials:!0},url:w,headers:{"X-CSRFToken":re.getCookie("csrftoken")},method:m,data:JSON.stringify(E),success:function(B){m=="POST"?c.push({name:"campsite-type-detail",params:{campsite_type_id:B.id}},function(){y()}):(d.value=B,setTimeout(function(){n.value=!1},500))},error:function(B){window.alert("an error ocurred"),n.value=!1}})};$e(()=>{b.value=v.params.campsite_type_id,y()});const A=w=>{i.value.features=D.value.selectedRef.map(m=>m.url)};return(w,m)=>(C(),S("div",Sh,[e("div",Mh,[e("div",Eh,[e("div",Ph,[e("div",Rh,[e("div",Oh,[g(e("form",null,[e("div",Yh,[e("div",Uh,[e("h3",Ah,H(p.value?"New":"Edit")+" Campsite Type ",1)]),e("div",Vh,[e("div",qh,[e("div",Fh,[e("div",jh,[m[10]||(m[10]=e("label",{class:"control-label"},"Name",-1)),g(e("input",{type:"text",name:"name",class:"form-control","onUpdate:modelValue":m[0]||(m[0]=E=>i.value.name=E),required:""},null,512),[[X,i.value.name]])])]),e("div",Ih,[e("div",Hh,[m[11]||(m[11]=e("label",{class:"control-label"},"Maximum Number of Vehicles",-1)),g(e("input",{type:"number",name:"max_vehicles",class:"form-control","onUpdate:modelValue":m[1]||(m[1]=E=>i.value.max_vehicles=E),required:""},null,512),[[X,i.value.max_vehicles]])])])]),e("div",Lh,[e("div",Nh,[e("div",Bh,[m[12]||(m[12]=e("label",{class:"control-label"},"Minimum Number of People",-1)),g(e("input",{type:"number",name:"name",class:"form-control","onUpdate:modelValue":m[2]||(m[2]=E=>i.value.min_people=E),required:""},null,512),[[X,i.value.min_people]])])]),e("div",Gh,[e("div",Jh,[m[13]||(m[13]=e("label",{class:"control-label"},"Maximum Number of People",-1)),g(e("input",{type:"number",name:"name",class:"form-control","onUpdate:modelValue":m[3]||(m[3]=E=>i.value.max_people=E),required:""},null,512),[[X,i.value.max_people]])])])]),e("div",zh,[e("div",Xh,[e("div",Wh,[e("div",Kh,[e("label",Qh,[g(e("input",{type:"checkbox","onUpdate:modelValue":m[4]||(m[4]=E=>i.value.tent=E)},null,512),[[Te,i.value.tent]]),m[14]||(m[14]=W("Tent"))])]),e("div",Zh,[e("label",e1,[g(e("input",{type:"checkbox","onUpdate:modelValue":m[5]||(m[5]=E=>i.value.campervan=E)},null,512),[[Te,i.value.campervan]]),m[15]||(m[15]=W("Campervan"))])]),e("div",t1,[e("label",s1,[g(e("input",{type:"checkbox","onUpdate:modelValue":m[6]||(m[6]=E=>i.value.caravan=E)},null,512),[[Te,i.value.caravan]]),m[16]||(m[16]=W("Caravan"))])])])])]),ee(Th,{ref_key:"select_features",ref:D,options:x.value,selected:O.value,id:"select-features",onOnChange:A},null,8,["options","selected"]),ee(_h,{ref:"descriptionEditor",modelValue:i.value.description,"onUpdate:modelValue":m[7]||(m[7]=E=>i.value.description=E)},null,8,["modelValue"]),e("div",o1,[e("div",a1,[e("div",l1,[g(e("button",{type:"button",style:{"margin-right":"5px"},onClick:m[8]||(m[8]=E=>$()),class:"btn btn-primary"},"Create",512),[[ae,p.value]]),g(e("button",{type:"button",style:{"margin-right":"5px"},onClick:m[9]||(m[9]=E=>u()),class:"btn btn-primary"},"Update",512),[[ae,!p.value]]),e("button",{type:"button",class:"btn btn-default pull-right",onClick:k},"Cancel")])])])])])],512),[[ae,!n.value]]),ee(He,{isLoading:n.value},{default:ue(()=>m[17]||(m[17]=[W("Saving Campsite Type Data...")])),_:1},8,["isLoading"])])]),p.value?fe("",!0):(C(),S("div",n1,[ee(dt,{level:"campsite_class",showAddBtn:M.value,ref:"price_dt",object_id:t.value,dt_options:P.value,historyDeleteURL:Y.value},null,8,["showAddBtn","object_id","dt_options","historyDeleteURL"])]))])])])]))}},r1={id:"bulkpricing"},i1={class:"card p-3",id:"applications"},d1={id:"applications-collapse",class:"",role:"tabpanel","aria-labelledby":"applications-heading"},u1={class:"panel-body"},c1={class:"round-box px-3 mt-4"},p1={class:"row"},v1={class:"col-lg-12"},m1={class:"row"},f1={class:"col-md-3"},_1={class:"radio"},g1={for:""},h1=["value"],y1={class:"col-md-3"},b1={class:"radio"},k1={for:""},$1=["value"],C1={class:"round-box px-3 mt-4"},w1={class:"row"},x1={class:"col-lg-12"},D1={name:"bulkpricingForm",class:"form-horizontal"},T1={class:"form-group"},S1={class:"col-md-2"},M1={class:"control-label"},E1={class:"col-md-4"},P1={class:"col-md-4"},R1={name:"tmpPark",class:"form-control"},O1=["value"],Y1={class:"col-md-4"},U1={name:"tmpCampsiteType",class:"form-control"},A1=["value"],V1={class:"form-group"},q1={class:"col-md-4"},F1={name:"tmpCampground",class:"form-control"},j1=["value"],I1={class:"form-group"},H1={class:"col-sm-4"},L1=["value"],N1={class:"form-group"},B1={class:"col-md-4"},G1=["readonly"],J1={class:"form-group"},z1={class:"col-md-4"},X1=["readonly"],W1={class:"form-group"},K1={class:"col-md-4"},Q1=["readonly"],Z1={class:"form-group"},ey={class:"col-md-4"},ty={class:"input-group date"},sy={class:"form-group"},oy={class:"col-md-5"},ay=["required"],ly={class:"btn-group btn-group-sm pt-3"},ny={class:"card p-3 mt-4"},ry={id:"parkentry-collapse",class:"",role:"tabpanel","aria-labelledby":"parkentry-heading"},iy={class:"panel-body"},dy={class:"col-lg-12"},uy={__name:"bulkpricing",emits:["updatePriceHistory","addPriceHistory"],setup(o,{emit:c}){const v=Ge(),n=["Price Tariff","Park","Campsite Type"],d=["Period Start","Period End","Car","Concession","Motorbike","Campervan","Caravan","Trailer","GST","Comment","Action"],i=a("");a("");const x=a(""),O=a([]),p=a(!1),D=a(""),b=a([]),P=a(null),t=a({reason:"",campgrounds:[]}),M=a([]),Y=a([]),y=a(!1),k=a({responsive:!0,processing:!0,ordering:!1,deferRender:!0,ajax:{url:G.park_price_history(),dataSrc:""},columns:[{data:"period_start",mRender:function(R,_,V){return ce(R).format("DD/MM/YYYY")}},{data:"period_end",mRender:function(R,_,V){return R?ce(R).format("DD/MM/YYYY"):""}},{data:"vehicle"},{data:"concession"},{data:"motorbike"},{data:"campervan"},{data:"caravan"},{data:"trailer"},{data:"gst"},{data:"reason",mRender:function(R,_,V){return R.id==1?R.text+":"+V.details:R.text}},{data:"editable",mRender:function(R,_,V){if(R){var oe=V.id,Z=`<td ><a href='#' class='editPrice' data-rate="__RATE__" >Edit</a><br/>`;return Z+=`<a href='#' class='deletePrice' data-rate="__RATE__" >Delete</a></td>`,Z=Z.replace(/__RATE__/g,oe),Z}else return""}}],language:{processing:"<i class='fa fa-4x fa-spinner fa-spin'></i>"}}),U=Q(function(){return p.value}),$=Q(function(){return t.value.reason=="1"}),u=Q(function(){if(b.value.length>0)return!0;setTimeout(function(R){s(P.value.park).select2({theme:"bootstrap",allowClear:!0,placeholder:"Select Park"}).on("select2:select",function(_){var V=s(_.currentTarget);t.value.park=V.val(),m()}).on("select2:unselect",function(_){s(_.currentTarget),t.value.park=""})},100)}),f=Q(()=>v.getters.parks),q=Q(()=>v.getters.campsite_classes);ge(()=>i.value,function(R){R==n[2]&&setTimeout(function(){s(P.value.campsiteType).select2({theme:"bootstrap",allowClear:!0,placeholder:"Select Campsite Type"}).on("select2:select",function(_){var V=s(_.currentTarget);t.value.campsiteType=V.val()}).on("select2:unselect",function(_){var V=s(_.currentTarget);t.value.campsiteType=V.val()})},100)}),ge(()=>x.value,function(R){R!=""?s.each(O.value,function(_,V){V.id==R&&(t.value.rate=V.id,t.value.adult=V.adult,t.value.concession=V.concession,t.value.child=V.child)}):(delete t.value.rate,t.value.adult="",t.value.concession="",t.value.child="")}),ge(()=>q.value,function(R){A()});const A=function(){b.value.push("Loading CampsiteTypes"),Y.value=[],s.each(q.value,function(R,_){_.can_add_rate&&Y.value.push(_)}),Y.value.length==0&&Y.value.push({id:"",name:""}),b.value.splice("Loading CampsiteTypes",1)},w=function(){if(s(P.value).valid()){b.value.push("Updating prices...");var R=JSON.parse(JSON.stringify(t.value)),_=G.bulkPricing();R.type=i.value,s.ajax({beforeSend:function(V){V.setRequestHeader("Content-Type","application/json"),V.setRequestHeader("Accept","application/json")},method:"POST",url:_,xhrFields:{withCredentials:!0},data:JSON.stringify(R),headers:{"X-CSRFToken":re.getCookie("csrftoken")},success:function(V){setTimeout(function(){b.value.splice("Updating prices...",1),t.value={reason:"",campgrounds:[]},y.value=!0},500)},error:function(V){b.value.splice("Updating prices...",1),p.value=!0,D.value=V}})}else p.value=!0,D.value="Please fill all details"},m=function(){var R=t.value.park;M.value=[],s.each(f.value,function(_,V){V.id==R&&(s.each(V.campgrounds,function(oe,Z){Z.price_level==0&&M.value.push(Z)}),setTimeout(function(oe){s(P.value.campground).select2({theme:"bootstrap",allowClear:!0,placeholder:{text:"Select Campground",selected:"selected"}}).on("select2:select",function(Z){var F=s(Z.currentTarget);t.value.campgrounds=F.val()}).on("select2:unselect",function(Z){var F=s(Z.currentTarget);t.value.campgrounds=F.val()})},100))})},E=function(){},B=function(){b.value.push("Loading Parks"),f.value.length==0&&v.dispatch("fetchParks"),b.value.splice("Loading Parks",1)},te=function(){b.value.push("Loading Rates"),fetch(G.rates).then(R=>{O.value=R,b.value.splice("Loading Rates",1)}).catch(R=>{console.log(R)})},I=function(){q.value.length==0?v.dispatch("fetchCampsiteClasses"):A()},h=function(){router.go(window.history.back())},T=function(){s(P.value).validate({rules:{park:{required:{depends:function(R){return i.value==n[1]}}},campground:{required:{depends:function(R){return i.value==n[1]}}},campsiteType:{required:{depends:function(R){return i.value==n[2]}}},adult:"required",concession:"required",child:"required",period_start:"required",open_reason:"required",details:{required:{depends:function(R){return t.value.reason==="1"}}}},messages:{adult:"Enter an adult rate",concession:"Enter a concession rate",child:"Enter a child rate",period_start:"Enter a start date",details:"Details required if Other reason is selected"},showErrors:function(R,_){s.each(this.validElements(),function(Z,F){var se=s(F);se.attr("data-original-title","").parents(".form-group").removeClass("has-error")}),s("."+this.settings.validClass).tooltip("destroy");for(var V=0;V<_.length;V++){var oe=_[V];s(oe.element).tooltip({trigger:"focus"}).attr("data-original-title",oe.message).parents(".form-group").addClass("has-error")}}})};return $e(function(){s("i.fa").tooltip(),P.value=document.forms.bulkpricingForm,B(),i.value=n[1];const R=s(P.value.period_start).closest(".date"),_=xe(R,{useCurrent:!1,restrictions:{minDate:ne.addDays(new Date,1)}});R.on("change.td",function(V){const oe=_.dates.lastPicked;t.value.period_start=oe?ne.formatDate(oe,"dd/MM/yyyy"):""}),T(),te(),I()}),(R,_)=>(C(),S("div",r1,[e("div",i1,[_[32]||(_[32]=e("div",{class:"panel-heading",role:"tab",id:"applications-heading"},[e("h4",{class:"panel-title"}," Bulk Pricing ")],-1)),e("div",d1,[ee(He,{isLoading:u.value},{default:ue(()=>[W(H(b.value.join(" , ")),1)]),_:1},8,["isLoading"]),g(e("div",u1,[ee(Ee,{show:U.value,duration:7e3,type:"danger"},{default:ue(()=>[W(H(D.value),1)]),_:1},8,["show"]),ee(Ee,{show:y.value,duration:7e3,type:"success"},{default:ue(()=>_[14]||(_[14]=[e("strong",null,"Bulk pricing was successfull ",-1)])),_:1},8,["show"]),e("div",c1,[e("div",p1,[e("div",v1,[e("div",m1,[_[17]||(_[17]=e("div",{class:"col-md-3"},[e("div",{class:"radio"},[e("label",{for:""},"Set price per : ")])],-1)),e("div",f1,[e("div",_1,[e("label",g1,[g(e("input",{class:"form-check-input",type:"radio",value:n[1],"onUpdate:modelValue":_[0]||(_[0]=V=>i.value=V)},null,8,h1),[[ht,i.value]]),_[15]||(_[15]=W(" Park/Campground "))])])]),e("div",y1,[e("div",b1,[e("label",k1,[g(e("input",{class:"form-check-input",type:"radio",value:n[2],"onUpdate:modelValue":_[1]||(_[1]=V=>i.value=V)},null,8,$1),[[ht,i.value]]),_[16]||(_[16]=W(" Campsite Type "))])])])])])])]),e("div",C1,[e("div",w1,[e("div",x1,[e("h3",null,"Add New Pricing Period For "+H(i.value),1),_[31]||(_[31]=e("br",null,null,-1)),e("form",D1,[e("div",T1,[e("div",S1,[e("label",M1,H(i.value),1)]),g(e("div",E1,_[18]||(_[18]=[e("select",{class:"form-control"},[e("option",null,"Price Tarriff")],-1)]),512),[[ae,i.value==n[0]]]),g(e("div",P1,[g(e("select",R1,_[19]||(_[19]=[e("option",null,"Loading...",-1)]),512),[[ae,!f.value.length>0]]),f.value.length>0?g((C(),S("select",{key:0,name:"park",class:"form-control","onUpdate:modelValue":_[2]||(_[2]=V=>t.value.park=V)},[(C(!0),S(ie,null,de(f.value,V=>(C(),S("option",{value:V.id},H(V.name),9,O1))),256))],512)),[[ke,t.value.park]]):fe("",!0)],512),[[ae,i.value==n[1]]]),g(e("div",Y1,[g(e("select",U1,_[20]||(_[20]=[e("option",null,"Loading...",-1)]),512),[[ae,!Y.value.length>0]]),Y.value.length>0?g((C(),S("select",{key:0,name:"campsiteType",onChange:E,class:"form-control","onUpdate:modelValue":_[3]||(_[3]=V=>t.value.campsiteType=V)},[(C(!0),S(ie,null,de(Y.value,V=>(C(),S("option",{value:V.id},H(V.name),9,A1))),256))],544)),[[ke,t.value.campsiteType]]):fe("",!0)],512),[[ae,i.value==n[2]]])]),g(e("div",V1,[_[22]||(_[22]=e("div",{class:"col-md-2"},[e("label",{class:"control-label"},"Campground")],-1)),e("div",q1,[g(e("select",F1,_[21]||(_[21]=[e("option",null,"Loading...",-1)]),512),[[ae,!f.value.length>0]]),f.value.length>0?g((C(),S("select",{key:0,name:"campground",id:"bulkpricingCampgrounds",class:"form-control","onUpdate:modelValue":_[4]||(_[4]=V=>t.value.campgrounds=V),multiple:"multiple"},[(C(!0),S(ie,null,de(M.value,V=>(C(),S("option",{value:V.id},H(V.name),9,j1))),256))],512)),[[ke,t.value.campgrounds]]):fe("",!0)])],512),[[ae,i.value!=n[2]&&M.value.length>0]]),e("div",I1,[_[24]||(_[24]=e("div",{class:"col-md-2"},[e("label",null,[e("i",{class:"fa fa-question-circle","data-toggle":"tooltip","data-placement":"bottom",title:"Select a rate to prefill the price fields otherwise use the manual entry"}," "),W("Select Rate: ")])],-1)),e("div",H1,[g(e("select",{name:"rate","onUpdate:modelValue":_[5]||(_[5]=V=>x.value=V),class:"form-control",title:"testing"},[_[23]||(_[23]=e("option",{value:""},"Manual Entry",-1)),(C(!0),S(ie,null,de(O.value,V=>(C(),S("option",{value:V.id},H(V.name),9,L1))),256))],512),[[ke,x.value]])])]),e("div",N1,[_[25]||(_[25]=e("div",{class:"col-md-2"},[e("label",null,"Adult Price: ")],-1)),e("div",B1,[g(e("input",{readonly:x.value!="",name:"adult","onUpdate:modelValue":_[6]||(_[6]=V=>t.value.adult=V),type:"text",class:"form-control",required:"true"},null,8,G1),[[X,t.value.adult]])])]),e("div",J1,[_[26]||(_[26]=e("div",{class:"col-md-2"},[e("label",null,"Concession Price: ")],-1)),e("div",z1,[g(e("input",{readonly:x.value!="",name:"concession","onUpdate:modelValue":_[7]||(_[7]=V=>t.value.concession=V),type:"text",class:"form-control",required:"true"},null,8,X1),[[X,t.value.concession]])])]),e("div",W1,[_[27]||(_[27]=e("div",{class:"col-md-2"},[e("label",null,"Child Price: ")],-1)),e("div",K1,[g(e("input",{readonly:x.value!="",name:"child","onUpdate:modelValue":_[8]||(_[8]=V=>t.value.child=V),type:"text",class:"form-control",required:"true"},null,8,Q1),[[X,t.value.child]])])]),e("div",Z1,[_[29]||(_[29]=e("div",{class:"col-md-2"},[e("label",null,"Period start: ")],-1)),e("div",ey,[e("div",ty,[g(e("input",{name:"period_start","onUpdate:modelValue":_[9]||(_[9]=V=>t.value.period_start=V),type:"text",class:"form-control",required:"true"},null,512),[[X,t.value.period_start]]),_[28]||(_[28]=e("span",{class:"input-group-addon"},[e("span",{class:"glyphicon glyphicon-calendar"})],-1))])])]),ee(qe,{type:"price",modelValue:t.value.reason,"onUpdate:modelValue":_[10]||(_[10]=V=>t.value.reason=V),required:"true"},null,8,["modelValue"]),g(e("div",null,[e("div",sy,[_[30]||(_[30]=e("div",{class:"col-md-2"},[e("label",null,"Details: ")],-1)),e("div",oy,[g(e("textarea",{name:"details","onUpdate:modelValue":_[11]||(_[11]=V=>t.value.details=V),class:"form-control",required:$.value},null,8,ay),[[X,t.value.details]])])])],512),[[ae,$.value]]),e("div",ly,[e("button",{type:"button",class:"btn btn-primary",onClick:_[12]||(_[12]=_e(V=>w(),["prevent"]))},"Save"),e("button",{type:"button",class:"btn btn-danger",onClick:_[13]||(_[13]=V=>h())},"Cancel")])])])])])],512),[[ae,!u.value]])])]),e("div",ny,[_[33]||(_[33]=e("div",{class:"panel-heading",role:"tab",id:"parkentry-heading"},[e("h4",{class:"panel-title"}," Park Entry ")],-1)),e("div",ry,[e("div",iy,[e("div",dy,[ee(dt,{addParkPrice:!0,dt_options:k.value,dt_headers:d,object_id:34,level:"park"},null,8,["dt_options"])])])])])]))}},cy=et(uy,[["__scopeId","data-v-6e576e2b"]]),py={class:"container",id:"userInfo"},vy={class:"row"},my={class:"col-sm-12"},fy={class:"panel panel-default"},_y={class:"panel-heading"},gy={class:"panel-title"},hy=["href"],yy={class:"form-horizontal",name:"personal_form",method:"post"},by={class:"form-group"},ky={class:"col-sm-6"},$y={class:"form-group"},Cy={class:"col-sm-6"},wy={class:"form-group"},xy={class:"col-sm-12"},Dy={key:1,disabled:"",class:"pull-right btn btn-primary"},Ty={class:"row"},Sy={class:"col-sm-12"},My={class:"panel panel-default"},Ey={class:"panel-heading"},Py={class:"panel-title"},Ry=["href"],Oy={class:"form-horizontal",action:"index.html",method:"post"},Yy={class:"form-group"},Uy={class:"col-sm-6"},Ay={class:"form-group"},Vy={class:"col-sm-6"},qy={class:"form-group"},Fy={class:"col-sm-3"},jy={class:"col-sm-2"},Iy={class:"form-group"},Hy={class:"col-sm-4"},Ly=["value"],Ny={class:"form-group"},By={class:"col-sm-12"},Gy={key:1,disabled:"",class:"pull-right btn btn-primary"},Jy={class:"row"},zy={class:"col-sm-12"},Xy={class:"panel panel-default"},Wy={class:"panel-heading"},Ky={key:0,class:"fa fa-check fa-2x pull-left",style:{color:"green"}},Qy={key:1,class:"fa fa-times fa-2x pull-left",style:{color:"red"}},Zy={class:"panel-title"},eb=["href"],tb={class:"form-horizontal",action:"index.html",method:"post"},sb={class:"form-group"},ob={class:"col-sm-6"},ab={class:"form-group"},lb={class:"col-sm-6"},nb={class:"form-group"},rb={class:"col-sm-6"},ib={class:"form-group"},db={class:"col-sm-12"},ub={key:1,disabled:"",class:"pull-right btn btn-primary"},cb={__name:"profile",setup(o){const c=crypto.randomUUID(),v="adBody"+c,n="pBody"+c,d="cBody"+c,i=a({residential_address:{}}),x=a([]),O=a([]),p=a(!1),D=a(!1),b=a(!1),P=a(null),t=function(){p.value=!0,fetch(re.add_endpoint_json(G.users,i.value.id+"/update_personal"),{method:"POST",body:i.value,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(U=>{console.log(U),p.value=!1,i.value=U.body,i.value.residential_address==null&&(i.value.residential_address={})},U=>{console.log(U),p.value=!1})},M=function(){b.value=!0,fetch(re.add_endpoint_json(G.users,i.value.id+"/update_contact"),{method:"POST",body:i.value,headers:{"Content-Type":"application/json","X-CSRFToken":re.getCookie("csrftoken")}}).then(U=>{console.log(U),b.value=!1,i.value=U.body,i.value.residential_address==null&&(i.value.residential_address={})}).catch(U=>{console.log(U),b.value=!1})},Y=function(){D.value=!0,fetch(re.add_endpoint_json(G.users,i.value.id+"/update_address"),{method:"POST",body:i.value.residential_address,headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(U=>{console.log(U),D.value=!1,i.value=U.body,i.value.residential_address==null&&(i.value.residential_address={})}).catch(U=>{console.log(U),D.value=!1})},y=function(){O.value.push("fetching countries"),fetch(G.countries).then(U=>{x.value=U.body,O.value.splice("fetching countries",1)},U=>{console.log(U),O.value.splice("fetching countries",1)})};$e(function(){y(),P.value=document.forms.personal_form,s('.panelClicker[data-toggle="collapse"]').on("click",function(){var U=s(this).children()[0];window.setTimeout(function(){s(U).toggleClass("glyphicon-chevron-down glyphicon-chevron-up")},100)}),k()});const k=()=>{fetch(G.profile,{headers:{"X-CSRFToken":re.getCookie("csrftoken")}}).then(U=>{i.value=U.body,i.value.residential_address==null&&(i.value.residential_address={})}).catch(U=>{console.log(U)})};return(U,$)=>(C(),S("div",py,[e("div",vy,[e("div",my,[e("div",fy,[e("div",_y,[e("h3",gy,[$[14]||($[14]=W("Personal Details ")),$[15]||($[15]=e("small",null,"Provide your personal details",-1)),e("a",{class:"panelClicker",href:"#"+n,"data-toggle":"collapse","data-parent":"#userInfo",expanded:"true","aria-controls":n},$[13]||($[13]=[e("span",{class:"glyphicon glyphicon-chevron-up pull-right"},null,-1)]),8,hy)])]),e("div",{class:"panel-body collapse in",id:n},[e("form",yy,[e("div",by,[$[16]||($[16]=e("label",{for:"",class:"col-sm-3 control-label"},"Given name(s)",-1)),e("div",ky,[g(e("input",{type:"text",class:"form-control",name:"first_name",placeholder:"","onUpdate:modelValue":$[0]||($[0]=u=>i.value.first_name=u)},null,512),[[X,i.value.first_name]])])]),e("div",$y,[$[17]||($[17]=e("label",{for:"",class:"col-sm-3 control-label"},"Surname",-1)),e("div",Cy,[g(e("input",{type:"text",class:"form-control",name:"last_name",placeholder:"","onUpdate:modelValue":$[1]||($[1]=u=>i.value.last_name=u)},null,512),[[X,i.value.last_name]])])]),e("div",wy,[e("div",xy,[p.value?(C(),S("button",Dy,$[18]||($[18]=[e("i",{class:"fa fa-spin fa-spinner"},null,-1),W(" Updating")]))):(C(),S("button",{key:0,class:"pull-right btn btn-primary",onClick:$[2]||($[2]=_e(u=>t(),["prevent"]))},"Update"))])])])])])])]),e("div",Ty,[e("div",Sy,[e("div",My,[e("div",Ey,[e("h3",Py,[$[20]||($[20]=W("Address Details ")),$[21]||($[21]=e("small",null,"Provide your address details",-1)),e("a",{class:"panelClicker",href:"#"+v,"data-toggle":"collapse",expanded:"false","data-parent":"#userInfo","aria-controls":v},$[19]||($[19]=[e("span",{class:"glyphicon glyphicon-chevron-down pull-right"},null,-1)]),8,Ry)])]),O.value.length==0?(C(),S("div",{key:0,class:"panel-body collapse",id:v},[e("form",Oy,[e("div",Yy,[$[22]||($[22]=e("label",{for:"",class:"col-sm-3 control-label"},"Street",-1)),e("div",Uy,[g(e("input",{type:"text",class:"form-control",name:"street",placeholder:"","onUpdate:modelValue":$[3]||($[3]=u=>i.value.residential_address.line1=u)},null,512),[[X,i.value.residential_address.line1]])])]),e("div",Ay,[$[23]||($[23]=e("label",{for:"",class:"col-sm-3 control-label"},"Town/Suburb",-1)),e("div",Vy,[g(e("input",{type:"text",class:"form-control",name:"surburb",placeholder:"","onUpdate:modelValue":$[4]||($[4]=u=>i.value.residential_address.locality=u)},null,512),[[X,i.value.residential_address.locality]])])]),e("div",qy,[$[24]||($[24]=e("label",{for:"",class:"col-sm-3 control-label"},"State",-1)),e("div",Fy,[g(e("input",{type:"text",class:"form-control",name:"country",placeholder:"","onUpdate:modelValue":$[5]||($[5]=u=>i.value.residential_address.state=u)},null,512),[[X,i.value.residential_address.state]])]),$[25]||($[25]=e("label",{for:"",class:"col-sm-1 control-label"},"Postcode",-1)),e("div",jy,[g(e("input",{type:"text",class:"form-control",name:"postcode",placeholder:"","onUpdate:modelValue":$[6]||($[6]=u=>i.value.residential_address.postcode=u)},null,512),[[X,i.value.residential_address.postcode]])])]),e("div",Iy,[$[26]||($[26]=e("label",{for:"",class:"col-sm-3 control-label"},"Country",-1)),e("div",Hy,[g(e("select",{class:"form-control",name:"country","onUpdate:modelValue":$[7]||($[7]=u=>i.value.residential_address.country=u)},[(C(!0),S(ie,null,de(x.value,u=>(C(),S("option",{value:u.iso_3166_1_a2},H(u.printable_name),9,Ly))),256))],512),[[ke,i.value.residential_address.country]])])]),e("div",Ny,[e("div",By,[D.value?(C(),S("button",Gy,$[27]||($[27]=[e("i",{class:"fa fa-spin fa-spinner"},null,-1),W(" Updating")]))):(C(),S("button",{key:0,class:"pull-right btn btn-primary",onClick:$[8]||($[8]=_e(u=>Y(),["prevent"]))},"Update"))])])])])):fe("",!0)])])]),e("div",Jy,[e("div",zy,[e("div",Xy,[e("div",Wy,[U.showCompletion&&i.value.contact_details?(C(),S("i",Ky)):U.showCompletion&&!i.value.contact_details?(C(),S("i",Qy)):fe("",!0),e("h3",Zy,[$[29]||($[29]=W("Contact Details ")),$[30]||($[30]=e("small",null,"Provide your contact details",-1)),e("a",{class:"panelClicker",href:"#"+d,"data-toggle":"collapse","data-parent":"#userInfo",expanded:"false","aria-controls":d},$[28]||($[28]=[e("span",{class:"glyphicon glyphicon-chevron-down pull-right"},null,-1)]),8,eb)])]),e("div",{class:"panel-body collapse",id:d},[e("form",tb,[e("div",sb,[$[31]||($[31]=e("label",{for:"",class:"col-sm-3 control-label"},"Phone (work)",-1)),e("div",ob,[g(e("input",{type:"text",class:"form-control",name:"phone",placeholder:"","onUpdate:modelValue":$[9]||($[9]=u=>i.value.phone_number=u)},null,512),[[X,i.value.phone_number]])])]),e("div",ab,[$[32]||($[32]=e("label",{for:"",class:"col-sm-3 control-label"},"Mobile",-1)),e("div",lb,[g(e("input",{type:"text",class:"form-control",name:"mobile",placeholder:"","onUpdate:modelValue":$[10]||($[10]=u=>i.value.mobile_number=u)},null,512),[[X,i.value.mobile_number]])])]),e("div",nb,[$[33]||($[33]=e("label",{for:"",class:"col-sm-3 control-label"},"Email",-1)),e("div",rb,[g(e("input",{type:"email",class:"form-control",name:"email",placeholder:"","onUpdate:modelValue":$[11]||($[11]=u=>i.value.email=u)},null,512),[[X,i.value.email]])])]),e("div",ib,[e("div",db,[b.value?(C(),S("button",ub,$[34]||($[34]=[e("i",{class:"fa fa-spin fa-spinner"},null,-1),W(" Updating")]))):(C(),S("button",{key:0,class:"pull-right btn btn-primary",onClick:$[12]||($[12]=_e(u=>M(),["prevent"]))},"Update"))])])])])])])])]))}},pb=[{path:"/",component:ot,children:[{path:"account",name:"profile",component:cb},{path:"dashboard",component:ot,children:[{path:"campsite-types",name:"campsite-types",component:ot,children:[{path:"",name:"campsite-type",component:ch},{path:"add-campsite-type/",name:"add-campsite-type",component:bt},{path:":campsite_type_id",name:"campsite-type-detail",component:bt}]},{path:"campgrounds/addCampground",name:"cg_add",component:ui},{path:"campgrounds",component:ot,children:[{path:"",name:"cg_main",component:Eo},{path:":id",name:"cg_detail",component:oi},{path:":id/campsites/add",name:"add_campsite",component:yt},{path:":id/campsites/:campsite_id",name:"view_campsite",component:yt}]},{path:"bookings",component:Rf,children:[{path:"",name:"booking-dashboard",component:Ou},{path:"add/:cg",name:"add-booking",component:av},{path:"add/:cg/close_booking/",name:"booking-close-classes",component:Ef},{path:"edit/:booking_id",name:"edit-booking",component:sg}]},{path:"bulkpricing",name:"bulkpricing",component:cy},{path:"reports",name:"reports",component:eh}]},{path:"booking",component:ot,children:[{path:"",name:"fl-search",component:$d}]}]},{path:"/404",name:"404",component:ng}],vb={formatMoney:function(o,c,v,n){c=isNaN(c=Math.abs(c))?2:c,v=v??".",n=n??",";var d=o<0?"-":"",i=String(parseInt(o=Math.abs(Number(o)||0).toFixed(c))),x=(x=i.length)>3?x%3:0;return d+(x?i.substr(0,x)+n:"")+i.substr(x).replace(/(\d{3})(?=\d)/g,"$1"+n)+(c?v+Math.abs(o-i).toFixed(c).slice(2):"")},formatDate:function(o){return o?"FORMATTED DATE":"INVALID DATE FOR FILTER"}},Et=Gt({history:Jt(),routes:pb});if(document.getElementById("menu")){const o=Ct({});o.use(Et),o.mount("#menu")}const it=Ct({computed:{...zt(["showAlert","alertType","alertMessage"])}});it.component("alert",Ee);it.use(wt);it.use(Et);it.config.globalProperties.$filters={...vb};it.mount("#app");
