{% extends 'ps/base.html' %}

{% load bootstrap3 %}

{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="/static/common/node_modules/glider-js/glider.min.css?ver={{ GIT_COMMIT_HASH }}">
    <script src="/static/common/node_modules/glider-js/glider.min.js?ver={{ GIT_COMMIT_HASH }}"></script>

    <script src="/static/common/node_modules/@splidejs/splide/dist/js/splide.min.js?ver={{ GIT_COMMIT_HASH }}"></script>
    <link rel="stylesheet" href="/static/common/node_modules/@splidejs/splide/dist/css/splide.min.css?ver={{ GIT_COMMIT_HASH }}">
{% endblock %}

{% block messages %}
{% endblock %}

{% block content %}

<!-- https://cssbuttoncreator.com/ -->
<script>

window.onload = function() {
   search_avail.var.page = 'campsite-availablity';
   
   {% if cg.arrival is not None %}
   {% endif %}
   {% if cg.departure is not None %}
   {% endif %}
   search_avail.var.campground_id = '{{ cg.campground.id }}';
   search_avail.var.campers.adult = parseInt('{{ cg.num_adult }}');
   search_avail.var.campers.concession = parseInt('{{ cg.num_concession }}');
   search_avail.var.campers.children = parseInt('{{ cg.num_children }}');
   search_avail.var.campers.infant = parseInt('{{ cg.num_infants }}');
   {% if change_booking.id > 0 %}
   search_avail.var.change_booking_id = parseInt('{{ change_booking.id }}');
   {% endif %}
   search_avail.total_campers();	
   search_avail.get_search_locations();
   search_avail.get_locations();
   search_avail.get_places(); 
	search_avail.init_dateselection({% if cg.arrival %}'{{ cg.arrival }}'{% else %}null{% endif %},{% if cg.departure %}'{{ cg.departure }}'{% else %}null{% endif %});	
   search_avail.init();
   $(".filter-features").click(function() {
       console.log("Filters Updated (Reloading)");
       search_avail.load_campsite_availabilty();
   });

   console.log('loaded');

}

</script>

<div class="container" style='z-index:1'>
	{% if cg.campground.park.alert_count > 0 %}
	<div class="col-lg-12 mb-4">
                 <div class="round-box col-12 px-3 pt-3 pb-3" style='background-color: #f1f1f1; border: 1px solid #d2d2d2;'>
                             <div>
                                    <i class="bi-bell-fill" id='bell-flash' style='font-size: 20px; color: #ff0000; padding-right:8px;' ></i>
				    <span style='color:#ff0000; margin-top: -10px;'>{{ cg.campground.park.alert_count }} active alert(s) found for this park <a href='{{ cg.campground.park.alert_url }}' type="button" class="btn btn-danger" style='color:#FFF'>Read More</a>
				     </span>

                             </div>
                  </div>

        </div>
	{% endif %}
                 {% if change_booking %}
                 <div class="alert alert-info d-flex align-items-center" role="alert">
                   <div>
			   <p><i class="bi bi-calendar2-x-fill"></i>&nbsp;&nbsp; You are preparing to change booking PB{{ change_booking.id }} with arrival {{ change_booking.arrival|date:"j M Y" }} and departure {{ change_booking.departure|date:"j M Y" }}<p>

			  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please use the options below to change your booking,  we have prefilled information from your current booking</p>
		    
                   </div>
                 </div>
		 {% endif %}


<ul class="nav nav-pills ">
  <li class="nav-item">
    <a class="nav-link active" aria-current="page" href="#">BOOKING</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#">CAMPGROUND DETAILS</a>
  </li>
</ul>

<br>
        <div class="row">
	    {% if cg.campground_notices|length > 0 %}
            <div class="col-lg-12 ">
		 {% if cg.campground_notices_red > 0 %}
                 <div class="round-box col-12 px-3 " style='background-color: #ffcbcb; border: 1px solid #fb9e9e;'>
                         {% for notice in cg.campground_notices %}
			     {% if notice.notice_type == 0 %}
                             <div>
                                    <i class="bi-exclamation-diamond-fill" style='font-size: 20px; color: red; padding-right:8px;' ></i>
                                    <span style='color:red; margin-top: -10px;'>{{ notice.message }}</span>

                             </div>
			     {% endif %}
			 {% endfor %}
		  </div>
                  {% endif %}

		  {% if cg.campground_notices_orange > 0 %}
                 <div class="round-box col-12 px-3 " style='background-color: #fff4e0; border: 1px solid #ff89358a;'>
                         {% for notice in cg.campground_notices %}
			     {% if notice.notice_type == 1 %}
                             <div>
                                    <i class="bi-exclamation-triangle-fill" style='font-size: 20px; color: #ffa500; padding-right:8px;' ></i>
                                    <span style='color:#ffa500; margin-top: -10px;'>{{ notice.message }}</span>

                             </div>
			     {% endif %}
                         {% endfor %}
                  </div>
		  {% endif %}

                 {% if cg.campground_notices_blue > 0 %}
                 <div class="round-box col-12 px-3 " style='background-color: #cbe5ff; border: 1px solid #9eccfb;'>
                         {% for notice in cg.campground_notices %}
                             {% if notice.notice_type == 2 %}
                             <div>
                                    <i class="bi-info-circle-fill" style='font-size: 20px; color: #2a84e0; padding-right:8px;' ></i>
                                    <span style='color:#2a84e0; margin-top: -10px;'>{{ notice.message }}</span>

                             </div>
			     {% endif %}
                         {% endfor %}
                  </div>
		  {% endif %}


            </div>
            {% endif %}


                 <div class="col-lg-12 ">
                 <form autocomplete="off" onkeydown="return event.key != 'Enter';"> 
		 <div class="round-box col-12 px-3"> 
			 <div class="col-12">
				<div class="row">
 				     <div class="col-sm-12">
				         <h5>Where</h5>
				     </div>
				</div>
			 </div>
			 <div class="col-12">
                                <div class='row'>
				     <div class="col-sm-12 col-md-6">
					<div class="col-sm-12 col-md-12">
						<div id='region-park-avail-selection-outer' class='form-control'>

							 <div class='selection-informbox'> 
								  <span >
								      <i class='bi-geo-alt'></i>
								  </span> 
								  <span id='region-park-selection-inner'>
									  {{ cg.campground.name }} 
								  </span>
							 </div>
					         </div>
						 <div>
							 <div style='padding-left:12px; padding-top:5px; color: #4199d8'>
								 <i class='bi-info-circle-fill'></i>&nbsp;&nbsp;Largest campsites at {{ cg.campground.name }} allow for {{  cg.campground.largest_camper }} camper(s) and {{  cg.campground.largest_vehicle }} vehicle(s).
							 </div>
						</div>
					</div>
				    </div>
				</div>
		         </div>
		  </div>

                 <div class="round-box col-12 px-3">
                         <div class="col-12">
				<div class="col-sm-12 col-md-12">
                                 <h5>When</h5>
				</div>
                         </div>
                         <div class="col-12">
                              <div class='row'>


<!--- STARTING -->
	<div class="col-sm-12 col-md-6">
            <div class="col-sm-12 ">
          	<div class="col-sm-12 ">

	        <div class='row' style='padding-bottom:5px;'>
		    <div class="col-xs-6 col-lg-6 text-start">
			<div class="d-grid gap-2 d-block d-sm-none">
                                <button type="button" class="btn btn-success btn-sm" onclick="search_avail.select_days_earlier(1)">One day earlier</button>
			</div>
			<div class="d-none d-sm-block">
				<button type="button" class="btn btn-success btn-sm" onclick="search_avail.select_days_earlier(1)">One day earlier</button>
			</div>
		     </div> 
		     <div class="col-xs-6 col-lg-6 text-end">
			<div class="d-grid gap-2 d-block d-sm-none">
				<button type="button" onclick="search_avail.select_days_later(1)" class="btn btn-success btn-sm">One day later</button>
			</div>
			<div class="d-none d-sm-block">
			     <button type="button" onclick="search_avail.select_days_later(1)" class="btn btn-success btn-sm">One day later</button>
			</div>
		     </div> 
	        </div>
	</div>

	<div class="col-sm-12 ">
             <div id="when-date-range" class='form-control' style="cursor: pointer; ">
                <div class='selection-informbox'>
                    <i class='bi-calendar3' dclass="glyphicon glyphicon-calendar"></i>&nbsp;
                    <span id='when-dates'></span> 
                    <span> (<span id='when-nights'></span> nights)</span>
                    &nbsp;&nbsp;<i class='bi-caret-down-fill' ddclass="glyphicon glyphicon-triangle-bottom"></i>
                </div>
		
                <div id='form-vars' style='display:none'>
                    <input id='checkin' > <input id='checkout' >
                </div>
        </div>
    <!-- http://www.daterangepicker.com/#example4 -->
</div>
</div>


</div>
<!-- ENDING -->
				  <div class="col-sm-12 col-md-6" style='display:none'>
					<div class="col-sm-12 col-md-12">
						Check In
					</div>
					<div class="col-sm-12 col-md-12">
						<input id="region-park" type="text" placeholder="Search for campgrounds, parks" autocomplete="off" aria-expanded="false" class='form-control' >
					</div>
				  </div>
				  <div class="col-sm-12 col-md-6" style='display:none'>
                                        <div class="col-sm-12 col-md-12">
                                                Check Out 
                                        </div>
                                        <div class="col-sm-12 col-md-12">
                                                <input id="region-park" type="text" placeholder="Search for campgrounds, parks" autocomplete="off" aria-expanded="false" class='form-control' >
                                        </div>
				  </div>
			      </div>
                         </div>
                 </div>
<style>

.plus-minus-counter {
  font-size: 30px; 
  color: #4c4343;
  cursor:pointer;
}

.plus-minus-counter:hover {
  color: #909090;

}
.plus-minus-counter:active {
  color: #0d6efd;

}
.camper-dropdown {
  position:absolute; 
  display:none;
}					
.camper-dropdown-relative {
 position:relative; 
 background-color:#FFFFFF; 
 width: 300px; 
 border: 1px solid #dedede; 
 padding: 10px; 
 box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75); 
 -webkit-box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75); 
 -moz-box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75);
}				

.vehicle-dropdown {
  position:absolute;
  display:none;
}

.vehicle-dropdown-relative {
 position:relative;
 background-color:#FFFFFF;
 width: 300px;
 border: 1px solid #dedede;
 padding: 10px;
 box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75);
 -webkit-box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75);
 -moz-box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75);
}

	
</style>

                 <div class="round-box col-12 px-3">
                         <div class="col-12">
                                <div class="col-sm-12 col-md-12">
                                    <h5>Camper(s)</h5>
                                </div>
                         </div>
                         <div class="col-12">
                                <div class='row'>
                                     <div class="col-sm-12 col-md-6">
                                        <div class="col-sm-12 col-md-12">
                                                <div id='region-park-avail-selection-outer' class='form-control selection-dropdown' style="cursor: pointer; " onclick="search_avail.campers_toggle();">
                                                         <div class='selection-informbox'>
                                                                  <span >
                                                                          <i class='bi-people-fill'></i></span> <span id='camper-selection-inner-text'>0 adult, 0 concession, 0 child, 0 Infant </span>  <span><i class="bi-caret-down-fill" ddclass="glyphicon glyphicon-triangle-bottom"></i></span>
                                                         </div>
                                                </div>
						<div id='camper-dropdown' class='camper-dropdown selection-dropdown'>
							<div id='camper-dropdown-relative' class='camper-dropdown-relative'>


                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Adults <br>(non concession)</div>
                                                          <div class="col-4 col-sm-4">

                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter' onclick="search_avail.change_camper_counters('adult','down');" ></i> 
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter' onclick="search_avail.change_camper_counters('adult','up');"></i>
                                                                       </span>
                                                          </div>
                                                        </div>


                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Concession</div>
                                                          <div class="col-4 col-sm-4">
                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter' onclick="search_avail.change_camper_counters('concession','down');"></i>
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter' onclick="search_avail.change_camper_counters('concession','up');"></i>
                                                                       </span>
                                                          </div>
                                                        </div>


                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Children </div>
                                                          <div class="col-4 col-sm-4">
                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter' onclick="search_avail.change_camper_counters('children','down');" ></i>
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter' onclick="search_avail.change_camper_counters('children','up');" ></i>
                                                                       </span>
                                                          </div>
                                                        </div>

                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Infants </div>
                                                          <div class="col-4 col-sm-4">
                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter' onclick="search_avail.change_camper_counters('infant','down');"></i>
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter' onclick="search_avail.change_camper_counters('infant','up');"></i>
                                                                       </span>
                                                          </div>
                                                        </div>
                                                        <div class="row p-3">
								<div class="col-12 col-sm-12 text-end">
                                                                          <button type="button" class="btn btn-primary btn-sm" onclick="search_avail.campers_toggle();">Close</button>

								</div>

							</div>

                                                        </div>
						</div>
                                           </div>
                                      </div>
                                </div>
                         </div>
                  </div>

                  <div class="round-box col-12 px-3">
                         <div class="col-12">
                                <div class="col-sm-12 col-md-12">
                                    <h5>Vehicle(s)</h5>
                                </div>
                         </div>
                         <div class="col-12">
                                <div class='row'>
                                     <div class="col-sm-12 col-md-6">
                                        <div class="col-sm-12 col-md-12">
                                                <div id='region-park-avail-selection-outer' class='form-control selection-dropdown' style="cursor: pointer; " onclick="search_avail.vehicle_toggle();">
                                                         <div class='selection-informbox'>
                                                                  <span>
									  <i class='bi-speedometer'></i></span> <span id='vehicle-selection-inner-text'> &nbsp;0 cars , 0 campervans, 0 motor cycles, 0 trailers </span> <span><i class="bi-caret-down-fill" ></i></span>
                                                         </div>
                                                </div>

                                                <div id='vehicle-dropdown' class='vehicle-dropdown selection-dropdown'>
                                                        <div id='vehicle-dropdown-relative' class='vehicle-dropdown-relative'>


                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Vehicle(s)</div>
                                                          <div class="col-4 col-sm-4">

                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter' onclick="search_avail.change_vehicle_counters('vehicle','down')"></i>
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter' onclick="search_avail.change_vehicle_counters('vehicle','up')" ></i>
                                                                       </span>
                                                          </div>
                                                        </div>


                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Campervans</div>
                                                          <div class="col-4 col-sm-4">
                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter'  onclick="search_avail.change_vehicle_counters('campervan','down')"></i>
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter'  onclick="search_avail.change_vehicle_counters('campervan','up')" ></i>
                                                                       </span>
                                                          </div>
                                                        </div>
                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Motor cycles </div>
                                                          <div class="col-4 col-sm-4">
                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter' onclick="search_avail.change_vehicle_counters('motorcycle','down')" ></i>
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter' onclick="search_avail.change_vehicle_counters('motorcycle','up')" ></i>
                                                                       </span>
                                                          </div>
                                                        </div>

                                                        <div class="row p-3" style='border-bottom: 1px solid #eaeaea'>
                                                          <div class="col-8 col-sm-8 fw-bold">Trailers </div>
                                                          <div class="col-4 col-sm-4">
                                                                        <span>
                                                                       <i class='bi-dash-square plus-minus-counter' onclick="search_avail.change_vehicle_counters('trailer','down')"></i>
                                                                       </span>
                                                                        <span>
                                                                       <i class='bi-plus-square plus-minus-counter' onclick="search_avail.change_vehicle_counters('trailer','up')" ></i>
                                                                       </span>
                                                          </div>
                                                        </div>
                                                        <div class="row p-3">
                                                                <div class="col-12 col-sm-12 text-end">
                                                                          <button type="button" class="btn btn-primary btn-sm" onclick="search_avail.vehicle_toggle();">Close</button>

                                                                </div>
                                                        </div>
                                                        </div>
                                                </div>
                                           </div>
                                      </div>
                                </div>
                         </div>
                 </div>


                 <div id='search-filters-campsites' class="round-box col-12 px-3">
                         <div class="col-12">
                                <div class="col-sm-12 col-md-12">
                                 <h5></h5>
                                </div>
                         </div>
                         <div class="col-12" style='display:none' id='filter-options'>
                              <div class='row'>
				<div class="col-6">
					Tents
				</div>					
				<div class="col-6">
					<div class="form-check form-switch">
					  <input class="form-check-input filter-features" type="checkbox" id="filter-checkbox-tent" >
				</div>
				</div>

                                <div class="col-6">
                                        Campervan
                                </div>                                  
                                <div class="col-6">
                                        <div class="form-check form-switch">
                                          <input class="form-check-input filter-features" type="checkbox" id="filter-checkbox-campervan">
                                </div>
                                </div>


                                <div class="col-6">
                                        Caravan / Camper trailer
                                </div>                                  
                                <div class="col-6">
                                        <div class="form-check form-switch">
                                          <input class="form-check-input filter-features" type="checkbox" id="filter-checkbox-campertrailer">
                                </div>
                                </div>

                                <div class="col-6">
                                        &nbsp; 
                                </div>
                                <div class="col-6">
                                        &nbsp;
                                </div>

				{% for f  in features %}
                                     <div class="col-6">
                                          {{ f.name }} 
                                     </div>
                                     <div class="col-6">
                                             <div class="form-check form-switch">
						     <input class="form-check-input filter-features" type="checkbox" id="filter-feature-{{ f.id }}">
                                             </div>
                                     </div>
				{% endfor %}

			      </div>
			 </div> 
			 <div class="col-12" style='' >
				 <center><button type="button" class="btn btn-primary" id='more-filters' onclick="search_avail.filter_options('open');">More filters</button></center>
				 <center><button type="button" class="btn btn-primary" style='display:none;' id='hide-filters' onclick="search_avail.filter_options('close');">Hide filters</button></center>
		         </div>
                  </div>

		  <textarea id='feature_json' style='display:none'>{{ features_json }}</textarea>
		  </form>

                  <div id='campsite-availablity' class="round-box col-12 px-3" istyle='float:left; '>
                          <div class="col-12" id='campsite-availablity-results'>
                                Campsites
  		          </div>
		  </div>

		  <div class="col-12" style='display:none'>
			<div class="col-12" align='right'>
			
				<button type='button' name='search-avail' id='search-avail' class='form-button' style='width:100%'>Search</button>
			</div>

		  </div>
         </div>
     </div>
</div>
<br>
<br>

<script type="module">
//	import Map from 'ol/Map';
//	console.log(Map);
</script>

{% endblock %}

